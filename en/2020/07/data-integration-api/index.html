<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Is the Data Integration API “just an API”? - Cloud.Virt.AI.Sec</title><meta name="description" content="When Veeam released V10 it added a brand-new capability tucked away behind PowerShell cmdlets and a rather intimidating name: Data Integration API. Many admins …"><meta property="og:url" content="https://blog.backupnext.cloud/en/2020/07/data-integration-api/">
  <meta property="og:site_name" content="Cloud.Virt.AI.Sec">
  <meta property="og:title" content="Is the Data Integration API “just an API”?">
  <meta property="og:description" content="When Veeam released V10 it added a brand-new capability tucked away behind PowerShell cmdlets and a rather intimidating name: Data Integration API. Many admins saw the term and assumed they’d need to write code, so they never looked deeper.
What It Actually Does In reality, the feature is straightforward. It uses Windows’ iSCSI services to publish Veeam backup data as iSCSI disks. Think of it as a new data-lab use case: any image-level backup can be presented to a Windows or Linux host over iSCSI—no VMware or Hyper-V required. Supported sources include:">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-07-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-07-13T00:00:00+00:00">
    <meta property="article:tag" content="Automation Powershell">
    <meta property="og:image" content="https://blog.backupnext.cloud/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://blog.backupnext.cloud/logo.png">
  <meta name="twitter:title" content="Is the Data Integration API “just an API”?">
  <meta name="twitter:description" content="When Veeam released V10 it added a brand-new capability tucked away behind PowerShell cmdlets and a rather intimidating name: Data Integration API. Many admins saw the term and assumed they’d need to write code, so they never looked deeper.
What It Actually Does In reality, the feature is straightforward. It uses Windows’ iSCSI services to publish Veeam backup data as iSCSI disks. Think of it as a new data-lab use case: any image-level backup can be presented to a Windows or Linux host over iSCSI—no VMware or Hyper-V required. Supported sources include:">
<meta name="application-name" content="Cloud.Virt.AI.Sec">
<meta name="apple-mobile-web-app-title" content="Cloud.Virt.AI.Sec">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.backupnext.cloud/en/2020/07/data-integration-api/" /><link rel="prev" href="https://blog.backupnext.cloud/en/2020/06/powercli-vsphere-permission/" /><link rel="next" href="https://blog.backupnext.cloud/en/2020/09/new-subscription-daily-gif/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Is the Data Integration API “just an API”?",
        "inLanguage": "en-US",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.backupnext.cloud\/en\/2020\/07\/data-integration-api\/"
        },"image": ["https:\/\/blog.backupnext.cloud\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "Automation Powershell","wordcount":  810 ,
        "url": "https:\/\/blog.backupnext.cloud\/en\/2020\/07\/data-integration-api\/","datePublished": "2020-07-13T00:00:00+00:00","dateModified": "2020-07-13T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Cloud.Virt.AI.Sec","logo": "https:\/\/blog.backupnext.cloud\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Lei Wei"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/en/" title="Cloud.Virt.AI.Sec">Cloud.Virt.AI.Sec</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/en/posts/"> Posts </a><a class="menu-item" href="/en/archive/"> Archive </a><a class="menu-item" href="/en/categories/"> Categories </a><a class="menu-item" href="/en/tags/"> Tags </a><a class="menu-item" href="/en/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search articles" id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/2020/07/data-integration-api/">简体中文</option><option value="/en/2020/07/data-integration-api/" selected>English</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/en/" title="Cloud.Virt.AI.Sec">Cloud.Virt.AI.Sec</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search articles" id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/en/posts/" title="">Posts</a><a class="menu-item" href="/en/archive/" title="">Archive</a><a class="menu-item" href="/en/categories/" title="">Categories</a><a class="menu-item" href="/en/tags/" title="">Tags</a><a class="menu-item" href="/en/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><div class="menu-item language" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/2020/07/data-integration-api/">简体中文</option><option value="/en/2020/07/data-integration-api/" selected>English</option></select>
                </div></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Is the Data Integration API “just an API”?</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://blog.backupnext.cloud" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Lei Wei</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2020-07-13">2020-07-13</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;810 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#what-it-actually-does">What It Actually Does</a></li>
    <li><a href="#how-it-works">How It Works</a></li>
    <li><a href="#using-it">Using It</a>
      <ul>
        <li><a href="#sample-script">Sample Script</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>When Veeam released V10 it added a brand-new capability tucked away behind PowerShell cmdlets and a rather intimidating name: <strong>Data Integration API</strong>. Many admins saw the term and assumed they’d need to write code, so they never looked deeper.</p>
<h2 id="what-it-actually-does">What It Actually Does</h2>
<p>In reality, the feature is straightforward. It uses Windows’ iSCSI services to publish Veeam backup data as iSCSI disks. Think of it as a new data-lab use case: any image-level backup can be presented to a Windows or Linux host over iSCSI—no VMware or Hyper-V required. Supported sources include:</p>
<ul>
<li>VMware image backups</li>
<li>VMware replicas</li>
<li>Hyper-V image backups</li>
<li>Hyper-V replicas</li>
<li>Veeam Agent for Windows</li>
<li>Veeam Agent for Linux</li>
</ul>
<h2 id="how-it-works">How It Works</h2>
<p>After the API call, the VBR mount server behaves like an iSCSI array. You pick the backup/replica restore point, VBR publishes it, and consumers connect via the iSCSI protocol to access the volumes.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s1.ax1x.com/2020/07/11/U1SPje.png"
        data-srcset="https://s1.ax1x.com/2020/07/11/U1SPje.png, https://s1.ax1x.com/2020/07/11/U1SPje.png 1.5x, https://s1.ax1x.com/2020/07/11/U1SPje.png 2x"
        data-sizes="auto"
        alt="https://s1.ax1x.com/2020/07/11/U1SPje.png"
        title="U1SPje.png" /></p>
<h2 id="using-it">Using It</h2>
<p>Because it’s exposed through APIs, there’s no GUI button—but that doesn’t stop us. At the end of this post you’ll find a PowerShell script. Copy it into a <code>.ps1</code> file on the VBR server and run it interactively; it will walk you through the prompts and publish the selected restore point over iSCSI.</p>
<p>Sample output in PowerShell:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s1.ax1x.com/2020/07/13/UJfszR.png"
        data-srcset="https://s1.ax1x.com/2020/07/13/UJfszR.png, https://s1.ax1x.com/2020/07/13/UJfszR.png 1.5x, https://s1.ax1x.com/2020/07/13/UJfszR.png 2x"
        data-sizes="auto"
        alt="https://s1.ax1x.com/2020/07/13/UJfszR.png"
        title="UJfszR.png" /></p>
<p>Inside VBR you’ll see the published disk listed similar to an Instant Recovery session:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s1.ax1x.com/2020/07/13/UJfTSA.png"
        data-srcset="https://s1.ax1x.com/2020/07/13/UJfTSA.png, https://s1.ax1x.com/2020/07/13/UJfTSA.png 1.5x, https://s1.ax1x.com/2020/07/13/UJfTSA.png 2x"
        data-sizes="auto"
        alt="https://s1.ax1x.com/2020/07/13/UJfTSA.png"
        title="UJfTSA.png" /></p>
<p>Next, go to the iSCSI initiator on the target host (in this example, 10.10.1.175) and connect to the mount server (10.10.1.201, port 3260).</p>
<p>When you’re finished, don’t forget to click <strong>Stop Publishing</strong> in VBR to tear down the session.</p>
<h3 id="sample-script">Sample Script</h3>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-powershell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># Sample script for Veeam Data Integration API</span>
</span></span><span class="line"><span class="cl"><span class="c"># Publishes backup data over iSCSI to a specified host</span>
</span></span><span class="line"><span class="cl"><span class="c"># Requires at least 7 restore points (adjust as needed)</span>
</span></span><span class="line"><span class="cl"><span class="c"># Currently targets VMware/Hyper-V backups; modify for Agents, Backup Copy, Replication, etc.</span>
</span></span><span class="line"><span class="cl"><span class="c">#</span>
</span></span><span class="line"><span class="cl"><span class="c"># Author: Wei Lei</span>
</span></span><span class="line"><span class="cl"><span class="c"># Email: lei.wei@veeam.com</span>
</span></span><span class="line"><span class="cl"><span class="c"># Version: v1.1</span>
</span></span><span class="line"><span class="cl"><span class="c">################# Update log ######################</span>
</span></span><span class="line"><span class="cl"><span class="c"># Stops immediately when VBR credentials fail</span>
</span></span><span class="line"><span class="cl"><span class="c"># Stops automatically if no restore point is selected</span>
</span></span><span class="line"><span class="cl"><span class="c">###################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Script Start</span>
</span></span><span class="line"><span class="cl"><span class="c"># VBR Server (Server Name, FQDN or IP)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$vbrServer</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&#34;请输入 VBR 地址，可以是域名或者 IP&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c"># VBR Credentials</span>
</span></span><span class="line"><span class="cl"><span class="nb">Write-Host</span> <span class="s2">&#34;请在弹出对话框中输入 VBR 的用户名密码。&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Credential</span><span class="p">=</span><span class="nb">Get-Credential</span> <span class="n">-Message</span> <span class="n">请输入</span> <span class="n">VBR</span> <span class="n">的用户名密码</span>
</span></span><span class="line"><span class="cl"><span class="nv">$vbrusername</span> <span class="p">=</span> <span class="nv">$Credential</span><span class="p">.</span><span class="py">Username</span>
</span></span><span class="line"><span class="cl"><span class="nv">$vbrpassword</span> <span class="p">=</span> <span class="nv">$Credential</span><span class="p">.</span><span class="py">GetNetworkCredential</span><span class="p">().</span><span class="py">password</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#region Connect</span>
</span></span><span class="line"><span class="cl"><span class="c"># Load Veeam Snapin</span>
</span></span><span class="line"><span class="cl"><span class="k">If</span> <span class="p">(!(</span><span class="nb">Get-PSSnapin</span> <span class="n">-Name</span> <span class="n">VeeamPSSnapIn</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">If</span> <span class="p">(!(</span><span class="nb">Add-PSSnapin</span> <span class="n">-PassThru</span> <span class="n">VeeamPSSnapIn</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Write-Error</span> <span class="s2">&#34;Unable to load Veeam snapin&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
</span></span><span class="line"><span class="cl">        <span class="n">Exit</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Connect to VBR server</span>
</span></span><span class="line"><span class="cl"><span class="nv">$OpenConnection</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-VBRServerSession</span><span class="p">).</span><span class="py">Server</span>
</span></span><span class="line"><span class="cl"><span class="k">If</span> <span class="p">(</span><span class="nv">$OpenConnection</span> <span class="o">-ne</span> <span class="nv">$vbrServer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Disconnect-VBRServer</span>
</span></span><span class="line"><span class="cl">    <span class="k">Try</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Connect-VBRServer</span> <span class="n">-user</span> <span class="nv">$vbrusername</span> <span class="n">-password</span> <span class="nv">$vbrpassword</span> <span class="n">-server</span> <span class="nv">$vbrServer</span> <span class="n">-ErrorAction</span> <span class="n">Stop</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">Catch</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Write-Host</span> <span class="s2">&#34;无法连接到 VBR 服务器 - </span><span class="nv">$vbrServer</span><span class="s2">&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c">#endregion</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$VMName</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&#34;请输入需要用于挂载的虚拟机名称&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$IP</span> <span class="p">=</span><span class="nb">Read-Host</span> <span class="s2">&#34;要挂载到哪台服务器（IP 地址）？&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$backup</span> <span class="p">=</span> <span class="nb">Get-VBRBackup</span>
</span></span><span class="line"><span class="cl"><span class="nv">$backup</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span><span class="nv">$backup</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="py">JobType</span> <span class="o">-eq</span> <span class="s2">&#34;Backup&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="nv">$points</span> <span class="p">=</span> <span class="nb">Get-VBRRestorePoint</span> <span class="n">-Backup</span> <span class="nv">$backup</span> <span class="n">-Name</span> <span class="nv">$VMName</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="err">–</span><span class="n">Property</span> <span class="n">CreationTime</span> <span class="err">–</span><span class="n">Descending</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-First</span> <span class="mf">7</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$points</span> <span class="o">-eq</span> <span class="vm">$null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;找不到这台虚拟机的还原点。 - </span><span class="nv">$VMName</span><span class="s2">&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
</span></span><span class="line"><span class="cl">    <span class="n">exit</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">While</span><span class="p">(</span><span class="nv">$InNumber</span> <span class="o">-ne</span> <span class="mf">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;##############已找到虚拟机 </span><span class="nv">$VMName</span><span class="s2"> 的最近 7 个还原点##############&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$i</span> <span class="p">=</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$pt</span> <span class="k">in</span> <span class="nv">$points</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$ptctime</span> <span class="p">=</span> <span class="nv">$pt</span><span class="p">.</span><span class="py">CreationTime</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$i</span> <span class="p">=</span> <span class="nv">$i</span> <span class="p">+</span> <span class="mf">1</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;#&#34;</span> <span class="nv">$i</span> <span class="p">.</span> <span class="nv">$ptctime</span> <span class="s2">&#34;;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;#############################################################&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$InNumber</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&#34;请选择还原点（1-7）&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$ss</span> <span class="p">=</span><span class="vm">@</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">switch</span><span class="p">(</span><span class="nv">$InNumber</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="mf">1</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pt</span> <span class="p">=</span> <span class="nv">$points</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-Index</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pttime</span> <span class="p">=</span> <span class="nv">$pt</span><span class="p">.</span><span class="py">CreationTime</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Host</span> <span class="s2">&#34;已选择还原点 </span><span class="nv">$pttime</span><span class="s2"> 。&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$ss</span> <span class="p">=</span> <span class="nb">Publish-VBRBackupContent</span> <span class="n">-RestorePoint</span> <span class="nv">$pt</span> <span class="n">-AllowedIps</span> <span class="nv">$IP</span> <span class="n">-RunAsync</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="mf">2</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pt</span> <span class="p">=</span> <span class="nv">$points</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-Index</span> <span class="mf">1</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pttime</span> <span class="p">=</span> <span class="nv">$pt</span><span class="p">.</span><span class="py">CreationTime</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Host</span> <span class="s2">&#34;已选择还原点 </span><span class="nv">$pttime</span><span class="s2"> 。&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$ss</span> <span class="p">=</span> <span class="nb">Publish-VBRBackupContent</span> <span class="n">-RestorePoint</span> <span class="nv">$pt</span> <span class="n">-AllowedIps</span> <span class="nv">$IP</span> <span class="n">-RunAsync</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="mf">3</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pt</span> <span class="p">=</span> <span class="nv">$points</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-Index</span> <span class="mf">2</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pttime</span> <span class="p">=</span> <span class="nv">$pt</span><span class="p">.</span><span class="py">CreationTime</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Host</span> <span class="s2">&#34;已选择还原点 </span><span class="nv">$pttime</span><span class="s2"> 。&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$ss</span> <span class="p">=</span> <span class="nb">Publish-VBRBackupContent</span> <span class="n">-RestorePoint</span> <span class="nv">$pt</span> <span class="n">-AllowedIps</span> <span class="nv">$IP</span> <span class="n">-RunAsync</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="mf">4</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pt</span> <span class="p">=</span> <span class="nv">$points</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-Index</span> <span class="mf">3</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pttime</span> <span class="p">=</span> <span class="nv">$pt</span><span class="p">.</span><span class="py">CreationTime</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Host</span> <span class="s2">&#34;已选择还原点 </span><span class="nv">$pttime</span><span class="s2"> 。&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$ss</span> <span class="p">=</span> <span class="nb">Publish-VBRBackupContent</span> <span class="n">-RestorePoint</span> <span class="nv">$pt</span> <span class="n">-AllowedIps</span> <span class="nv">$IP</span> <span class="n">-RunAsync</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="mf">5</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pt</span> <span class="p">=</span> <span class="nv">$points</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-Index</span> <span class="mf">4</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pttime</span> <span class="p">=</span> <span class="nv">$pt</span><span class="p">.</span><span class="py">CreationTime</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Host</span> <span class="s2">&#34;已选择还原点 </span><span class="nv">$pttime</span><span class="s2"> 。&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$ss</span> <span class="p">=</span> <span class="nb">Publish-VBRBackupContent</span> <span class="n">-RestorePoint</span> <span class="nv">$pt</span> <span class="n">-AllowedIps</span> <span class="nv">$IP</span> <span class="n">-RunAsync</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="mf">6</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pt</span> <span class="p">=</span> <span class="nv">$points</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-Index</span> <span class="mf">5</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pttime</span> <span class="p">=</span> <span class="nv">$pt</span><span class="p">.</span><span class="py">CreationTime</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Host</span> <span class="s2">&#34;已选择还原点 </span><span class="nv">$pttime</span><span class="s2"> 。&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$ss</span> <span class="p">=</span> <span class="nb">Publish-VBRBackupContent</span> <span class="n">-RestorePoint</span> <span class="nv">$pt</span> <span class="n">-AllowedIps</span> <span class="nv">$IP</span> <span class="n">-RunAsync</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="mf">7</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pt</span> <span class="p">=</span> <span class="nv">$points</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-Index</span> <span class="mf">6</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$pttime</span> <span class="p">=</span> <span class="nv">$pt</span><span class="p">.</span><span class="py">CreationTime</span>
</span></span><span class="line"><span class="cl">            <span class="nb">Write-Host</span> <span class="s2">&#34;已选择还原点 </span><span class="nv">$pttime</span><span class="s2"> 。&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$ss</span> <span class="p">=</span> <span class="nb">Publish-VBRBackupContent</span> <span class="n">-RestorePoint</span> <span class="nv">$pt</span> <span class="n">-AllowedIps</span> <span class="nv">$IP</span> <span class="n">-RunAsync</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">Default</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Write-Error</span> <span class="s2">&#34;请输入 1-7 之间的数字！&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Invoke-Command</span> <span class="p">{</span><span class="n">exit</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;正在挂载还原点。..&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$state</span> <span class="p">=</span> <span class="nv">$ss</span><span class="p">.</span><span class="py">StateString</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$ssid</span> <span class="p">=</span> <span class="nv">$ss</span><span class="p">.</span><span class="py">id</span>
</span></span><span class="line"><span class="cl">    <span class="k">While</span> <span class="p">(</span><span class="nv">$state</span> <span class="o">-ne</span> <span class="s2">&#34;Virtual disks published...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nb">Start-Sleep</span> <span class="n">-s</span> <span class="mf">5</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$ss</span> <span class="p">=</span> <span class="nb">Get-VBRPublishedBackupContentSession</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$sss</span> <span class="p">=</span> <span class="nv">$ss</span> <span class="p">|</span> <span class="p">?{</span><span class="nv">$_</span><span class="p">.</span><span class="py">id</span> <span class="o">-eq</span> <span class="nv">$ssid</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$state</span> <span class="p">=</span> <span class="nv">$sss</span><span class="p">.</span><span class="py">StateString</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;虚拟机 </span><span class="nv">$VMName</span><span class="s2"> 的还原点 </span><span class="nv">$pttime</span><span class="s2"> 已挂载。&#34;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$mountinfo</span> <span class="p">=</span> <span class="nb">Get-VBRPublishedBackupContentInfo</span> <span class="n">-Session</span> <span class="nv">$sss</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$mountinfomode</span> <span class="p">=</span> <span class="nv">$mountinfo</span><span class="p">.</span><span class="py">mode</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$mountinfoserverip</span> <span class="p">=</span> <span class="nv">$mountinfo</span><span class="p">.</span><span class="py">serverips</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$mountinfoserverport</span> <span class="p">=</span> <span class="nv">$mountinfo</span><span class="p">.</span><span class="py">serverport</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$mountinfodiskname</span> <span class="p">=</span> <span class="nv">$mountinfo</span><span class="p">.</span><span class="py">disks</span><span class="p">.</span><span class="py">diskname</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;    挂载点已经通过 </span><span class="nv">$mountinfomode</span><span class="s2"> 挂载&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;    挂载磁盘信息： </span><span class="nv">$mountinfodiskname</span><span class="s2"> &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;    iSCSI 客户端连接访问地址：</span><span class="nv">$mountinfoserverip</span><span class="s2"> &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;    iSCSI 客户端连接访问端口：</span><span class="nv">$mountinfoserverport</span><span class="s2"> &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Invoke-Command</span> <span class="p">{</span><span class="n">exit</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-07-13</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/en/2020/07/data-integration-api/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="https://api.qrserver.com/v1/create-qr-code/?size=240x240&amp;data=https%3A%2F%2Fblog.backupnext.cloud%2Fen%2F2020%2F07%2Fdata-integration-api%2F" target="_blank" rel="noopener noreferrer" title="Share on 微信" aria-label="Share on 微信"><i class="fab fa-weixin fa-fw" aria-hidden="true"></i></a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fblog.backupnext.cloud%2Fen%2F2020%2F07%2Fdata-integration-api%2F&amp;text=Is&#43;the&#43;Data&#43;Integration&#43;API&#43;%E2%80%9Cjust&#43;an&#43;API%E2%80%9D%3F" target="_blank" rel="noopener noreferrer" title="Share on X" aria-label="Share on X"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%253A%252F%252Fblog.backupnext.cloud%252Fen%252F2020%252F07%252Fdata-integration-api%252F" target="_blank" rel="noopener noreferrer" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="https://www.facebook.com/sharer/sharer.php?u=https%253A%252F%252Fblog.backupnext.cloud%252Fen%252F2020%252F07%252Fdata-integration-api%252F" target="_blank" rel="noopener noreferrer" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/en/tags/Automation-Powershell/">Automation Powershell</a></section>
        <section>
            <span><button type="button" class="link-button" onclick="window.history.back();">Back</button></span>&nbsp;|&nbsp;<span><a href="/en/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/en/2020/06/powercli-vsphere-permission/" class="prev" rel="prev" title="Create a Minimal vSphere Role for Veeam via PowerCLI"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Create a Minimal vSphere Role for Veeam via PowerCLI</a>
            <a href="/en/2020/09/new-subscription-daily-gif/" class="next" rel="next" title="Learn Veeam in 10 Seconds via WeChat Search">Learn Veeam in 10 Seconds via WeChat Search<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">English content on this site is generated by AI (GLM-4.6+Claude Code).</div><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.152.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2017 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.backupnext.cloud" target="_blank">Lei Wei</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script src="https://backupnextcloud.disqus.com/embed.js" defer></script><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/lunr/lunr.min.js"></script><script src="/lib/lunr/lunr.stemmer.support.min.js"></script><script src="/lib/lunr/lunr.en.min.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script>window.config={"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/en/index.json","lunrLanguageCode":"en","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.stub.js","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script src="/js/theme.min.js"></script><script>
            var doNotTrack = false;
            if ( false ) {
                var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
                var doNotTrack = (dnt == "1" || dnt == "yes");
            }
            if (!doNotTrack) {
                window.dataLayer = window.dataLayer || [];
                function gtag(){dataLayer.push(arguments);}
                gtag('js', new Date());
                gtag('config', 'G-JS3EGTT92G');
            }
        </script><script src="https://www.googletagmanager.com/gtag/js?id=G-JS3EGTT92G" async></script></body>
</html>
