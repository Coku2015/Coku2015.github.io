<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Zero-Cost Physical Air Gap: How Veeam Outperforms Million-Dollar Sheltered Harbor Solutions - Cloud.Virt.AI.Sec</title><meta name="description" content="Zero-Cost Physical Air Gap: How Veeam Outperforms Million-Dollar Sheltered Harbor Solutions First, I must thank my colleague Zhang Yuan. The design concept for …"><meta property="og:url" content="https://blog.backupnext.cloud/en/2025/11/veeam-airgap-backup-step-by-step/">
  <meta property="og:site_name" content="Cloud.Virt.AI.Sec">
  <meta property="og:title" content="Zero-Cost Physical Air Gap: How Veeam Outperforms Million-Dollar Sheltered Harbor Solutions">
  <meta property="og:description" content="Zero-Cost Physical Air Gap: How Veeam Outperforms Million-Dollar Sheltered Harbor Solutions First, I must thank my colleague Zhang Yuan. The design concept for this solution actually originated from his idea of automatically controlling network firewalls through Palo Alto devices, which he shared internally several years ago. This article simply reproduces his excellent design using zero-cost OpenWRT.
Remember that 2019 article about ransomware attacks?
At that time, I emphasized the importance of data isolation. Ransomware is becoming increasingly intelligent—they no longer just encrypt production data, but also destroy backup servers, delete backup catalogs, and even attack dedicated storage devices.">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-17T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-11-17T00:00:00+00:00">
    <meta property="article:tag" content="Veeam">
    <meta property="article:tag" content="Security">
    <meta property="article:tag" content="Air Gap">
    <meta property="og:image" content="https://blog.backupnext.cloud/2025/11/veeam-airgap-backup-step-by-step/featured-image.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://blog.backupnext.cloud/2025/11/veeam-airgap-backup-step-by-step/featured-image.png">
  <meta name="twitter:title" content="Zero-Cost Physical Air Gap: How Veeam Outperforms Million-Dollar Sheltered Harbor Solutions">
  <meta name="twitter:description" content="Zero-Cost Physical Air Gap: How Veeam Outperforms Million-Dollar Sheltered Harbor Solutions First, I must thank my colleague Zhang Yuan. The design concept for this solution actually originated from his idea of automatically controlling network firewalls through Palo Alto devices, which he shared internally several years ago. This article simply reproduces his excellent design using zero-cost OpenWRT.
Remember that 2019 article about ransomware attacks?
At that time, I emphasized the importance of data isolation. Ransomware is becoming increasingly intelligent—they no longer just encrypt production data, but also destroy backup servers, delete backup catalogs, and even attack dedicated storage devices.">
<meta name="application-name" content="Cloud.Virt.AI.Sec">
<meta name="apple-mobile-web-app-title" content="Cloud.Virt.AI.Sec">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.backupnext.cloud/en/2025/11/veeam-airgap-backup-step-by-step/" /><link rel="prev" href="https://blog.backupnext.cloud/en/2025/11/AI-Reshapes-Data-Protection-02/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Zero-Cost Physical Air Gap: How Veeam Outperforms Million-Dollar Sheltered Harbor Solutions",
        "inLanguage": "en-US",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.backupnext.cloud\/en\/2025\/11\/veeam-airgap-backup-step-by-step\/"
        },"image": ["https:\/\/blog.backupnext.cloud\/2025\/11\/veeam-airgap-backup-step-by-step\/featured-image.png"],"genre": "posts","keywords": "Veeam, Security, Air Gap","wordcount":  1561 ,
        "url": "https:\/\/blog.backupnext.cloud\/en\/2025\/11\/veeam-airgap-backup-step-by-step\/","datePublished": "2025-11-17T00:00:00+00:00","dateModified": "2025-11-17T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Cloud.Virt.AI.Sec","logo": "https:\/\/blog.backupnext.cloud\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Lei Wei"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/en/" title="Cloud.Virt.AI.Sec">Cloud.Virt.AI.Sec</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/en/posts/"> Posts </a><a class="menu-item" href="/en/archive/"> Archive </a><a class="menu-item" href="/en/categories/"> Categories </a><a class="menu-item" href="/en/tags/"> Tags </a><a class="menu-item" href="/en/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search articles" id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/2025/11/veeam-airgap-backup-step-by-step/">简体中文</option><option value="/en/2025/11/veeam-airgap-backup-step-by-step/" selected>English</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/en/" title="Cloud.Virt.AI.Sec">Cloud.Virt.AI.Sec</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search articles" id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/en/posts/" title="">Posts</a><a class="menu-item" href="/en/archive/" title="">Archive</a><a class="menu-item" href="/en/categories/" title="">Categories</a><a class="menu-item" href="/en/tags/" title="">Tags</a><a class="menu-item" href="/en/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><div class="menu-item language" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/2025/11/veeam-airgap-backup-step-by-step/">简体中文</option><option value="/en/2025/11/veeam-airgap-backup-step-by-step/" selected>English</option></select>
                </div></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Zero-Cost Physical Air Gap: How Veeam Outperforms Million-Dollar Sheltered Harbor Solutions</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://blog.backupnext.cloud" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Lei Wei</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2025-11-17">2025-11-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1561 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;8 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/2025/11/veeam-airgap-backup-step-by-step/featured-image.png"
        data-srcset="/2025/11/veeam-airgap-backup-step-by-step/featured-image.png, /2025/11/veeam-airgap-backup-step-by-step/featured-image.png 1.5x, /2025/11/veeam-airgap-backup-step-by-step/featured-image.png 2x"
        data-sizes="auto"
        alt="/2025/11/veeam-airgap-backup-step-by-step/featured-image.png"
        title="/2025/11/veeam-airgap-backup-step-by-step/featured-image.png" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#why-we-need-true-air-gap">Why We Need True Air Gap</a>
      <ul>
        <li><a href="#the-evolutionary-threat-of-ransomware">The Evolutionary Threat of Ransomware</a></li>
        <li><a href="#limitations-of-traditional-solutions">Limitations of Traditional Solutions</a></li>
      </ul>
    </li>
    <li><a href="#veeam-air-gap-key-technologies">Veeam Air Gap Key Technologies</a>
      <ul>
        <li><a href="#core-logic-of-network-control-time-based-access-control">Core Logic of Network Control: Time-Based Access Control</a></li>
        <li><a href="#key-design-precise-control-of-script-execution-timing">Key Design: Precise Control of Script Execution Timing</a></li>
        <li><a href="#firewall-openwrt--control-script-powershell-technical-architecture">Firewall (OpenWRT) + Control Script (PowerShell) Technical Architecture</a></li>
        <li><a href="#prerequisites">Prerequisites</a></li>
      </ul>
    </li>
    <li><a href="#two-business-scenario-implementations">Two Business Scenario Implementations</a>
      <ul>
        <li><a href="#scenario-1-isolation-zone-as-primary-backup-storage-backup-data-directly-enters-isolated-state">Scenario 1: Isolation Zone as Primary Backup Storage, Backup Data Directly Enters Isolated State</a></li>
        <li><a href="#scenario-2-backup-copy-isolation-solution-where-second-backup-data-enters-isolation-zone">Scenario 2: Backup Copy Isolation Solution Where Second Backup Data Enters Isolation Zone</a></li>
      </ul>
    </li>
    <li><a href="#verification-and-summary">Verification and Summary</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="zero-cost-physical-air-gap-how-veeam-outperforms-million-dollar-sheltered-harbor-solutions">Zero-Cost Physical Air Gap: How Veeam Outperforms Million-Dollar Sheltered Harbor Solutions</h1>
<p>First, I must thank my colleague Zhang Yuan. The design concept for this solution actually originated from his idea of automatically controlling network firewalls through Palo Alto devices, which he shared internally several years ago. This article simply reproduces his excellent design using zero-cost OpenWRT.</p>
<p>Remember that 2019 article about ransomware attacks?</p>
<p>At that time, I emphasized the importance of data isolation. Ransomware is becoming increasingly intelligent—they no longer just encrypt production data, but also destroy backup servers, delete backup catalogs, and even attack dedicated storage devices.</p>
<p>Many administrators have encountered this kind of conversation:</p>
<p>&ldquo;Boss, we&rsquo;ve been hit, all data is locked!&rdquo;</p>
<p>&ldquo;Did you have backups?&rdquo;</p>
<p>&ldquo;We did, but the backup server was also infected, the catalog is gone, even the most secure storage can&rsquo;t be restored&hellip;&rdquo;</p>
<p>In such situations, even if you spent millions on &ldquo;safe harbor&rdquo; devices, if they&rsquo;re still connected to the network, they theoretically can still be attacked. Regardless of whether the attack succeeds, the chances of being targeted by hackers are still significant.</p>
<h2 id="why-we-need-true-air-gap">Why We Need True Air Gap</h2>
<h3 id="the-evolutionary-threat-of-ransomware">The Evolutionary Threat of Ransomware</h3>
<p>When I first wrote about ransomware in 2017, they were relatively simple, only encrypting production data. But now the situation is completely different.</p>
<p>Modern ransomware has multiple attack capabilities:</p>
<ul>
<li>Destroy backup servers</li>
<li>Delete backup catalog databases</li>
<li>Disable backup software services</li>
<li>Even attack dedicated backup storage devices</li>
</ul>
<p>This means that even if you have backups, if your backup servers and storage devices are still online, there&rsquo;s a risk of being attacked.</p>
<h3 id="limitations-of-traditional-solutions">Limitations of Traditional Solutions</h3>
<p>Many vendors&rsquo; &ldquo;isolation&rdquo; solutions are essentially logical isolation, relying on complex software rules and configurations. But software always has vulnerabilities, configurations can have errors, and network connections themselves are attack surfaces.</p>
<p>True Air Gap should be: <strong>After backup completion, data completely disappears from the network layer</strong>.</p>
<p>Physically still exists, logically disappears. Even the VBR server itself cannot find the backup storage. This is true physical isolation.</p>
<p>Today, I&rsquo;ll show you how Veeam can achieve such true physical isolation by combining modern technologies.</p>
<h2 id="veeam-air-gap-key-technologies">Veeam Air Gap Key Technologies</h2>
<h3 id="core-logic-of-network-control-time-based-access-control">Core Logic of Network Control: Time-Based Access Control</h3>
<p>The core idea of implementing Air Gap is actually quite simple: <strong>Time-based network access control</strong></p>
<ul>
<li>During backup: Network accessible</li>
<li>After backup: Network inaccessible</li>
<li>During recovery: Re-accessible</li>
</ul>
<p>This doesn&rsquo;t require any advanced technology, just two components:</p>
<ol>
<li><strong>A network device that supports API</strong> (this article uses zero-cost OpenWRT router as an example)</li>
<li><strong>An automation script</strong> (this article uses PowerShell, but shell scripts would also work)</li>
</ol>
<h3 id="key-design-precise-control-of-script-execution-timing">Key Design: Precise Control of Script Execution Timing</h3>
<p>This is the most critical technical point of the entire solution, with design principles as follows:</p>
<ul>
<li><strong>Opening timing</strong>: Must be initiated <strong>outside</strong> of cross-wall data transfer jobs (independent job)
<ul>
<li>Because the network must be opened before data transmission begins.</li>
<li>Data transfer jobs immediately follow the wall-opening policy, utilizing Veeam job scheduling&rsquo;s &ldquo;After this Job&rdquo; feature.</li>
<li>Cannot rely on the transfer job itself, because the job checks storage availability before starting, and if it finds it unavailable, the job fails.</li>
</ul>
</li>
<li><strong>Closing timing</strong>: Can be closed within the data transfer job (post-processing script)
<ul>
<li>Because the closing operation is cleanup work after data transfer completion.</li>
<li>There are no subsequent factors affecting task success or failure, so it can be safely closed within the task.</li>
</ul>
</li>
</ul>
<h3 id="firewall-openwrt--control-script-powershell-technical-architecture">Firewall (OpenWRT) + Control Script (PowerShell) Technical Architecture</h3>
<p><strong>Architecture Description</strong>:</p>
<p>In my experiment, there are two subnets: production subnet 10.10.1.0/24 and isolation subnet 10.10.2.0/24. Under normal circumstances, these two subnets are not routable, with routing between them controlled in OpenWRT.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/8257pC9NLSGlrYD.png"
        data-srcset="https://s2.loli.net/2025/11/17/8257pC9NLSGlrYD.png, https://s2.loli.net/2025/11/17/8257pC9NLSGlrYD.png 1.5x, https://s2.loli.net/2025/11/17/8257pC9NLSGlrYD.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/8257pC9NLSGlrYD.png"
        title="Xnip2025-11-15_14-39-04" /></p>
<p>The OpenWRT router controls access between the two network segments:</p>
<ul>
<li>By default, segments 10.10.1.0/24 and 10.10.2.0/24 are completely disconnected</li>
<li>Scripts control routing rules between the two networks</li>
<li>Automated control is achieved through Luci RPC API</li>
</ul>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>
<p>For OpenWRT, I chose version 24.10. There are many methods to install soft routers on vSphere, so I won&rsquo;t detail them here. The only thing worth mentioning is that to execute remote commands, you need to install the luci-mod-rpc component for OpenWRT, with the installation command:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">opkg install luci-mod-rpc</span></span></code></pre></div></div>
</li>
<li>
<p>Two scripts: one <code>open_the_door.ps1</code> to add routing tables, and another <code>close_the_door.ps1</code> to remove routing tables. My experiment scripts have been uploaded to my Github repository. If you want to try them out, you can reference my methods and get the scripts for testing.</p>
</li>
<li>
<p>Repository address: <a href="https://github.com/Coku2015/Veeam_Scripts/tree/main/Vee_blog_airgap" target="_blank" rel="noopener noreffer ">https://github.com/Coku2015/Veeam_Scripts/tree/main/Vee_blog_airgap</a></p>
</li>
</ul>
<h2 id="two-business-scenario-implementations">Two Business Scenario Implementations</h2>
<h3 id="scenario-1-isolation-zone-as-primary-backup-storage-backup-data-directly-enters-isolated-state">Scenario 1: Isolation Zone as Primary Backup Storage, Backup Data Directly Enters Isolated State</h3>
<p>This method is suitable for users with extreme security requirements, where data is directly backed up to the isolation zone. It requires two Veeam jobs to cooperate, one of which is a fake pseudo-job. There are actually many options for this operation—you can use VMware virtual machine backups or physical machine backup jobs. The core idea is to use a dynamic object container as the backup object to trick the backup job, causing it to have no actual backup objects to process. This way, the backup job becomes a simple script execution engine. We use this engine to activate the routing table addition script, opening network access. The real backup job then uses &ldquo;After this Job&rdquo; to follow this pseudo-job, achieving seamless wall opening for data transfer.</p>
<p><strong>Configuration Steps</strong>:</p>
<p>With routing enabled, configure Veeam&rsquo;s Hardened Repository, then use the <code>close_the_door.ps1</code> script to remove the routing table.</p>
<ol>
<li>Create a script-dedicated backup job, in this example created using vSphere empty Tag group method. In the object selection interface, select a Tag named &ldquo;open_the_door&rdquo; that contains no objects. After object selection, it looks like this:</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/lU3xEm8iej5yZ7s.png"
        data-srcset="https://s2.loli.net/2025/11/17/lU3xEm8iej5yZ7s.png, https://s2.loli.net/2025/11/17/lU3xEm8iej5yZ7s.png 1.5x, https://s2.loli.net/2025/11/17/lU3xEm8iej5yZ7s.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/lU3xEm8iej5yZ7s.png"
        title="Xnip2025-11-16_23-18-23" /></p>
<ol start="2">
<li>In the Advanced tab of Storage configuration, we need to configure the Job&rsquo;s Pre or Post script, selecting the <code>open_the_door.ps1</code> script. Here, either configuration would work, with minimal difference.</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/xf9rNQgRqwcPSUO.png"
        data-srcset="https://s2.loli.net/2025/11/17/xf9rNQgRqwcPSUO.png, https://s2.loli.net/2025/11/17/xf9rNQgRqwcPSUO.png 1.5x, https://s2.loli.net/2025/11/17/xf9rNQgRqwcPSUO.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/xf9rNQgRqwcPSUO.png"
        title="Xnip2025-11-16_23-21-06" /></p>
<ol start="3">
<li>Set the schedule task—this is our starting point for wall opening and backup, for example, starting at 10 PM every night.</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/hyuSn5MGgP1FqtK.png"
        data-srcset="https://s2.loli.net/2025/11/17/hyuSn5MGgP1FqtK.png, https://s2.loli.net/2025/11/17/hyuSn5MGgP1FqtK.png 1.5x, https://s2.loli.net/2025/11/17/hyuSn5MGgP1FqtK.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/hyuSn5MGgP1FqtK.png"
        title="Xnip2025-11-16_23-21-57" /></p>
<ol start="4">
<li>Create a second job—the actual job that executes real backup tasks. In this job&rsquo;s Storage configuration, still in the Advanced tab, configure Post Script, selecting the <code>close_the_door.ps1</code> script. Here it must be configured as Post Script to close the firewall.</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/1NxUr8d65ulVWYz.png"
        data-srcset="https://s2.loli.net/2025/11/17/1NxUr8d65ulVWYz.png, https://s2.loli.net/2025/11/17/1NxUr8d65ulVWYz.png 1.5x, https://s2.loli.net/2025/11/17/1NxUr8d65ulVWYz.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/1NxUr8d65ulVWYz.png"
        title="Xnip2025-11-16_23-25-45" /></p>
<ol start="5">
<li>Set the schedule for this job, specifying &ldquo;After this Job&rdquo; and selecting the &ldquo;Open_the_door_job&rdquo;, indicating it starts immediately following the wall-opening job.</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/83Arb5fwExehmRZ.png"
        data-srcset="https://s2.loli.net/2025/11/17/83Arb5fwExehmRZ.png, https://s2.loli.net/2025/11/17/83Arb5fwExehmRZ.png 1.5x, https://s2.loli.net/2025/11/17/83Arb5fwExehmRZ.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/83Arb5fwExehmRZ.png"
        title="Xnip2025-11-16_23-26-33" /></p>
<p>Through this configuration, we achieve fully automated operation of opening the wall before data backup begins and immediately closing it after backup completion, requiring no manual intervention in daily use.</p>
<h3 id="scenario-2-backup-copy-isolation-solution-where-second-backup-data-enters-isolation-zone">Scenario 2: Backup Copy Isolation Solution Where Second Backup Data Enters Isolation Zone</h3>
<p>This method is suitable for customers with high security requirements who don&rsquo;t want to lose recovery verification capabilities and restore convenience. It copies data from primary storage to secondary isolated storage through Backup Copy jobs. For users, this method doesn&rsquo;t require additional tasks for assistance—only need to open the firewall when the main backup task ends, then let the Backup Copy job immediately follow the Backup job execution, also using &ldquo;After Job&rdquo; mode, and the Backup Copy job executes the firewall closing operation after completion.</p>
<p><strong>Configuration Steps</strong>:</p>
<ol>
<li>
<p>Create the main backup job, and in the Advanced tab of Storage configuration, configure Post Script, selecting the <code>open_the_door.ps1</code> script. Here I recommend configuring Post Script to minimize wall opening time, avoiding the isolation zone entering open state prematurely during the main backup task&rsquo;s long data transmission process. This configuration is exactly the same as Scenario 1&rsquo;s second step.</p>
</li>
<li>
<p>Create a Backup Copy job. For Copy mode, you must select Periodic mode here, as only this mode allows us to set &ldquo;After this Job&rdquo; in the Schedule.</p>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/rDA9eOZmW7CbTRn.png"
        data-srcset="https://s2.loli.net/2025/11/17/rDA9eOZmW7CbTRn.png, https://s2.loli.net/2025/11/17/rDA9eOZmW7CbTRn.png 1.5x, https://s2.loli.net/2025/11/17/rDA9eOZmW7CbTRn.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/rDA9eOZmW7CbTRn.png"
        title="Xnip2025-11-16_23-29-00" /></p>
<ol start="3">
<li>In the Advanced tab of Target configuration, still configure Post Script, selecting the <code>close_the_door.ps1</code> script. Here it must be configured as Post Script to close the firewall.</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/Szfmxvb9RcFyQTj.png"
        data-srcset="https://s2.loli.net/2025/11/17/Szfmxvb9RcFyQTj.png, https://s2.loli.net/2025/11/17/Szfmxvb9RcFyQTj.png 1.5x, https://s2.loli.net/2025/11/17/Szfmxvb9RcFyQTj.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/Szfmxvb9RcFyQTj.png"
        title="Xnip2025-11-16_23-30-50" /></p>
<ol start="4">
<li>Set the schedule for this job, specifying &ldquo;After First backup job&rdquo;. This job doesn&rsquo;t start at a specific time, but rather starts after the wall is opened.</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/fdXUCwISs8OjqZR.png"
        data-srcset="https://s2.loli.net/2025/11/17/fdXUCwISs8OjqZR.png, https://s2.loli.net/2025/11/17/fdXUCwISs8OjqZR.png 1.5x, https://s2.loli.net/2025/11/17/fdXUCwISs8OjqZR.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/fdXUCwISs8OjqZR.png"
        title="Xnip2025-11-16_23-31-26" /></p>
<p>Through this configuration, we achieve fully automated operation of opening the wall before data copying begins and immediately closing it after data copying completion, requiring no manual intervention in daily use.</p>
<blockquote>
<p>Backup Copy must use Periodic mode, not Mirroring mode.</p>
</blockquote>
<h2 id="verification-and-summary">Verification and Summary</h2>
<p>When the jobs run, you&rsquo;ll see that all jobs execute successfully, and there will be related Post Script execution success prompts in the jobs. Let&rsquo;s look at the actual data situation.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/5VkYLdhvwsFmjEg.png"
        data-srcset="https://s2.loli.net/2025/11/17/5VkYLdhvwsFmjEg.png, https://s2.loli.net/2025/11/17/5VkYLdhvwsFmjEg.png 1.5x, https://s2.loli.net/2025/11/17/5VkYLdhvwsFmjEg.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/5VkYLdhvwsFmjEg.png"
        title="Xnip2025-11-16_23-32-42" /></p>
<p>After backup completion, when we go to the Backup Infrastructure section of the backup server, we&rsquo;ll typically see our Backup Repository in an Unavailable state. This is the expected state, indicating that this repository is inaccessible.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/lKut7x8BvS2rbAz.png"
        data-srcset="https://s2.loli.net/2025/11/17/lKut7x8BvS2rbAz.png, https://s2.loli.net/2025/11/17/lKut7x8BvS2rbAz.png 1.5x, https://s2.loli.net/2025/11/17/lKut7x8BvS2rbAz.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/lKut7x8BvS2rbAz.png"
        title="Xnip2025-11-16_23-33-56" /></p>
<p>When we find data in Backups and select the delete operation, the system will prompt that the data is inaccessible. It&rsquo;s worth noting here that this differs from our online state with Immutable repository—it doesn&rsquo;t prompt that data cannot be deleted before xx time, but rather directly shows that data is inaccessible, connection is refused, and operations cannot be performed.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/bkHRLGICOsVfoc5.png"
        data-srcset="https://s2.loli.net/2025/11/17/bkHRLGICOsVfoc5.png, https://s2.loli.net/2025/11/17/bkHRLGICOsVfoc5.png 1.5x, https://s2.loli.net/2025/11/17/bkHRLGICOsVfoc5.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/bkHRLGICOsVfoc5.png"
        title="Xnip2025-11-16_22-58-13" /></p>
<p>When selecting restore operations, the Restore point interface directly displays that restore point access is denied.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/gnbYHKsuOxwC6Zj.png"
        data-srcset="https://s2.loli.net/2025/11/17/gnbYHKsuOxwC6Zj.png, https://s2.loli.net/2025/11/17/gnbYHKsuOxwC6Zj.png 1.5x, https://s2.loli.net/2025/11/17/gnbYHKsuOxwC6Zj.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/gnbYHKsuOxwC6Zj.png"
        title="Xnip2025-11-14_21-42-29" /></p>
<p>Of course, this solution still has a tiny imperfection: in the Host Discovery events that occur every 4 hours, there will inevitably be one scan of this repository that will show an error. If Veeam R&amp;D could set this type of Repository to be excluded from Host Discovery, it would be even more elegant!</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2025/11/17/UraVAHPnyjBN6S5.png"
        data-srcset="https://s2.loli.net/2025/11/17/UraVAHPnyjBN6S5.png, https://s2.loli.net/2025/11/17/UraVAHPnyjBN6S5.png 1.5x, https://s2.loli.net/2025/11/17/UraVAHPnyjBN6S5.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2025/11/17/UraVAHPnyjBN6S5.png"
        title="Xnip2025-11-16_23-36-24" /></p>
<p>As shown above, with this configuration, don&rsquo;t you feel that security has been further enhanced?</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2025-11-17</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/en/2025/11/veeam-airgap-backup-step-by-step/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="https://api.qrserver.com/v1/create-qr-code/?size=240x240&amp;data=https%3A%2F%2Fblog.backupnext.cloud%2Fen%2F2025%2F11%2Fveeam-airgap-backup-step-by-step%2F" target="_blank" rel="noopener noreferrer" title="Share on 微信" aria-label="Share on 微信"><i class="fab fa-weixin fa-fw" aria-hidden="true"></i></a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fblog.backupnext.cloud%2Fen%2F2025%2F11%2Fveeam-airgap-backup-step-by-step%2F&amp;text=Zero-Cost&#43;Physical&#43;Air&#43;Gap%3A&#43;How&#43;Veeam&#43;Outperforms&#43;Million-Dollar&#43;Sheltered&#43;Harbor&#43;Solutions" target="_blank" rel="noopener noreferrer" title="Share on X" aria-label="Share on X"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%253A%252F%252Fblog.backupnext.cloud%252Fen%252F2025%252F11%252Fveeam-airgap-backup-step-by-step%252F" target="_blank" rel="noopener noreferrer" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="https://www.facebook.com/sharer/sharer.php?u=https%253A%252F%252Fblog.backupnext.cloud%252Fen%252F2025%252F11%252Fveeam-airgap-backup-step-by-step%252F" target="_blank" rel="noopener noreferrer" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/en/tags/Veeam/">Veeam</a>,&nbsp;<a href="/en/tags/Security/">Security</a>,&nbsp;<a href="/en/tags/Air-Gap/">Air Gap</a></section>
        <section>
            <span><button type="button" class="link-button" onclick="window.history.back();">Back</button></span>&nbsp;|&nbsp;<span><a href="/en/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/en/2025/11/AI-Reshapes-Data-Protection-02/" class="prev" rel="prev" title="AI Reshaping Data Protection (Part 2): Using Claude Code to Control Your VBR Server"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>AI Reshaping Data Protection (Part 2): Using Claude Code to Control Your VBR Server</a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">English content on this site is generated by AI (GLM-4.6+Claude Code).</div><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.152.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2017 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.backupnext.cloud" target="_blank">Lei Wei</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script src="https://backupnextcloud.disqus.com/embed.js" defer></script><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/lunr/lunr.min.js"></script><script src="/lib/lunr/lunr.stemmer.support.min.js"></script><script src="/lib/lunr/lunr.zh.min.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script>window.config={"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/en/index.json","lunrLanguageCode":"en","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script src="/js/theme.min.js"></script></body>
</html>
