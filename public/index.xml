<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Backup next cloud</title>
    <link>https://newblog.backupnext.cloud/</link>
    <description>Recent content on Backup next cloud</description>
    <generator>Hugo -- gohugo.io</generator>
    <copyright>Copyright Lei Wei</copyright><atom:link href="https://newblog.backupnext.cloud/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Backup Copy新模式，让3-2-1的黄金法则覆盖更广</title>
      <link>https://newblog.backupnext.cloud/post/2020-06-02-new-backup-copy/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-06-02-new-backup-copy/</guid>
      <description>Backup Copy理论基础 Veeam的Backup Copy是实现数据保护3-2-1黄金法则的基础，也是VBR的基础功能之一。它的功能非常简单，实现的效果就是将一个还原点（Restore Point）完完整整的拷贝一份，变成一个新的可以使用的还原点。什么是还原点？在VBR中它是某个VM或者Server某个时间点的记录，利用还原点，可以从VBR的存储库中将数据还原回该时间点的那份内容。对于还原点来说，它可能包含了一个文件，比如vbk全备份存档，也有可能包含了一组文件，一个vbk和一系列的vib，这取决于备份作业或者备份拷贝作业如何创建他们。
Backup Copy制作的备份链和普通的Backup作业制作的备份链略有不同，Backup Copy通常制作的备份链是永久增量的模型，也就是说，第一次的传输，Backup Copy会创建一个.vbk的全备份存档，在第二次开始的后续传输中，Backup Copy会基于第一次的.vbk形成一份.vib的增量存档，并且一直创建下去。
Backup Copy默认使用合成全备份的技术生成并创建全备份存档，只是这个全备份存档必须是基于GFS策略来创建，举个例子来说，如下图所示:
这个Backup Copy作业设置了14个还原点（Restore Points），每天运行一次作业，那么实际上在运行了一个周期后，它将得到如下结果：
如果开启了GFS每周的全备份后，Weekly Backup如果设置成2份，如下图设置。
那么这样的设置将得到如下结果，其中前两个全备份存档是根据GFS的策略要求，所创建出来的Weekly Full的存档。
V10的新变化 在V10版本中，Veeam的Backup Copy发生了一些变化，原来的Backup Copy模式继续保留，但是新增了一种全新的模式，因此这两种模式有了各自的名字：Immediate Copy和Periodic Copy。新增的模式叫做Immediate Copy，老的模式赋予了新的名字Periodic Copy。两种模式有一些区别，他们支持的内容会不一样，如下表所示。
   支持的备份存档 Immediate Copy Periodic Copy     vSphere和Hyper-V虚拟机备份 支持 支持   VBR集中管理的Veeam Agent 支持 支持   SQL和Oracle的日志备份 支持 不支持   非集中管理的Veeam Agent 不支持 支持   Oracle RMAN和SAP HANA 支持 不支持   Nutanix AHV 不支持 支持   AWS EC2 不支持 支持   Microsoft Azure 虚拟机 不支持 支持    除此之外，这两种Copy模式，在备份存档的生成上，有一些区别，对于Immediate Copy而言，他会根据主备份任务的设定，当主备份任务执行完成后，立刻生成一份备份拷贝存档。Immediate Copy是主备份任务的1：1的完全还原点镜像。但是需要特别注意的，它不是简单的备份文件的镜像，并不是vbk、vib的文件拷贝。举个例子来说，在主备份任务中如果设置了每个周六创建Synthetic Full的备份作业，会在周六生成全备份存档，而在这个备份存档生成后，Immediate Copy作业会运行并创建对应的Copy存档，这个创建出来的存档和主备份任务创建出来的vbk全备份不一样，它创建出来的是一份vib的增量备份。由于Immediate Copy的特点，它适用于所有需要进行应用程序日志复制的备份作业，因此在异地容灾时，对于关键的数据库系统，通过Immediate Copy能提升RPO级别。</description>
    </item>
    
    <item>
      <title>Kasten K10入门系列 - 快速搭建K8S单节点测试环境（上篇）</title>
      <link>https://newblog.backupnext.cloud/post/2020-12-07-setting-up-quick-demo-for-k10-01/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-12-07-setting-up-quick-demo-for-k10-01/</guid>
      <description>自从Veeam收购Kasten之后，最近玩K8S特别多，最大的体会是，茫茫多的各种命令和对互联网的强烈需求，假如连不了网，特别是连不了国外的容器镜像站点时，通常的情况就是抓瞎，啥都干不了。当然，这在各位K8S和容器大拿眼里，并不是什么问题，而对于广大非软件开发专业的系统管理员和系统工程师来说，挑战着实不小。
要搭建一套Kasten K10的Lab环境，其基础条件是K8S群集，Kasten K10是原生的云应用，它赖以运行的环境和备份恢复的对象都是K8S。因此，摆在我们面前的难题变成了简单快速不费劲的搭建一套K8S环境并且部署一个简单的有状态应用。这在没有网络的情况下，实在是太为难了。不过，办法总比困难多，不是吗？这点小小的阻碍完全难不倒熟练使用虚拟化技术的虚拟化管理员，在做了一番功课之后，我借鉴了Veeam日本的同事分享的快速部署脚本，使用了虚拟化中独特的OVF（Open Virtualization Format）方式，将这个过程封装成了一个虚拟一体机（Virtual Appliance），让这个Demo Lab的搭建过程大大简化，实现了不需要任何网络下载，即可搭建出这样一套单节点群集，并且内置了包含MySQL数据库的WordPress应用。
先放上这个虚拟一体机的下载链接：
https://cloud.189.cn/t/mAnyMrA36vam（访问码：wd69）
需要说明的一点是，这个虚拟一体机为个人测试研究所用，不得用于任何商业目的，本人不保证这个设备的安全性、可靠性和稳定性，请各位使用者自行判断。
虚拟一体机使用说明： 
在导入完成后，虚拟一体机的首次启动中，会自动配置设备的IP地址。等到配置完成后，可以使用ssh连接登入系统进行K8S环境的基础配置。访问的初始用户名密码为：
username: k10 Password: P@ssw0rd 进入系统后，使用sudo -i命令进入root用户。
K8S群集初始化需要按顺序执行/root/目录下的5个脚本文件，分别是：
0-minio.sh 1-createk8s.sh 2-loadimage.sh 3-storage.sh 4-wordpress.sh 脚本执行过程中所涉及到的需要用到的相关文件，我已经全部放置在/root/目录下了，脚本会自动调用这些文件。
这些脚本都用来干啥？ 0-minio.sh 这个脚本会使用开源对象存储领域第一块招牌minio(https://minio.io) ，创建出一套本地的对象存储，命令执行后，对象存储就运行起来了，可以通过https://&amp;lt;虚拟一体机IP&amp;gt;:9000 来访问对象存储的web界面，web界面的初始用户名密码：
username: minioadmin Password: minioadmin 1-createk8s.sh 这个脚本是使用Kind技术（K8S in Docker），在容器中运行K8S的节点来快速部署K8S的群集，K8S所用到的容器镜像已经提前被内置在这个一体机中，因此不需要去网上下载1.3G左右的K8S docker镜像。可以在运行脚本之前通过以下命令来确认K8S docker image已经就位：
$ docker images list | grep kind 在脚本运行完成后，就可以正常使用kubectl的命令来查看所有K8S的资源了，这时候kubectl的所有命令都能正常使用了。比如，你可以试试这个：
$ kubectl get nodes 2-loadimage.sh 这个脚本其实没什么特别秘密，纯粹是为后面第四第五个脚本做准备，提前将内置在本地CentOS中的docker images加载到Kind中，供Kind使用。
3-storage.sh 这个脚本为K8S群集创建本地的CSI Hostpath driver，其用到的脚本可以在（https://github.com/kubernetes-csi/csi-driver-host-path）中找到，我对这个脚本要用到的互联网下载链接做了修改，更改为所有yaml文件都用本地/root/文件夹中的文件，并且对于这个脚本中用到的所有docker image，也提前从互联网上pull下来并在上一步加载至Kind中。
在运行脚本前，可以通过以下命令查询部署前的storage class：
$ kubectl get sc 在脚本运行完成后，可以通过再次运行这个命令，查看到新配置好的storage class。</description>
    </item>
    
    <item>
      <title>Kasten K10入门系列 - 快速搭建K8S单节点测试环境（下篇）</title>
      <link>https://newblog.backupnext.cloud/post/2021-04-28-setting-up-quick-demo-for-k10-02/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2021-04-28-setting-up-quick-demo-for-k10-02/</guid>
      <description>在上一篇中，我为大家提供了一个简易的ova镜像，这个镜像用于在vSphere上快速搭建单节点K8S演示环境。也许有些朋友并不喜欢这种ova的方式，而更喜欢自己安装整个环境，那么我今天的这篇就来详细介绍下这个环境的安装方法。
这个基础环境的安装说明以Ubuntu 20.04LTS为例，如果有需要其他版本的朋友，请自行根据这些命令修改，在开始之前，需要首先有一个能够正常访问互联网（部分国际网站需要特殊访问渠道）的Ubuntu 20.04服务器能够使用，并且使用了root用户登录到这台服务器。
步骤一：安装并启用Docker服务 root@UK10:~# curl -fsSL https://get.docker.com -o get-docker.sh &amp;amp;&amp;amp; \ &amp;gt;	sh get-docker.sh 安装完毕后，可以查看下docker版本信息
root@UK10:~# docker version 步骤二： 下载kind。 root@UK10:~# curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.9.0/kind-linux-amd64 root@UK10:~# chmod +x ./kind &amp;amp;&amp;amp; mv ./kind /usr/local/bin/kind 步骤三：安装kubectl root@UK10:~# apt-get update &amp;amp;&amp;amp; apt-get install -y apt-transport-https gnupg2 root@UK10:~# curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - root@UK10:~# cat &amp;lt;&amp;lt;EOF &amp;gt;/etc/apt/sources.list.d/kubernetes.list &amp;gt;	deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main &amp;gt;	EOF root@UK10:~# apt-get update &amp;amp;&amp;amp; apt-get install -y kubectl root@UK10:~# kubectl completion bash &amp;gt;/etc/bash_completion.</description>
    </item>
    
    <item>
      <title>VAO基础入门（一） -  简介</title>
      <link>https://newblog.backupnext.cloud/post/2020-02-17-vao-guide-01/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-02-17-vao-guide-01/</guid>
      <description>随着Veeam旗舰产品Veeam Availability Suite v10的发布，Veeam Availability Orchestrator(以下简称VAO)也会在不久更新为v3.0版本，目前来说VAO产品还是处于v2.0版本。对于绝大多数同学来说，可能这个产品非常神秘，看似功能非常高大上，但是也不知道如何使用，我的这个基础入门系列将会和大家分享一些本人对于VAO的一些研究。
什么是VAO？ 简单来说，他是VAS加强版。它需要和VAS一起工作，离不开VAS；VAO还需要和VMware vSphere一起工作，它仅限于支持VMware的虚拟化环境。
 能够通过软件的设置，来保证企业实施的灾备基础架构的满足所要求的RPO和RTO； 能够尽可能自动化的完成灾备的切换过程，该操作同时支持备份存档和复制存档； 能够通过数据实验室，来确保灾备的精准可靠，所有灾备演练将在数据实验室中1:1的完整演练。  VAO替代了VBR中Recovery、Failover以及Surebackup的操作，可以说是对于这3个关键操作的进一步加强，在这些关键操作中，可以加入各种自定义的步骤和脚本，使之能够更加接近实际业务场景中的使用。对于管理员来说，合理的设计这3个操作中的额外步骤能极大程度的降低IT运维中灾备流程的复杂度。
VAO支持哪些场景使用？ VAO支持的数据中心从简单到复杂，都可以使用，以下仅简单从最基本的架构举两个例子：
单个数据中心 单个数据中心内，加入VAO的组件后，和原有VAS的架构几乎没有太大差别，所有VBR上的操作不会有任何改变，常规的所有备份恢复操作都在VBR上可以完成，而VAO则在这里开始担当关键业务的RPO和RTO的确保任务。通常来说关键业务出现宕机后，都会在原始位置实现恢复，因此也没有特别的专用资源用于恢复准备。
因此，在这种场景下，唯一需要改变的是选择一些关键的VM，由VAO来接管这些VM的RPO和RTO。
一主一备数据中心 稍微复杂点，也是很典型的场景，就是跨区域的主备数据中心，主中心承担生成业务，而备中心承担灾备业务。我们通常VAS的设计会将备份存档拷贝到灾备中心进行存放，也可能会将一些关键的VM直接1:1的复制到灾备中心。而这时候，在灾备中心的数据恢复流程都将可以被编制到VAO的Failover Plan或Recovery Plan中，同时这些Plan也将会被在相应的Datalabs中做完整的恢复演练。
这种场景下，原先VAS的架构也没有太大变化，和单数据中心非常相似，只是我们可以规划一部分资源专用于灾备恢复。
VAO支持的两种Plan VAO本身并不提供备份和复制功能，所有对于源数据的提取功能，都会在VAS/VBR中完成。VAO中提供了两种Plan：Restore Plan和Failover Plan。
Restore Plan 这是对应VBR中的Backup &amp;amp; Restore功能，所有对备份存档（.vbk，.vib，.vrb等）的恢复，都归为这一类。
Failover Plan 这是对应VBR中的Replication &amp;amp; Failover功能，所有对于Replicas的故障切换，都归为这一类。
这两种Plan支持的操作：
 - DataLabs 测试 - 资源可用性测试 - 完整报告自动生成 - 一键式全自动恢复、故障切换 VAO额外支持的DataLabs功能 作为Veeam产品看家本领，DataLabs功能在VAO中也是极大增强，在VAO中不仅能将DataLabs用于以上两种Plan的测试，还能利用VAO中强大的脚本和步骤添加功能，自动化的生成各种复杂的用于测试的环境。通过这种增强，复杂的测试用例，复杂的环境部署工作将会被简化成一键式的按钮，极大提升DataLabs的使用效率。
以上就是VAO的简介，欢迎关注VAO基础入门系列，在最近一段时间我会陆续更新以下内容：
 VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  </description>
    </item>
    
    <item>
      <title>VAO基础入门（七） -  Plan Step · 上篇</title>
      <link>https://newblog.backupnext.cloud/post/2020-02-27-vao-guide-07/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-02-27-vao-guide-07/</guid>
      <description>系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  前一篇，我详细介绍了Orchestration Plan，在我们设计灾备计划时，可以从某个Application入手，从简到繁循序渐进的规划整个数据中心的灾备。
创建Orchestration Plan时默认情况下，为每个灾备计划内置了最基础的Step，而VAO的强大之处在于它能够添加各种Step，系统内置了一些常用的Step，管理员只需要根据自己实际的需求选择相应的Step，然后配置相关参数即可使用。
Out-of-the-box的Plan Steps 这些出厂自带的steps一共22个，大概可以分为这么几类：
 恢复操作 - 2个
Datalab Lab验证操作：
 - DataLab准备操作 - 1个 - 虚拟机基础验证 - 2个 - 应用验证 - 12个  通知操作 - 2个
虚拟机电源操作 - 2个
虚拟机服务启动操作 - 1个
 这些操作基本没什么特别需要注意的地方，所以的内容都已经固化内置在系统中了，根据系统的提示，填入相关的内容即可。本文不详细展开逐个讨论这里每一个Step的参数配置方法，具体大家可以根据实际情况选择逐个测试。
Plan Step通用参数 在每个Plan Step中，都会包含一个最基础的Common Parameter，这是对于这个Plan Step执行的基本控制条件，包含以下内容：</description>
    </item>
    
    <item>
      <title>VAO基础入门（三） -  基本组件 · 上篇</title>
      <link>https://newblog.backupnext.cloud/post/2020-02-19-vao-guide-03/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-02-19-vao-guide-03/</guid>
      <description>系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  VAO引入了一套非常特殊的概念，它为该产品中使用的组件定义了一系列名称，随着版本的更新和迭代，这里的组件和名称可能会发生一些变化。目前VAO的版本是v2.0，因此本文所述内容仅适用于v2.0之后的版本，而后续版本中如果有新的变化，我会在后续的更新中说明。
Scope 定义和用途 Scope是VAO的最核心的概念，在v2.0中首次引入了这个概念。每个Scope中包含了灾备中需要一系列元素，VAO把这些元素称为Plan Components：
 - VM Groups - Recovery Locations - Plan Steps - Credentials - Template Jobs 打个比方，Scope是一间房间，那么在这个房间中所放置的各种家具就是以上这些Plan Components。对于灾备来说，以上这些Plan Components将会在Orchestration Plan中被具体使用到。可以说Orchestration Plan是将这些Plan Components有序的组合起来，最终可以让我们实现一键的灾备恢复。
另外，Scope中还有个非常特殊的Component &amp;ndash; Datalab，每一个Datalab对应某个Scope中，也就是说，每个Scope都有一个或多个独立的属于自己的DataLab。
关于Plan Components和DataLab，将在VAO基础入门（四）- 基本组件 · 下篇中详细介绍。
分类和创建方式 VAO中的Scope可以大致分为两类，一类是系统内置的名称叫Default的Scope，这个Scope无法删除，无法修改名称，并且Administrator的Role会被包含在这个Scope中，在VAO的其他Scope中是无法选择添加Administrators Role。当您要授予任何用户执行Administration配置操作时，您就需要将该用户添加至Default Scope下的Administrators Role。还记不记得在前一篇推送中提到的初始化步骤，在初始化过程中所添加的用户，默认就会被添加到这个Administrators Role下面。当然我们可以来添加更多的用户到Administrator Role中。</description>
    </item>
    
    <item>
      <title>VAO基础入门（九） -  文档模板解析</title>
      <link>https://newblog.backupnext.cloud/post/2020-03-02-vao-guide-09/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-03-02-vao-guide-09/</guid>
      <description>系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  本系列的最后一篇，我来介绍一下VAO的文档系统。
VAO能够全自动的为管理员生成灾备需要的系统文档，文档的内容为VAO系统自动根据Orchestration Plan的设置和执行自动生成。VAO文档系统的强大在于所有的内容系统根据配置和运行会全自动生成，因此管理员只需要专心关注自己的灾备即可，这些后续的基础保障，繁琐的文档制定，全部交给VAO来完成。
VAO生成的每个文档会包含两部分，第一部分是灾备管理员定义的Report Template；第二部分是系统根据Report Type生成的动态内容。无论什么类型的文档，在文档的开头部分都会使用Report Template中所定义的内容，而第二部分则根据Report Type不同自动填充相关内容。
我们先来看个实际的例子，了解一下什么是Report Template中的内容，什么是根据Report Type自动生成的，如下图：
左边是一个VAO最终生成的Readiness Check的Report，右边是我们在编辑器中打开的Report Template。可以看到红色框所示的内容就是来自于Report Template的，而图中左边文档的后半部分内容则是根据这个Report Type，自动产生的内容。
Report Type 先来说说这个Report Type，也许聪明的你，在前几篇介绍Orchestration Plan的时候已经有看到，在每个Plan的右键菜单或者工具栏上有一些Report可以生成，它们分别是：
   Report类型 作用     Plan Definition Report 记录灾备计划设置详情   Readiness Check Report 灾备计划可用性检测报告，包含恢复目标位置和灾备中心的可用性检测   Datalab test Reort 数据实验室测试报告   Excution Report 灾备执行情况报告    这些Report就是VAO能够生成的所有Report文档，这些文档都会有一个VAO已经内置设计好的内容，能够和灾备管理员定义的Report Template组合起来，最终形成一份完整可以阅读的Report。</description>
    </item>
    
    <item>
      <title>VAO基础入门（二） -  安装与部署</title>
      <link>https://newblog.backupnext.cloud/post/2020-02-18-vao-guide-02/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-02-18-vao-guide-02/</guid>
      <description>系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  VAO 安装包获取 Veeam官网可以直接下载VAO，直达电梯
这个安装包是一套完整的VAO套件，其中包括VAO主程序、内嵌的VBR以及内嵌的VeeamONE，需要注意的是，这个安装包虽然包含了内嵌的VBR和内嵌的VeeamONE但是这两个软件都无法被提取出来单独安装，这两个内嵌的软件都是VAO工作的必要组件，它们是跟着VAO一起工作的。
这两个内嵌的VBR和VeeamONE和正常的软件没有任何区别，在安装完VAO后可以以常规的访问方式访问使用，目前在这个安装包中包含的VBR是9.5U4版本，VeeamONE是9.5U4版本；在VAO安装完成后，使用VBR和VeeamONE的正常升级方式将这两个组件升级至9.5U4a或者4b的版本。
安装前提条件 非常重要的两点提示：
  请不要在已经安装了VBR或者VeeamONE的服务器上安装VAO软件包。 请不要在域控制器上安装VAO软件包。   一般来说，我们建议不管您是否已经安装了VBR，如果是进行VAO的安装，都应该准备一台全新的Windows服务器来安装VAO的安装包。
安装完成后，您可以将您原来的VBR加入到VAO环境中来由VAO纳管，也可以使用VAO内嵌的VBR来进行常规的备份和复制任务。
其他更多的安装前提条件，请参考官网的前提条件说明。
安装过程 安装包是个ISO文件，通过挂载ISO的方式打开这个镜像后自动运行，可以找到VAO的安装按钮：
整个安装过程非常简单，和Veeam其他产品的安装一样，跟着向导无脑点完下一步就能做完最基础的安装，安装完成后，请务必将VBR 9.5U4a和VeeamONE 9.5U4a的补丁打上，这一步千万不要忘了，因为9.5U4a这个补丁修复了很多VAO碰到的问题。
关于VBR 9.5U4a的升级，同样也可以参考我之前的博文。
需要注意的是，在安装过程中会要求输入用户名密码，此处的用户名密码为VAO、VBR、VeeamONE的服务和它们的数据库需要使用的用户名密码，因此此密码要求的最小权限为这台VAO Server的Windows 本地管理员权限，隶属于本地Administrators组即可。
这个账号虽然和后续灾备所使用的灾备管理员的账号没有任何关系，但是在后续的初始化配置的第一步需要输入此账号来登入VAO的UI界面。
初始化配置   安装结束后，请不要去打开内置的VBR和VeeamONE的控制台，请立刻开始初始化配置，系统只有在初始化配置完成后才能够正常工作，进入初始化配置的界面请访问：https://VAOIP:9898/ 这时候浏览器会提示输入用户名密码，请使用上图安装时所用到的用户名密码作为初始化登入使用的用户名密码。特别注意，这个密码只在初始化配置时使用1次，在初始化配置完成后，将会使用初始化配置过程中设定的VAO灾备管理员的用户名密码。
  登入账号后，系统进入初始化向导，Welcome页面中有些信息，有兴趣的话可以阅读一下，这页很简单，只需读完后点击Next。   输入一些VAO服务器的基础管理信息，这些信息在后续的文档模板中都会有用到。当然这些信息在配置完成后都能在Configuration中进行修改，不用担心填错。   此处需要填入VAO灾备管理员的账号，需要注意的是，此处的账号为初始化配置结束后登入VAO UI的灾备管理员的账号，此账号需要属于域账号，因此在整个VAO的部署中，Active Directory 是必要条件，如果环境中没有AD域，那就创建一个VAO专用的AD域吧。 请一定记住此处填入的灾备管理员的账号，在这个向导结束后，安装阶段使用的本地管理员账号将再也无法登入系统进行初始化配置，替代的是此处填入的账号。</description>
    </item>
    
    <item>
      <title>VAO基础入门（五） -  基础配置要点</title>
      <link>https://newblog.backupnext.cloud/post/2020-02-21-vao-guide-05/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-02-21-vao-guide-05/</guid>
      <description>系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  在前几篇中，我们把VAO的基本架构、基本组件都盘点了一遍，所涉及到的内容都是在Administration中的设置，也就是具有VAO管理员权限的账户所能进行的操作。VAO的管理员可以在这里为每组应用分别设定不同的Scope，同时将这些Scope分派给相关的人员进行使用，利用这一特性，可以有效的进行分组和隔离，是不是有点类似多租户或者多用户？但是又有很大差异。
本篇内容针对之前所提到的这些配置，说明一些可能需要注意的地方。
基础架构 vCenter添加
在安装和初始化配置过程中，我们把vCenter添加入VAO了，这时候之前的帖子如果大家有印象，可能会留意到我都没有提到过内嵌的VBR和Veeam ONE的配置，实际上在初始化配置完成之后，VAO非常智能的将我们在初始化阶段填写的vCenter的信息写入到了VBR和Veeam ONE之中，因此我们不需要再次在VBR和Veeam ONE里面重新添加了。
VBR添加
在VAO中，可以管理多个VBR或Enterprise Manager副本，在管理非内嵌的VBR时，需要做的只是通过推送的方式在VAO的控制台上，将VAO Agent推送到VBR上即可接管该VBR。这个操作也相当简单，通过这样的方式，可以很方便的管理到一个大规模的备份/灾备环境。
Active Directory
在项目实施中，往往很多用户环境没有Active Directory，而VAO又必须要有AD才能工作，这时候特别头疼，但是回过来其实这事情却又很简单。大家可以想想VDI的项目，也都是必须AD才能工作的，那他们那些项目不都得急死了？那倒不会的，因为很简单，没有AD我们就造个AD嘛，为了项目成功，没有条件创造个条件呗，这事完全难不倒我们这些攻城狮。
Scope Scope特别难理解，但是想通了又特别简单，因此这个配置要点说明，我强烈建议大家回过去到我的第三篇，加强理解下Scope的概念，并且通过实战，到VAO中设置一些复杂的场景来理解这个Scope。只有真枪实弹动过手，才能把这个Scope吃透，才能用好VAO，这是最最关键的一个组件。
另外，对于Scope，不能仅仅从Users and Scopes中去看这个Scopes，需要从Scopes的2个维度结合起来看，这样这个概念才会生动的显现在我们面前：
 授权使用这个Scope的用户； Scope包含的5大Components和对应的DataLabs；  Datalabs 请先理解VBR中所有DataLab的配置，如果还不会配置VBR中的DataLab，那么将会玩不转VAO，因为这是VAO的必要组件和必要条件。
DataLabs的配置在VAO中几乎没有任何操作，只是通过Assign的动作分配给对应的Scope，在VAO中想知道自己的DataLabs是如何配置是件非常困难的事情，假如我们需要用到大量的DataLabs，这时候可能只能回到VBR中逐个逐个点开配置去查看，这个非常不科学。那么我在这里有个很不错的小技巧可以提供给大家，在VAO的DataLabs信息中，会从VBR上取得这个DataLabs的Name、Description、Platform和VBR Server Name，这时候大家完全可以利用好这个Description，只需要在VBR中创建DataLabs时，将Virtual Lab Summary的内容Copy出来，贴到这个Virtual Lab的Description中，这样这段关于该DataLabs的详细配置情况就会被读取到VAO中，那么我们也就能够很清楚的知道这个DataLabs的具体配置了。如下图，最终我的效果。
Recovery Locations 设置相对复杂，而且设置完成后就固化下来了，然而这个只是一个计算资源的逻辑组合，他实际上只存在于VAO之中，不管在vCenter、VBR还是VeeamONE之中都不会有这个Recovery Locations存在。因此这也是一个非常好的消息，这个Recovery Locations无论设置成什么样子，他都不会影响除了VAO之外的其他任何组件的正常运行。
小小的Tips给到大家，那就是任性的去设置Recovery Locations吧，放肆的组合吧，就算不会被实际的Orchestration Plan使用到，放在那边又何妨？难说哪天有需要就用到了呢？</description>
    </item>
    
    <item>
      <title>VAO基础入门（八） -  Plan Step · 下篇</title>
      <link>https://newblog.backupnext.cloud/post/2020-02-28-vao-guide-08/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-02-28-vao-guide-08/</guid>
      <description>系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  上一篇，我介绍了Plan Step的基本概况，今天我来详细分解下在Plan Step中的自定义脚本，我会通过一个脚本使用例子，来带大家使用一下自定义脚本。
创建和设置 配置自定义的脚本需要使用隶属于Administrators组的账户登入VAO平台。进入Administration控制台后，可以在Configuration下面找到Plan Steps，在这里可以管理所有的Plan Steps，当然除了创建自定义的Steps之外，也可以在这里对OOTB的那些Steps进行一些个性化的配置。
点击Add按钮即可进入添加向导，过程也非常简单，为它起个响亮的名字，比如：远程的骚操作测试。在File栏，点击Browse从当前的客户端上去选择制作好的powershell脚本吧。
点击Next进入Step Visibility步骤，如果不希望所有的灾备管理员都看到这个骚脚本的话，可以不勾上这个界面的复选框。
最后还是老样子，Summary总结一下，点Finish就创建完成了。但是，这只是创建完成，别想着就马上拿去用，这里特别敲黑板强调一下：
Custom Script可以有两种不同执行位置，一种是在灾备的机器上执行，另外一种是在VBR上执行。这个必须手工在创建完Plan Step之后点击这个Step名称，浏览到右边如图位置进行调整，默认值是在VBR上执行。比如我今天要做的这个测试就是需要调整一下，更改成In-Guest OS。
需要注意的是，这个Step的设置是全局的，也就是说，如果将这个Step提供给所有的Scope使用，那么这项配置内容是所有的Scope共享的，不能做计划任务中做更改。因此管理员如果有必要，需要做这个Plan Steps的管理页面中根据实际需求逐个定义。
Hello！My Script 那么接下来，让我们来配置一个Script跑一把吧。来个简单的，内容如下：
########### #Lei Wei - 02/28/20 # # # 这个脚本是骚操作的代表，请仔细往后看 # # v1.0 $S = Get-Date; Add-Content c:\vao_log.txt &amp;#34;$S - Recording date &amp;#34; 如果一切正常，在VAO中将会看到如下信息：</description>
    </item>
    
    <item>
      <title>VAO基础入门（六） -  成功灾备计划的第一步</title>
      <link>https://newblog.backupnext.cloud/post/2020-02-25-vao-guide-06/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-02-25-vao-guide-06/</guid>
      <description>系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  通过之前的配置，我们的VAO就可以开始正常使用了，我们可以用Plan Authors角色的用户登入到VAO控制台上，在控制台中，将看到被授权允许能访问的Scopes，并且可以对这些Scopes中的对象进行操作，包括Orchestration Plan、DataLabs和Report。
要成功实现企业的灾备计划，达成企业的RPO和RTO，除了需要超级强大的计算资源和工具软件之外，对于这个灾备工具的了解和熟悉程度也是非常重要的一部分。对于VAO来说，本身是一款非常强大的软件，但是需要灾备管理员非常清楚的了解灾备计划的每一部分以及它的操作的预期结果。所以成功的灾备计划第一步，我们先来看看VAO是如何工作的。
在这里我先使用user1@sedemolab.local这个Plan Authors角色的账号登入VAO系统中。它将看到房间Scope A和房间Scope B
Orchestration Plan VAO中可以设定两类Orchestration Plan，分别是恢复计划和故障切换计划，分别对应VBR中的Backup和Replication功能。这两个计划是整个灾备和恢复的基础，所有自动化的操作过程都将会通过这个Plan加入到灾备中去。在这里，我建议首先第一步，尽可能的不要加入太复杂的自动化脚本，而是用系统自带的Plan Steps，用最少的流程来测试两类Plan，等到熟悉了系统的工作机制后，再来逐步逐步添加适合的自定义脚本。
 创建Orchestration Plan，进入左边的Orchestration Plans，在右边内容显示区域，会看到顶部的一排4个按钮，其中在Manage按钮所在的下拉菜单中，可以找到New的按钮。通过这个按钮可以启动Orchestration Plan的创建向导。  2. 打开向导后，首先需要选取使用哪个Scope来创建这个Orchestration Plan，就像前几篇中提到，每个Scope中包含了灾备的一系列元素，而Orchestration Plan则是把这些元素组合起来，形成一个可执行的计划。所以每个Orchestration Plan是属于某个特定的Scope下的Plan。 选择房间（Scope A）后，点击下一步。
设定Plan Info，此处的内容一般来说按照实际的情况填写，这些都会在Report中被使用到。  选择Plan Type，即决定这将是个Restore操作还是Failover操作，两者的唯一区别是，如果是Restore Plan那么将会增加一个Recovery Location的选项，选择我们这Plan Components之前设置好的Location即可。  选择VM Groups，在当前Scope下能看到的所有可用VM Groups都会列在Available Group中，通过Add按钮将需要的Group添加至右边的Plan Groups窗格中。也可以通过View VMs来详细查看当前选定的VM Groups中所包含的VM。  在VM Recovery Options中，需要设置3个内容： If any VM recovery fails then：如果Plan中有多台VM需要恢复，假如其中有一台VM恢复失败，此选项决定了后续的Plan如何操作，可以继续执行计划恢复其他VM或者是直接停止计划。 Recover the VMs in each Group: 按顺序恢复还是同时恢复。如果选择Simultaneously是同时进行，如果是选择In Sequence则是按顺序执行。 Recover simultaneously max of VMs：选择合适的数量，默认是10个，一般来说，管理员需要根据自己的计算资源情况，合理选择，最好执行一些测试后最后决定这里的数量。 Restore VM Tags：这个复选框下有个⚠️，一般来说恢复至新位置成为一个新VM则大多是不会选择这个恢复Tags，避免和生产的VM混起来。  在VM Steps中，可以选择很多恢复过程中的可以用到的Steps，默认情况下，系统自动会选上Restore VM和Check VM Heartbeat这两个Step。我建议刚开始熟悉VAO的管理员逐项逐项的添加各种Step，以测试每一种操作的功能，确定了某个需要的Step之后，再将其设计到自己的最终Plan之中。  在VM被恢复之后，为了确保系统的可靠性，VAO还提供了立刻继续将恢复出来的VM备份起来的功能，在Protect VM Groups中勾选Protect VM Groups after restore并且选择合适的Template Job就行了。这里面的Template Job都是在Plan Component中所选择的。  对于灾备来说，非常非常重要的一个指标就是RTO和RPO了，通常在备份或者容灾软件中很少有看到这两个数值的设定，而在VAO中，灾备管理员可以为每个Plan来制定相应的RTO和RPO目标，如果达成这个目标，系统会显示绿色的状态，而如果无法达成这个目标，则会发出相应警告⚠️。 此项的设置，具体数值可以精细到分钟级别。  管理员还能在VAO中定义Orchestration Plan的报表，在Plan中只需要选择相关的模版即可，可以选择pdf或者word格式的报表。关于报表模版的设计，我将会在本系列的最后一节详细介绍。  选择完报表模版后，可以设定报表计划任务，个人感觉都是报表的内容，实际上没必要分成2个页面来设置，但是不管怎么样，根据VAO产品的设计，我们可以在这里设置每天报表的计划任务，需要注意的是，报表更新的任务是每天为频率的，只能选择每天的时间，不能有其他更多选择。  又是一个复选框占用一个页面，勾选之后，VAO会在Plan创建完成后立刻进行灾备资源的可用性检查，根据实际情况选择即可。  以上就是所有设定步骤，在Summary中查看详细设置后点击Finish就能完成创建。创建完成后，这个Plan将会出现在Orchestration Plan的页面中。  对于创建好的Plan，管理员可以对它做以下操作：</description>
    </item>
    
    <item>
      <title>VAO基础入门（四） -  基本组件 · 下篇</title>
      <link>https://newblog.backupnext.cloud/post/2020-02-20-vao-guide-04/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-02-20-vao-guide-04/</guid>
      <description>系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  Plan Components 以下这些组件，需要针对每个Scope进行设置，上一篇中已经介绍了具体设置位置，接下来我们来看看这些Components都有些什么以及他们的设置方法。
VM Groups VM Groups定义了在这个Scope下面，能管理哪些虚拟机，简单来说就是圈一个范围，哪些虚拟机是属于这个Scope可以操作的，我们的Orchestration Plan针对哪些生产的VM进行操作。
和简单的VM勾选不一样的是，在VAO中，我们没办法很自由的去随意选择哪台VM属于哪个Scope，在VAO中我们只能选择所谓的VM Groups。
然而很尴尬的是，VAO本身并不能创建任何的VM Groups，这些Groups是通过VAO内嵌的Veeam ONE中的Business View引擎来获取的。Business View的系统分组引擎是VAO中非常重要的一个组成部分，它的具体内容可以参考官网手册：
https://helpcenter.veeam.com/docs/vao/categorization/about.html?ver=20
https://helpcenter.veeam.com/docs/one/monitor/bv_categorization_model.html?ver=100
在Business View的分组引擎中有3种使用方式：
 1. vSphere Tags 2. 通过.CSV文件导入 3. 通过VeeamONE的自定义分组策略 这3种方式并没有天然的特殊优劣，还是取决于IT管理员对哪种更熟悉，使用更便捷。
vSphere Tags 这个分组方式需要在vSphere上面进行，通过为不同的VM打入不同的Tags来实现分组，相同Tags名称的虚拟机会被归入同一个VM Groups中，而这个VM Groups的名称就是在vSphere中的Tags的名称。
这种分组方式无法在Veeam系统中做任何修改，只需要在vSphere上操作即可，操作完成后VAO中稍等一小段时间即可收到操作结果，这个操作是全自动的同步。
通过.CSV文件导入 可以手工或者自动进行，这个操作需要在VAO内嵌的VeeamONE上进行，打开VeeamONE Monitor的控制台，在Server Setting中可以找到Business View的标签卡，在这里分别有自动从.CSV文件同步的选项和手工立刻从.CSV文件做单次导入的选项。</description>
    </item>
    
    <item>
      <title>VBR中的那些隐藏键</title>
      <link>https://newblog.backupnext.cloud/post/2020-05-13-hidden-key-in-vbr/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-05-13-hidden-key-in-vbr/</guid>
      <description>VBR升级到v10之后增加了很多全新的功能，也多了很多隐藏的快捷键，今天我就来说说这些隐藏的秘密。
[Ctrl]+鼠标右键 在不少操作中，可以用到这个Ctrl+鼠标右键调出特别的菜单，一般来说，如果不按住Ctrl键，那么直接鼠标右键是看不见这些隐藏的菜单的。
NAS备份中执行一次全新的作业 正常的NAS文件备份在Veeam中都是永久增量备份，然而还是有些用户会需要用到执行一次全新的全备份，在NAS备份中Veeam一样提供了这个功能，只需要选中需要执行的备份作业，按住Ctrl键后，再点击鼠标右键，那么这个全备份的按钮就会出现。
执行完这个全备份后，会出现一个和普通虚拟机全备份/合成全备份稍微不一样的情况，那就是之前的备份数据将会被移动到Disk(Imported)之中，新的备份链将会替代之前的，变成活跃的NAS永久增量备份链。
Oracle/SAP HANA Backup 作业 Force delete 当配置并运行了Oracle或者SAP HANA的Backup作业后，VBR会出现类型为Oracle Rman backup或者SAP Backup的作业，右键点击这些作业会有Delete的选项，但是这个Delete必须要求首先将RMAN或者SAP HANA的备份存档删除掉。这时候如果不希望删除存档，但是只想删除备份作业，可以使用Ctrl+鼠标右键，会出现Force Delete选项。
SOBR的Run tiering job now 我觉得不少朋友肯定会为4小时往云上传一次数据的死板设定犯愁，其实有个右键菜单藏起来了，对着Scale-Out Backup Repository按住Ctrl再点鼠标右键，你就会发现这个立即运行Tiering作业的按钮。
方向左右键 在VBR的Jobs中，双击每个备份作业，可以查看最新的备份作业执行详情，然而如果要去看一些更早的历史作业，可能就会迷失在VBR的控制台中了。稍微复杂一点的操作是，打开History面板，然后找希望查看的日期逐个查看，也可以通过搜索进行一些关键字的过滤。
其实我们完全不需要打开History面板，VBR提供了在每个作业详情中查看历史作业的方法，只需要在详细任务信息界面按左右方向键，就能查看过往信息，虽然说不能像History中那样灵活选择，但是在快速排错时，是一个很不错的选择。
其他隐藏的鼠标右键 有些界面中，藏着一些鼠标右键可用的菜单，很不容易被发现，但是有时候却是很有用的，多数情况下，这些右键操作并不想干扰用户的正常操作，所以并没那么容易被发现。
SureBackup Statistics窗口中的右键 双击一条SureBackup Job，弹出Statistics窗口，能够看到上一次作业执行时上面的每一台VM的成功失败状态。除此之外，在这个静态的查看窗口，藏着一个Start按钮，选中Statistics窗口中的任意一台VM，除了能够在下面的详细日志中查看执行情况外，还能右键再次Start这个Datalab。
这个Start按钮主要是为我们在SureBackup失败时做一些Troubleshooting用途，点击Start之后，在Session log中会显示SureBackup 切换进入了Troubleshooting mode，在这个模式中，SureBackup Job不会因为失败或者成功被立刻终止，它会保持运行状态，一直到我们手工终止结束它。这里请确保Troubleshooting或者使用结束后，执行Stop按钮。
存放于含有Capacity Tier的备份存档 通常在打开Backups的属性对话框右键点击备份存档时，普通的备份存档只有copy path的按钮，这是为了让我们快速的从文件系统中找到该vbk、vib文件。
但是有些时候，如果是SOBR中含有Capacity Tier，条件满足的情况下，右键点这些备份存档，会出现新的右键菜单。
Ok，以上就是今天的一些隐藏按钮，如果觉得好用，赶紧点赞用起来哟。另外，如果您发现了更多的，也可以留言告诉我。</description>
    </item>
    
    <item>
      <title>Veeam Agent for Linux基础知识</title>
      <link>https://newblog.backupnext.cloud/post/2020-09-22-veeam-linux-agent-101/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-09-22-veeam-linux-agent-101/</guid>
      <description>自从年初Veeam Agent for Linux 4.0（简称VAL）随着VBR V10推出以来，这个功能越来越强大的备份代理使用也越来越广，不管是云上还是云下、虚拟还是物理，总有场景会用到VAL。然而我们发现对于刚刚接触VAL的朋友们其实还是会受到这个代理安装过程的困扰，就算是全自动的推送安装，依然会有朋友会碰到各种各样的安装问题。这让本来以使用体验极佳著称的Veeam备份软件变得很尴尬，“It just works!”的口号都不敢随便喊了。
其实，Veeam还是那么简单，VAL一样是这种简单极致的体验，就算是在大众门槛略高的Linux开源世界，只需要稍稍注意，就可以体验到VAL的极致简单使用体验。当然这需要一点点小技巧，对于熟练使用Linux的朋友，这些都不是问题，而对于不少只是因为要备份才接触Linux的备份管理员来说，会略有一些挑战。这主要原因是来自于VAL的软件安装依赖包，和Windows不一样的是，Veeam在所有Windows Server所需要安装的依赖包都集成在Veeam软件中，VBR会全自动的去推送所有缺失的依赖包。而对于Linux来说，在Veeam软件包中其实并不包含任何的依赖包，所有这些依赖包都来自于Linux系统本身的Software Package Manager，这里要划个重点！
什么是Package Manager？
打个比方，这个就是和手机的应用市场类似，每一个Linux系统都内置了这样的Package Manager，而不同发行版的Linux可能会使用不一样的Package Manager。Package Manager非常的智能，通常在主流的Linux发行版中安装软件最简单的方法就是通过Package Manager的一行命令就完成了，Package Manager会全自动的完成所有依赖组件的安装，最终交付相应软件给管理员使用。
在VAL支持的多种操作系统中，不同的系统使用不同的Package Manager，下面就是这些系统所对应使用的Package Manager清单。
   Linux发行版 默认常见的Package Manager     CentOS/Redhat/Oracle Linux/Fedora yum   Debian/Ubuntu Apt   SLES/openSUSE zypper    很显然，不管使用什么方式，我们要正常安装VAL，第一个前提条件就是Package Manager能够正常的工作，这个在有互联网连接的Linux系统中，完全没问题，绝大多数情况下系统安装完成后就自带了合适的软件安装源；然而在无法访问互联网的服务器数据中心，如果没有合理配置内部源，就会碰到各种报错了。处理方法也很简单，只需要去对应的Linux发行版的官网，下载当前版本的最新版ISO，并制作成本地源即可。比如，CentOS6.x就下载CentOS 6.10的iso，CentOS 7.x就下载CentOS 7.8.2003的iso镜像，然后挂载到CentOS中。本文以常见的CentOS 7.6为例说明下这个配置的全过程。
 首先找一个CentOS 7.8.2003的镜像下载点，比如阿里云的 https://mirrors.aliyun.com/centos/7.8.2003/isos/x86_64/ 在CentOS中，挂上这个刚刚下载到的镜像。  [centos@localhost ~]$ sudo mkdir /mnt/cdrom [centos@localhost ~]$ sudo mount /dev/cdrom /mnt/cdrom 备份并移动/etc/yum.</description>
    </item>
    
    <item>
      <title>Veeam Agent for MAC单机版使用全攻略</title>
      <link>https://newblog.backupnext.cloud/post/2021-04-04-mac-agent/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2021-04-04-mac-agent/</guid>
      <description>Veeam Agent for MAC随着Veeam v11版本推出，原本这个产品是集成在VBR之中，我也一直以为这个只能是被VBR统一管理才能使用，然而当我仔细阅读官网的UserGuide之后，发现在Veeam Agent for MAC竟然可以工作在Standalone模式下。惊喜之下，赶紧动手来玩了一把。
Veeam Agent for MAC的安装包可以通过VBR中Create Protection Group向导获得，当然如果觉得太麻烦，可以直接到下面这个链接下载我已经提取出来的pkg安装包。
https://cloud.189.cn/t/eEZVvifyqIrm
Veeam Agent for MAC的pkg包安装相当简单，双击运行即可，和普通的其他pkg软件包完全一致，一路下一步即可。大约3~5分钟之内，备份软件就按照好了。在安装完毕后，需要进行初始化设置，因为属于第三方软件，按照Apple惯例，需要在系统偏好设置-&amp;gt;安全性和隐私-&amp;gt;隐私设置中为Veeam Agent for MAC启用完全磁盘访问功能，如图：

Veeam Agent for MAC遵循了极简的软件设计原则，整个软件由两部分组成，第一部分为Command-line，命令行软件交互，用户备份作业设定以及所有软件功能的配置；第二部分为Control Panel，图形化软件界面，主要用于数据还原和管理工作。在日常使用中，通常第一次配置完备份计划任务后，就不需要再使用命令行做任何操作了，需要恢复数据时只需要通过Control Panel中的Restore来进行数据还原即可。
Command Line 命令行的Veeam Agent for MAC操作命令为：
user@macOS-BigSur ~ % veeamconfig 第一步：设置Repository Standalone模式下，配置备份系统都在MAC上进行，因此需要为备份作业首先设置一个备份存放位置，一般来说可以是以下几种：
 本地磁盘上某一个目录 外接移动硬盘 SMB共享文件夹，远程的某个NAS目录  以SMB共享为例，可以使用以下命令创建一个备份存储库，在Veeam中通常都叫Repository：
user@macOS-BigSur ~ % veeamconfig repository create --name macbackup --type smb --location //&amp;lt;ip address or dns&amp;gt;/sharefoldername/ --username adminuser --password 这里有几个关键参数：
 &amp;ndash;name：后面跟着一个Repository的名称，可以随意设置自己希望的名称，但是需要注意的是这个名称在后面备份任务设定中会用到，不要忘记记下来。 &amp;ndash;type：如果是共享文件夹，需要加这个参数，如果不是，就不需要了。但是这个参数如果使用的话，他后面的类型必须加上smb，不能是其他的。 &amp;ndash;location：远程smb路径，或者是本地某个目录。 &amp;ndash;username和&amp;ndash;password：smb访问专属  整个命令的意思是：创建一个备份存储库（veeamconfig repository create）,存储库名称（&amp;ndash;name）叫 “macbackup”，类型（&amp;ndash;type）为“smb”共享文件夹，共享路径（&amp;ndash;location）是“//IP地址/共享文件夹名” ，访问这个共享需要使用用户名（&amp;ndash;username）“adminuser”，访问这个共享需要输入密码（&amp;ndash;password）。</description>
    </item>
    
    <item>
      <title>Veeam Availability for Nutanix AHV配置和使用系列（一）</title>
      <link>https://newblog.backupnext.cloud/post/2018-07-28-van-01/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2018-07-28-van-01/</guid>
      <description>Veeam Availability for Nutanix AHV（下文简称VAN）正式发布了，本文详细介绍下这一新工具的使用方法。
此次的软件发布以Proxy Appliance形式，到Veeam官网直接下载Zip包解压即可得到一个Disk Image，这是一个vmdk文件。和其他Veeam软件一样，这里官网依旧能够申请到一个30天的试用许可。
VAN的架构解析：
由于VAN的特殊性，这个下载得到的Appliance并不能直接使用工作，它是Veeam Backup &amp;amp; Replication的一部分，需要依赖Veeam Backup &amp;amp; Replication一起才能实现Nutanix AHV的数据保护。其架构如下图：
所以，如果是一个单一的AHV环境，我们还是首先需要部署一套VBR，完了之后再开始VAN的部署，而VBR中也需要激活相应的Zero-Socket VBR ENT+的许可，才能完全发挥VAN的所有功能。本文对于VBR部分就不详细展开说明，请参考官网手册。
VAN部署方法：
 上传镜像至Nutanix 镜像库中，在Prism上选择配置镜像。  打开配置镜像对话框，选择上传镜像。  为新的镜像输入名称、备注，选择镜像类型为Disk，选择合适的Storage Container，然后指定刚刚解压开来的这个vmdk的路径后，点击保存。  等待一段时间，AHV系统经过上传、初始化之后，任务栏在完成所有任务后，我们再次打开配置镜像对话框后，会发现我们上传的VeeamProxy这个镜像意见处于Active的状态了。  接下去我们开始利用这个Image来创建VM，这个VM就是Nutanix中用来提取数据的引擎，它和VMware环境的中的Proxy非常相似，只是这个是Veeam封装起来的一个Linux。  创建VM过程也是非常简单，按照手册中的建议配置填即可，2vCPU/2Core/4GB Memory，新增一块磁盘，选择镜像库中的源作为磁盘，然后指定一个网络地址用于初始化访问。
这样，VeeamProxy for AHV就创建好了。在AHV上开启这个虚拟机，经过简单的初始化后，即可进入系统，系统命令行提示，可以通过一个https的地址访问到VAN并进行初始化配置。到这个步骤，其实Nutanix上的所有操作已经完成，接下去就是进入VAN界面进行Veeam Proxy的初始化配置了。  浏览器打开Proxy Appliance地址，纯黑的界面，配上绿色的Veeam Logo。输入默认的Admin后即可进入Proxy Appliance首次配置向导。  新的Proxy Appliance第一次进入可以选择是全新安装或者从配置文件进行恢复，这里我先选择了全新Install。  进入安装向导后，首先需要接受一个最终用户许可协议（End User License Agreement），勾选Accept之后点击下一步。  重新设定Admin的密码，进入下一步网络设定。  为Proxy设定主机名以及ip地址。  回顾一下设定内容后，点击Finish后系统会进行一轮重启，然后初始化配置就完成了。  接下去再次进入Proxy Appliance的web console，会提示输入License，所有Nutanix的许可都会在Proxy Appliance上直接管理。从这步开始，需要对这个Proxy Appliance进行三项基础配置设定，使其能够进入正常工作状态。  点击右上角齿轮配置图标，进入配置界面，在这里分别激活License、配置VBR Server以及添加Nutanix Cluster。操作交互方式也非常简单，一些基础信息足够完成配置。  首先是License，和其他Veeam的License一样，导入.</description>
    </item>
    
    <item>
      <title>Veeam Availability for Nutanix AHV配置和使用系列（二）</title>
      <link>https://newblog.backupnext.cloud/post/2018-07-30-van-02/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2018-07-30-van-02/</guid>
      <description>上一期介绍了《Veeam Availability for Nutanix AHV的安装和配置》，本期来说说VAN的备份和恢复。
备份AHV的虚拟机
VAN的所有备份操作依旧是以备份作业方式，但是和VMware/Hyper-V不同的是，Nutanix AHV的VM备份作业都会在VAN Console中进行，而不是VBR上。
进入VAN Console中，上面的菜单非常简单，顶部从左向右分别是仪表盘、备份作业、已保护的虚拟机、事件这4个页面。
备份作业可以进入Backup Jobs中设定，同时在这里也能查看到备份作业的运行状态。
备份作业设定步骤
 在Backup Jobs页面中，点击Add按钮就可以新增备份作业。设置过程还是Veeam经典的向导模式，5个步骤就能完成所有设定操作，非常简洁。  第一步，和VBR中的设定一样，是Job Name和Job Description，根据实际情况输入信息即可。
选择备份哪些VM，这里和vSphere/Hyper-V还是非常像，可以选择非VM的对象，比如一个Host或者一个Cluster。  点击Add即可打开Nutanix AHV的对象选择，和vSphere/Hyper-V不一样的是，这里会提示哪些VM处于Unprotected状态，这能很好的避免重复备份，也能快速定位哪些VM没有备份。
选择备份至什么位置，这里会列出VBR中已经设定了Allow权限的Repository，可以选择普通的Repository，也可以选择Scale-out Repository。  设定计划任务，此处的界面会稍微有点不同，个人认为这一新的Web界面让Schedule选择变得更加美观，而计划任务的逻辑则和原来的VBR是完全一致。  最后一步review一下以上设定后，备份作业就设定完了。备份作业会在指定的时间自动开始运行。  查看备份状态
而备份作业运行后，我们可以在VAN Console或者VBR中查看到备份状况，而VBR中并不能做任何的编辑，仅能查看状态。
还原AHV的虚拟机
VAN的还原可以在VAN Console中操作，也可以在VBR Console中进行。但是在这两个控制台中能做的操作会有些差别。
VAN Console还原
在VAN Console中，Veeam提供完整虚拟机还原和虚拟磁盘还原。
完整虚拟机还原
 点击Restore按钮，会打开还原向导。  点击Add添加需要还原的虚拟机。  点击Point按钮，可以选择适合的还原点进行恢复。
进入下一步后，可以选择还原位置。对于原始位置，没有太多选项，是对原有虚拟机的直接覆盖，而选择恢复到新位置时，可以输入更多配置，变成一台新的虚拟机。  设定新的VM name，和原始VM名称不同。
选择合适VM Container，默认这里是原始的位置，可以根据实际情况选择新的节点和新的Container。  输入合适的还原理由后，可以开始VM的完整还原。  部分Disk还原
 点击Disk Restore，可以启动单个virtual disk的还原向导，选择需要还原的VM  选择合适的还原点。  设定Disk映射关系。
设定完Restore Reason后，点击Finish即可进入恢复过程。  VBR Console 还原</description>
    </item>
    
    <item>
      <title>Veeam Cloud Tier – 云对象存储使用详解（一）</title>
      <link>https://newblog.backupnext.cloud/post/2019-02-21-cloud-tier-01/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2019-02-21-cloud-tier-01/</guid>
      <description>2019年1月23日Veeam发布了其产品历史上功能最多的一次Update包 VBR 9.5U4，其中包含了一系列和云相关的功能模块，本文将会详细讨论其中最主要的一个特性：云对象存储。
在VBR 9.5U4中，可以使用Amazon S3、Microsoft Azure Blob、IBM Cloud Object Storage以及其他各种兼容S3协议的对象存储，因此，对于我们国内用户AliCloud OSS和Tencent Cloud COS也能够完美支持。
云对象存储的定位
在VBR中有三大类Repository，分别是Backup Repository、External Repository和Scale-Out Backup Repository（SOBR）。我相信对于绝大多数Veeam使用者，Backup Repository是再熟悉不过了，那是Veeam存放备份数据的磁盘位置，也是以往被使用最多的数据存放方式。External Repository是VBR 9.5U4新增的，这个并不是本文云对象存储涉及到的部分，本文暂且不讨论。而SOBR，在以前的VBR版本中，可能鲜有提及，而在未来，这将可能成为Veeam最主要的数据存储方式。
在了解云对象存储之前，我觉得有必要来回顾一下SOBR的组成，每个SOBR都会由1个以上的Extents组成，每个Extents其实就是一个常规的Backup Repository，也就是说，SOBR就是一个Backup Repository的集合，这是以往SOBR的基本组成。
在这个全新的SOBR中，Veeam把它分成两个层级，分别是Performance Tier和Capacity Tier，所有本地磁盘组成的Extend都被归类为Performance Tier，而云对象存储组成的Extents则被归类为Capacity Tier。
工作原理
简单来说，含有云对象存储的SOBR必须由1个以上的Extents组成，然后必须包含1个云对象存储。
 每隔4小时，Veeam会根据SOBR中的保留策略设定自动运行SOBR Offload任务，将本地需要上传至云端的数据上传至云端的对象存储中。 相对的，SOBR Download任务则对应可以将云对象存储中的数据取回本地Extents之中。  而在还原过程中，云对象存储可以说是近乎于透明状态的存在，它和以往任何的存储解决方案都会不一样，在Veeam中，云对象存储上的还原点，可以保留其原有的任何还原能力，以完全源生平滑的方式来进行数据还原。
我们来看一个实际的例子：当进行数据还原时，选择的还原点位于云对象存储上时，Veeam首先会去读取本地的数据索引（Index），这个Index会告诉Veeam，哪些数据同时存在于云上和本地，那么在读写数据时，Veeam将会优先去使用本地的数据作为数据源，而只会从云中获取那些本地不存在的数据。这将大大减少云对象存储的使用费用，因为绝大多数的云对象存储的使用计费会更多的按照请求和回流来计算。
管理和操作
1.添加云对象存储
上文提到过，云对象存储也是属于SOBR的一个Extents，而Extents则是一个Backup repository，因此添加云对象存储的入口就是Add Repository。
在Add Backup Repository中会新增一个向导Object Storage，这就是添加云对象存储，其中包含了上文提到的4种不同的协议。
添加过程非常简单，如同任何Veeam功能一样，以交互的方式填入合适的信息即可完成配置，本文就不做官方User Guide的复读机了，可以根据实际使用的云对象存储选择合适的存储类型进行添加。
https://helpcenter.veeam.com/docs/backup/vsphere/new_object_storage.html?ver=95u4
配置SOBR和Capacity Tier  在Backup Infrastructure中找到Scale-Out Backup Repository，然后点击Add来新增，这时候需要首先配置Performance Tier。关于Performance Tier的配置详细选项，本文就不展开进行详细讨论，有需要的可以查看官方User Guide中的相关章节。
https://helpcenter.veeam.com/docs/backup/vsphere/sorb_add_extents.html?ver=95u4
选择默认的Placement Policy后，就可以进入Capacity Tier的配置，这时，在上一步中配置的云对象存储库就会出现在下图的List中，同时在这个页面上我们也可以配置如何去进行SOBR Offload任务，也就是我们前面提到的SOBR的保留策略。
设置完本页内容之后，云对象存储的配置就完成了。
3.使用操作</description>
    </item>
    
    <item>
      <title>Veeam Cloud Tier – 云对象存储使用详解（二）</title>
      <link>https://newblog.backupnext.cloud/post/2019-03-04-cloud-tier-02/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2019-03-04-cloud-tier-02/</guid>
      <description>上期介绍了Veeam云对象存储使用的基本方法，但是文中有些内容略微有些小错误，在此不再放入该推送的链接，如有需要，请大家后台回复：Cloud或者云调取阅读更新后的版本。本期内容给那些想更深入了解该技术的朋友们。
或许已经有人注意到，在使用Veeam云对象存储以后，不管备份存档是位于本地数据中心还是位于云上对象存储中，Veeam均提供各种丰富的还原手段，其中包括最重要的Veeam于2010年首创的经典技术 – Instant VM Recovery，关于这个技术的详细使用，可以参考之前的推送：
 Veeam黑科技之vPower NFS。  云对象存储特殊属性，各家云厂商在定价上几乎无一例外的采用4个维度来制定收费策略，分别是：容量、读写请求次数、读取数据量、订阅服务时间，这和传统存储设备一次性买断投资的特性完全不同，因此对于长期不使用的数据，存放在云端时，读写请求和读取的费用会变得非常的低，这也是对象存储作为归档异地存放的最佳属性。
但是，这并不意味着备份厂商可以无责任的随意使用对象存储，如果把对象存储当做和传统本地存储一致的属性来对待时，对于传统设备的随意读写的这些操作，特别是做数据校验、数据整理、恢复校验、定时重删任务等读写操作，会给用户带来额外巨大的I/O和读取费用。因此Veeam为存放到对象存储上的数据做了重新打散处理，并且定义了一系列的存取规则，以确保数据可用性的前提下，尽可能少的使用读写I/O和读取数据量，降低云端对象存储的使用成本。
元数据（Metadata）和数据块（Block） 每个Veeam的备份存档（.vbk、.vib、.vrb）都会由Metadata和Block组成，在每个本地存储的存档中，Metadata和Block是密不可分的，通常就存在于同一个文件中。而数据被传送到云端对象存储时，Veeam会将两者拆分开来，在各自的目录中，单独存放相关数据。而本地磁盘上，Veeam会保留Metadata，以便能够在恢复时快速找到对应的Block。
索引（Index） 索引通常在SOBR Offload Job启动时生成，其内容包含了.vbk、.vib、.vrb这些文件中，各切片数据块的哈希值（Hash），Veeam从备份存档的Metadata中提取这些Block的哈希值。生成这些哈希值后，Veeam会首先把这些内容存放在Scale Out Backup Repository下该backup job对应的Extents目录下的ArchiveIndex目录中。在以后的任何一次数据传输中，如果有数据块的哈希值和已有的哈希值相同，那么Veeam将会重复利用这些已经传输的数据块，而不会再进行传输，避免浪费带宽。
需要注意的是，这个索引是基于完整备份链（Backup Chain）生成的，也就是说，对于两个不同的Backup Job，即使对于同一台VM做了Backup，实际上在上传到对象存储的时候，就算数据块拥有相同哈希，也会被重复上传。由于这是整个备份链中的数据块信息，因此，每次的备份链发生变化，那么在下一次执行SOBR Offload Job时都会重新生成这个索引。
这个索引中的内容，同时包含了某一数据块在云端对象存储中和在本地磁盘存储中的位置信息，如果某一数据块同时存在于3份不同的全备份存档中，其中两份位于本地磁盘中，一份位于云端对象存储上，那么索引会将这些信息都记录下来。当需要执行SOBR Offload Job进行新数据上传时，VBR如果发现新的上传数据中需要上传这份云端已有数据，那么VBR会跳过该数据块的上传，同时在本地和云端更新相应记录，以此来节省上传带宽和节省上传时间。
当需要还原时，同样的，VBR会判断被还原的数据块中的哈希值，如果发现索引中有提到本地磁盘中还存放着这些数据块，那么VBR会优先选用本地磁盘上的数据作为还原读取的源，从而大大节省从云端对象存储中读取的数据量。
而正是这个原因，也使得选用云端对象存储上的数据执行Instant VM Recovery变得可行。
备份链的活跃部分和非活跃部分
只有备份链的非活跃部分，才能被上传至云对象存储中。无论是手工操作还是自动任务，处于备份链活跃部分的还原点，无论如何都将不会被上传至云对象存储上。
这也是本次更新后Veeam对于备份链新引入的两个概念，这是在了解云端对象存储数据上传任务中非常重要的两个概念。介绍这两个概念之前，我们来复习下备份链（Backup Chain）的定义：在Veeam的备份存档中，存放在存储介质中的数据以备份链的形式存放，以普通增量备份为例，一般存放结构如下图所示，那么对于一个Backup Job而言，这一组文件的集合，被称之为备份链（Backup Chain）。
而备份链的活跃部分和非活跃部分则是以最后一次全备份为分界线，在最后一次全备份之前的部分，我们称之为备份链的非活跃部分，而在最后一次全备份之后的所有增量备份和该全备份，被称之为备份链的活跃部分。如下图所示：
当然这依然是以普通增量备份为例，对于反向增量备份、永久增量备份、Backup Copy，情况会略有不同，但是基本规则也和上面提到的一致。
随着时间的推移，作业的进行，早期的还原点（Restore Point）将会因为新的全备份的产生而被转换为非活跃，从而实现Offload操作。
总结一下，哪些数据将会被上传至云对象存储中：
属于备份链的非活跃部分的数据； 早于Capacity Tier中设定的日期的数据； 这个Block是否之前没有在这个Backup Job中被上传过。 这个3个条件验证完后，数据将会被决定是否会上传。
以上就是本期对Veeam Cloud Tier的深入分析。</description>
    </item>
    
    <item>
      <title>Veeam FAQ系列转载</title>
      <link>https://newblog.backupnext.cloud/post/2019-03-21-veeam-faq/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2019-03-21-veeam-faq/</guid>
      <description>最近有很多Veeam今年新版本特性的系列文章，包括很多云端数据管理的话题，有兴趣的朋友可以参考Veeam云架构师Mars Zhang的系列推文：
Veeam 9.5 U4 新功能，利用 Cloud Mobility 实现迁移即服务
Veeam 云端数据管理新功能，打造BaaS备份即服务 （一）
回归到Veeam最原始的功能，最近开始回过来做做基础知识普及，本系列内容较长，因此分多期推送，这里内容来自于Veeam官方论坛置顶帖，如果有想看原版的，可以直接通过原文链接跳转。
本文纯技术内容，纯纯的干货，就不开篇废话了，直接进入主题：
Architecture
问：请问Veeam备份数据流的流向顺序？
答：磁盘&amp;gt; Backup proxy &amp;gt; 网络&amp;gt; Backup repository &amp;gt; 磁盘
Backup Proxies
问：什么是Backup Proxy Server？
答：Backup Proxy从生产存储中提取虚拟机数据（配置文件和虚拟磁盘），通过应用重复数据删除和压缩来处理数据以减小虚拟机数据的大小，并将虚拟机数据发送到Backup Repository（在备份的情况下）或其他Backup Proxy （在复制的情况下）。 Backup Proxy还用于在还原虚拟机时将虚拟机数据（配置文件和虚拟磁盘）写回VMware的生产存储，以及用于虚拟机的复制。
问：为什么最好在物理机上安装Backup Proxy？
答：由于大量数据流（高达每秒几千兆字节）的即时处理（重复数据删除和压缩）需要大量的CPU，内存和I / O资源，物理Backup Proxy最适合24/7虚拟化环境，具有高整合率。否则，您可能会发现备份过程会影响生产。
问：我可以在什么操作系统上安装Backup Proxy？
答：Microsoft Windows 7 SP1 / Server 2008 SP2 64位操作系统或更新版本.
问：我是否必须设置Backup Proxy才能开始使用产品？
答：不，因为安装程序会自动部署默认Backup Proxy。 但是，我们建议您添加额外的Backup Proxy以实现冗余和负载平衡。 有关最佳部署额外Backup Proxy的建议，将会在后续章节中详细说明。
问：Backup Proxy可以备份自己吗？
答：是的，Backup Proxy可以备份自己和任何其他Veeam Backup &amp;amp; Replication组件。
Synthetic Backup</description>
    </item>
    
    <item>
      <title>VeeamON 2017系列之另类VPN -- Veeam PN</title>
      <link>https://newblog.backupnext.cloud/post/2017-06-16-veeam-pn-intro/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-06-16-veeam-pn-intro/</guid>
      <description>前言 在上个月的VeeamON大会上，Veeam发布了一个全新的产品，这个产品其实和备份是完全没有关系，叫Veeam PN，全称是Veeam Powered Network。这是一款轻量级的SDN解决方案，能够迅速打通多个站点，实现站点-站点之间的通讯，也可以实现终端-站点的通讯。由于此解决方案功能过于强大，本文不想展开全面介绍，详细内容可以参考Veeam KB2271和VeeamPN帮助手册。
今天的内容，我想来介绍下我的使用场景，在我的Home Lab中使用Veeam PN。
先来说说需求，其实这个需求并不复杂，我相信绝大多数的VPN解决方案都能够实现，也就是当我不在家的时候，任意一个地方，我都能连回家里的实验室，进行工作。
实现这个功能，大多数方法可能是基于VPN的方式，也就是说得搭建VPN环境，那么各种环境中搭建方法可能各式各样，而Veeam PN为我这样的环境提供了一个非常简单的部署方法，只需几分钟，鼠标点击几下，就能完成这样的搭建。
架构组件 这整个架构中里面一共有3个组件：
 Veeam Hub  相当于接入点，充当了集中控制所有端点的一个唯一入口。Veeam Hub可以部署在任意的位置，任意的一个有互联网接入的站点、云端都可以，唯一的要求就是能够和其他站点通过广域网互联互通，有公网地址。
Veeam Site Gateway  每个站点的出口连接Hub的网关。这里的每个站点的概念为1个子网，也就是说每个子网都需要一个site Gateway。对于Site Gateway的要求，是有internet接入而不必有公网地址。
VPN客户端  终端连接入私网的客户端，Veeam PN可以使用任何支持OpenVPN的客户端，具体客户端下载可以自行百度查找。
如图，简单架构就是这样。对于我Home Lab，目前仅有一个网段，是10.100.1.0/24，所以在我的Lab中我需要的组件就是一个Hub和一个Site Gateway。这两个组件的部署非常简单，其实是同一个OVA的不同工作模式，具体下载地址可以点击阅读原文查看。
安装配置 在vSphere Client中，和常规部署OVA一样，导入这个虚拟设备进行部署，导入后，可以进入这个Ubuntu系统进行IP地址和主机名。
因为我的这个Hub和Site Gateway都部署在家中，所以我需要重复上面的步骤导入两次，生成2个虚拟机，分别配置为Hub和Site Gateway：
接下去，可以通过网页分别访问Hub和Site Gateway进行详细配置，整个配置过程非常简单，首先来看下Hub，我们进入Hub的网页：
Https://10.100.1.40/
Username：root
Password:VeeamPN
进去后会提示修改密码并选择角色：
先选择Hub，进行下一步：
简单填入一些个性化信息后可以点击下一步，其中加密等级保持默认2048位就可以了。
设置公网IP或者DNS，我在这里输入了我自己的对外internet DDNS域名，端口保持默认。点击Finish就能完成Hub的基础设置。
然后我们来添加一个Site和一个客户端接入点，点击Clients，Add按钮就能打开向导
选择添加一个Site或者一个计算机，Entire Site就是加一个site Gateway，而standalone computer就是远程单独接入点：
我们先加一个Site，选择Entire Site后next：
任意输入一个名字标识，然后添加子网段地址，比如我家Lab是10.100.1.0/24
点击Finish之后，就会自动下载一个.xml文件，这个文件将会在Site Gateway配置过程中用到。
然后我们来再重复前面Add Client步骤来添加一个接入点：
接入点只需要一个名称来标识，没有更多信息需要配置，点击下一步和Finish之后，浏览器会自动下载一个.ovpn文件，这个文件可以在任何的OpenVPN客户端中载入并连接。
接下去可以打开Site Gateway的页面进行Site Gateway的连接Hub配置。
进入site Gateway页面之后依旧是修改密码和初始化向导，只是不同的是初始化向导中选择Site Gateway，而不是network Hub</description>
    </item>
    
    <item>
      <title>Veeam备份服务器升级指南</title>
      <link>https://newblog.backupnext.cloud/post/2020-02-13-how-to-upgrade-vbr/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-02-13-how-to-upgrade-vbr/</guid>
      <description>前言 Veeam即将推出全新的v10版本，在这个版本中，Veeam支持从以前的VBR升级至v10版本，整个平滑升级过程不算复杂，和以往的VBR升级一样，当然也有一些细节需要注意。
升级前 请按照下面的流程图检查当前环境，在升级VBR之前确保其他组件已经正常升级。
由于v10开始，Veeam将使用全新的Veeam Universal License（VUL），所以请提前登陆My.veeam.com获取更新后的License，在升级过程中将会提示使用新的License激活产品。
升级方式 可以采用两种方式升级，没有太大区别。
 在原VBR服务器上原地升级； 全新安装一台VBR服务器，然后将Configuration Backup File还原至这台全新安装的VBR中。  由于第二种方式和全新安装几乎没有任何区别，因此本文不详细展开讨论，而只讨论第一种原地升级方式。
升级准备 准备好Veeam升级介质，Veeam的产品非常简单，升级介质和全新安装使用同一个介质包，只需要把产品包挂载到VBR服务器上即可。在执行Upgrade之前，需要做一系列准备工作：
 仔细阅读Release Notes，检查自己环境，看看是否有不支持的系统。   - VMware vSphere 5.1以及之前的版本 - Windows 2003和XP - Microsoft SQL Server 2005 使用Veeam Configuration Backup功能，将VBR的配置做一个备份，这个备份请确保是用Encrypted模式，这样所有在VBR中使用的用户名和密码将会妥善的被保存在.bco文件中。 检查VBR上面的所有备份作业，确保没有任何作业正在运行，这里要特别注意如下作业，需要手工点击Disable来停止：   - Backup Copy Job - SQL、Oracle的日志备份作业 ​	看看是否有Instant VM Recovery正在运行；
​	看看是否有Veeam Explorer正处于打开并在执行恢复；
​	看看是否有Surebackup/Virtual Lab正在运行。
最终，所有任务都停止后，会是如下图状态：
升级过程 整个升级过程非常简单，只需要按照向导点击几下鼠标，然后静静的等待30分钟以后，软件就能升级完成，因此在这里我就不详细去一步一步说明这个过程了。
可能碰到的问题  升级过程中，升级包会首先停止VBR的所有服务，有可能碰到停止服务超时或者失败，导致升级过程中断，建议碰到失败后首先检查下Services.msc中veeam开头的服务是否被正常停止。 服务都正常停止后，原地升级如果还报错，建议可以把VBR服务器重启一下后，再尝试升级，这里特别注意一下，在VBR重启后，需要重新检查所有VBR的作业，确保没有作业在自动运行。 如果尝试多次都无法进行正常升级，建议使用上面提到的方法二，全新安装一台VBR，然后将Configuration backup文件导入。 如果以上方法全部失败，请及时联系Veeam Support团队，我们的攻城狮将会及时为您提供升级支持。  以上就是升级的一些小提示，感谢阅读！</description>
    </item>
    
    <item>
      <title>Veeam备份服务器升级指南</title>
      <link>https://newblog.backupnext.cloud/post/2021-03-03-how-to-upgrade-vbr-v11-edition/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2021-03-03-how-to-upgrade-vbr-v11-edition/</guid>
      <description>前言 2月25日，Veeam推出全新的v11版本，在去年，我曾经写过一篇升级到v10的帖子，其实本次v11的升级和之前的v10升级没有太多的差别，今天的内容，我将之前的这个帖子提到的做一些针对v11的调整，算是一些些小更新吧。
升级前 请按照下面的流程图检查当前环境，在升级VBR之前确保其他组件已经正常升级。

v11完全兼容之前v10的VUL许可，因此已经在使用VUL许可的，可以完全不需要准备或者导入许可文件。
升级方式 可以采用两种方式升级，没有太大区别。
 在原VBR服务器上原地升级； 全新安装一台VBR服务器，然后将Configuration Backup File还原至这台全新安装的VBR中。  由于第二种方式和全新安装几乎没有任何区别，因此本文不详细展开讨论，而只讨论第一种原地升级方式。
升级准备 准备好Veeam升级介质，Veeam的产品非常简单，升级介质和全新安装使用同一个介质包，只需要把产品包挂载到VBR服务器上即可。在执行Upgrade之前，需要做一系列准备工作：
 仔细阅读Release Notes，检查自己环境，看看是否有不支持的系统。   - VMware vSphere 5.1以及之前的版本 - Windows 2003和XP - Microsoft SQL Server 2005 使用Veeam Configuration Backup功能，将VBR的配置做一个备份，这个备份请确保是用Encrypted模式，这样所有在VBR中使用的用户名和密码将会妥善的被保存在.bco文件中。 检查VBR上面的所有备份作业，确保没有任何作业正在运行，这里要特别注意如下作业，需要手工点击Disable来停止：   - Backup Copy Job - SQL、Oracle的日志备份作业 ​	看看是否有Instant VM Recovery正在运行；
​	看看是否有Veeam Explorer正处于打开并在执行恢复；
​	看看是否有Surebackup/Virtual Lab正在运行。
最终，所有任务都停止后，会是如下图状态：
升级过程 整个升级过程非常简单，只需要按照向导点击几下鼠标，然后静静的等待30分钟以后，软件就能升级完成，因此在这里我就不详细去一步一步说明这个过程了。
可能碰到的问题  升级过程中，升级包会首先停止VBR的所有服务，有可能碰到停止服务超时或者失败，导致升级过程中断，建议碰到失败后首先检查下Services.msc中veeam开头的服务是否被正常停止。 服务都正常停止后，原地升级如果还报错，建议可以把VBR服务器重启一下后，再尝试升级，这里特别注意一下，在VBR重启后，需要重新检查所有VBR的作业，确保没有作业在自动运行。 如果尝试多次都无法进行正常升级，建议使用上面提到的方法二，全新安装一台VBR，然后将Configuration backup文件导入。 如果以上方法全部失败，请及时联系Veeam Support团队，我们的攻城狮将会及时为您提供升级支持。  以上就是升级的一些小提示，感谢阅读！</description>
    </item>
    
    <item>
      <title>Veeam黑科技之Direct NFS Access</title>
      <link>https://newblog.backupnext.cloud/post/2017-07-04-direct-nfs-access/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-07-04-direct-nfs-access/</guid>
      <description>最近这些天，碰到不少在VMware环境中使用NFS作为datastore的用户，发现NFS的场景是越来越多了。在以前，可能仅仅会是部分NetApp的用户去使用NFS作为VMware的datastore，而现在，随着各种超融合技术的兴起，市场上几个主流的超融合平台，比如Nutanix和Cisco HyperFlex在为VMware提供存储服务的时候都采用了NFS的方式去提供datastore。
这在以往来说，并不是一个好消息，当datastore是NFS协议的时候，虚拟机的备份可用的数据传输方式只能通过效率最差的Network方式，受限于备份仅仅能使用VMKernel的40%最大网络吞吐量，即使是有足够的带宽，实际传输时，吞吐量依然低下。
在Veeam Backup &amp;amp; Replication v9.0之后，使用Veeam去备份存放在NFS数据存储上的虚拟机的时候，有了一种全新的数据传输方式，Veeam把它称之为Direct NFS Access。很容易联想到VMware备份中的另外一种数据传输方式Direct SAN Access，在SAN备份中遵循VMware的数据提取方式，能不经过前端ESXi主机而是直接访问SAN存储读写数据。同样在NFS数据存储上，Veeam也能够提供类似的直接存储访问，而不经过前端ESXi主机。
这么强大的功能，如何使用？
Veeam的功能向来是强大却又极其简单。。这个Direct NFS Access的功能也是如此，以下我们来看看如何去进行这个功能的配置。
首先在VMware上面，我们有一台虚拟机存放在NFS的datastore中，如图：
在NFS服务器端，设置除了ESXi能访问这个卷之外，Veeam的Proxy也有读写的权限，本例中我在我的FreeNAS上做了一个访问设定，其中10.10.1.130是ESXi，而10.10.1.171则是Veeam Backup Proxy：
然后，在Veeam的控制台，我们指定一下使用备份首选的备份网络，为NFS的存储访问网络：
接下来，如果NFS数据存储是新添加的，在添加之后还未进行存储扫描，则可以做一个VMware基础架构的Rescan动作，确保识别到NFS数据存储。
好了，所有设定完成，直接去执行备份任务即可，在备份任务执行过程中，Veeam会自动感知到可以使用Direct NFS Access的方式进行数据读取，就会优先采用这种方式读取：
上图中我们看到读取方式标注为[nfs]，而常规其他的几种分别是[san]、[hotadd]、[nbd]，这是最大的区别。
而在备份日志文件中，同样能找到数据读取的相关记录：
好了，这就是简单的Direct NFS Access的配置方法，具体更详细的说明，可以点击阅读原文，参考Veeam官方手册查看详细内容。</description>
    </item>
    
    <item>
      <title>Veeam黑科技之Quick Migration</title>
      <link>https://newblog.backupnext.cloud/post/2017-04-21-veeam-quick-migration/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-04-21-veeam-quick-migration/</guid>
      <description>vSphere和Hyper-V都拥有自己的一些迁移技术，而Veeam作为一个数据保护软件，从数据保护的角度出发，为IT管理员提供了另外一种迁移技术。在Veeam软件中，该技术通常叫做Quick Migration。
熟悉Veeam的朋友，可能此时能立刻想到，在Veeam进行Instant VM Recovery的时候，有一个选项叫做Quick Migration，这是Instant VM Recovery执行过程中的一个可选步骤，当我们需要把数据从备份存储迁移至生产存储时，如果没有VMware Enterprise Plus许可时，无法使用高大上的Storage vMotion完成这个任务时，又或者在恢复时无vCenter可用，仅仅是只有单个ESXi节点提供服务时，这时候Quick Migration是一个非常好的选择。仅仅是付出比Storage vMotion略多些许的停机时间，获得的是更广泛的支持性，不失为一个绝佳的补充方案。
然后，Quick Migration的用法还远不止这些，我简单来举几个例子：
跨vCenter、Datacenter的VM迁移 这个话题通常会是一个复杂的手工操作，又或者是高大上的一些解决方案，而有了Veeam的加入，这一操作变得及其简单，Quick Migration即可完成，只要有合适的Proxy可用，那么Veeam就可以去做这样的迁移操作，并且这个迁移操作是不需要借助备份的，也就是说Veeam的这个迁移是可以直接进行，而不需要备份或者复制操作作为前提条件的。
这个操作非常简单，Veeam的界面上有这个按钮，只要按了按照向导即可完成。同样迁移过程中，Veeam一样支持Thin/Thick转换和磁盘重定向等基本操作。
LAN free迁移 什么？迁移虚拟机还能LAN free？对的你没看错，Veeam的Quick Migration可以通过合理的架设Proxy，实现LAN free。利用Direct SAN Access技术，无论是Fiber Channel还是Direct NFS技术都可以用于Quick Migration中，从而避免了VMKernel带宽不够用的问题，这个在大容量虚拟机的迁移上，能够帮助有效的控制数据流。
当然，以上这些我们也许可以通过其他的方法或者工具进行类似的实现，只是在此Veeam提供了一种更多的选择，让我们手上有更多的工具去完成日常虚拟化数据管理中所面临的挑战。</description>
    </item>
    
    <item>
      <title>Veeam黑科技之vPower NFS</title>
      <link>https://newblog.backupnext.cloud/post/2018-03-05-vpower-nfs/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2018-03-05-vpower-nfs/</guid>
      <description>什么是vPower？
这是Veeam的突破性科技，可以说是创造了一个时代，引领了当今虚拟化数据保护新的技术潮流。这项科技彻底颠覆了原有传统IT环境数据保护过程中恢复数据的流程，将漫长的恢复数据过程提升至分钟级，让超大容量的数据恢复变得不再那么可怕。
Veeam的vPower技术不仅仅支持VMware vSphere，同时能够支持Microsoft Hyper-V平台，并且两者实现的效果几乎完全一致。本文仅以VMware vSphere为例介绍vPower的原理。
这项科技的核心内容其实非常非常的简单，我认为这也是Veeam的科学家太聪明了，简单但是及其巧妙的运用虚拟化的手段直接让常规磁盘存储设备中存放的被压缩和重删后的数据能够模拟成前端Hypervisor程序可以识别的文件格式，然后运行起来。从技术上说，这是一个非常简单的架构，ESXi 主机直接访问vPower NFS Server，实现虚拟机恢复运行。
这里面有个非常核心的角色，那就是有一台Windows Server，上面启动vPower NFS服务，来充当一台NFS Server。那么相信熟悉VMware的各位一定能想到，VMware在使用Datastore时，除了常规的VMFS这样的Block Level的使用方式外，还可以使用NFS 作为Datastore。Veeam正是用这种方式让ESXi能够访问到备份文件并直接启动。ESXi在访问Veeam搭建的这台vPower NFS Server的时候，能够透过Veeam的专利技术协议vPower识别到在这个Datastore中模拟出来的VMDK，看上去这些VMDK和正常的VM所使用的完全一样，Veeam的这个模拟技术骗过了ESXi。而事实上，这个NFS Datastore上的VMDK却是Veeam通过数据块指向技术，将ESXi需要访问的数据块再次定向到压缩重删后的备份文件中。
通常的这类访问，是一个单向重定向技术，也就是说在备份存档中的数据块只负责提供被读取的权限，而当有交互数据需要写入时，Veeam的vPower技术又能很好的屏蔽这些写请求，使之写入至其他位置，确保备份存档的完整性和有效性。
哪里用的了vPower技术？
Instant VM Recovery – 直接恢复备份存档时，使用了vPower。
SureBackup – 《全自动验证备份存档》，此功能可以查看之前的推送了解详细原理。
U-AIR – 恢复任意的应用程序的对象。
On-demand Sandbox – 隔离的沙盒用于测试开发等等各种场景。
Instant File level recovery – 任何操作系统的文件级别恢复。
以上这5种Veeam技术中，都会使用到vPower NFS Service，也就是说，vPower NFS Service如果出现故障，那将直接影响以上这5个Veeam的重要功能，当然这个故障基本不可能发生。
限制条件？
目前只要是存放在磁盘上的VM存档都支持使用vPower NFS Service。而存放在磁带以及Cloud Repository中的VM存档因为离线和异地等性能问题，无法支持这个操作。
vPower写请求位置
对于不同的技术中使用vPower，其实这点上会有一些不一样。在Instant VM Recovery和SureBackup中，Veeam使用了两种不同的技术去处理虚拟机运行产生的变化数据块，以应对对于Instant VM Recovery和SureBackup的不同用途。
SureBackup中，vPower处理临时产生的数据变化量会存放于Virtual Lab所指定的Datastore的VMDK redo log中，因此通常的虚拟机VMDK都会被修改为non-persistent磁盘。
而对于Instant VM Recovery的特点是，虚拟机启动后，通常管理员会进行下一步的迁移回生产主机/存储的操作，因此无法使用SureBackup中这种non-persistent磁盘和redo log的存储机制，而是使用Veeam自己特有的vPower NFS缓存技术来存储新增的数据变化量，这个缓存技术的使用使得VMware层面上来看挂载起来的虚拟机时，是一个完整合规的可以使用vMotion技术的VM。
vPower技术配置要点
配置入口：在配置Repository的位置，每个Repository都会有它独立对应的vPower NFS Server。</description>
    </item>
    
    <item>
      <title>VMware VAIO技术概览</title>
      <link>https://newblog.backupnext.cloud/post/2021-02-19-vmware-vaio-overview/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2021-02-19-vmware-vaio-overview/</guid>
      <description>下周，Veeam即将发布旗舰产品VAS套件全新的v11版本，在这个版本中最重要的一个功能就是Veeam CDP。我相信不少朋友期待这个功能已经很久了，而事实上Veeam通过接近5年的精雕细琢，终于在v11中正式发布了这个功能。由于这个CDP功能在使用VMware相关技术时和以往的备份复制有很大的不同，今天我想带大家提前来做一些准备，介绍一些CDP背后使用的VMware相关技术和API接口，以帮助大家更好的理解这个CDP技术。
vSphere APIs for I/O filtering简介 Veeam CDP使用的是VMware vSphere APIs for I/O Filtering （VAIO）技术，这个技术早在vSphere 6.0U1的时候就发布了第一版，而到了vSphere 6.5开始这个技术逐渐成熟。简单来说，VAIO是一个框架，它可以为使用这个框架的一系列应用程序提供在虚拟机I/O路径中插入I/O过滤器（I/O Filters）的能力。而这些I/O过滤器则可以在I/O路径中来捕获虚拟机的I/O，从而实现在I/O写入物理磁盘前的各种处理。
VMware定义了I/O过滤器的4种使用场景，分别是：
 复制(Replication) 缓存(Caching) 存储I/O控制(Storage I/O control) 加密(Encryption)  其中存储I/O控制和加密这两种场景目前仅限于VMware自己使用，而复制和缓存这两种场景则开放给第三方厂商制作第三方的解决方案。和备份解决方案利用VADP接口一样，利用VAIO接口的第三方解决方案同样会通过严格的VMware Ready认证，认证之后可以在VMware官网上查询到第三方组件的兼容性列表。
vSphere APIs for I/O filtering技术原理 VAIO由两部分组成，一部分是VMware端的VAIO过滤器框架(VAIO Filter Framework)，这部分是VMware在每个ESXi中标准化提供的内容，从vSphere 6.0U1以后就已经内置在ESXi核心中了；另外一部分是I/O过滤器，这些过滤器都会在VAIO过滤器框架中逐个运行。如下图，一台虚拟机在运行时，它的I/O路径会从客户机操作系统(GuestOS)经过VAIO过滤器框架再进入VMDK之中，而在经过VAIO过滤器框架的时候，会逐个逐个被框架定义好的过滤器进行处理，当VAIO过滤器框架中所有的过滤器都完成处理后，这个I/O请求就会被移到最终的VMDK中。
很显然，通过上面这个过程，大家可以看到，VAIO工作的时候是针对某一台虚拟机的，VAIO框架为每台虚拟机定义了各自可以使用的过滤器，因此每台虚拟机在各自的I/O路径上如果发生任何的I/O错误，甚至是过滤器层面的错误，也被严格的隔离在这台虚拟机之内，并不会影响整台ESXi以及其他虚拟机。
另外，VAIO框架还做了一些限定，I/O过滤器根据使用场景对应定义了4个大类，在每台ESXi上每一类的I/O过滤器只能同时存在一个。比如，对于复制类的I/O过滤器，如果Veeam提供的CDP过滤器已经存在，那么其他厂商的过滤器就无法在这台ESXi上进行安装了。
vSphere APIs for I/O filtering管理技巧 通常来说，除了内置的I/O过滤器之外，第三方的I/O过滤器一般都会由第三方厂商提供集成安装服务，因此在vSphere Client中并无相关的安装按钮。然而，在vSphere Client中，管理员可以很方便的找到自己的Cluster和ESXi上的VAIO部署和使用情况，了解当前的状态。
在Cluster中查看 选中需要查看的Cluster，找到右边的Configure标签，然后可以在Configuration节点下找到I/O Filters来查看当前群集中Filters的安装状况，如下图。

在ESXi中查看 选中需要查看的ESXi，找到右边的Configure标签，然后可以在Storage节点下找到I/O Filters来查看当前ESXi上Filters的安装情况，如下图。

在ESXi上和在Cluster上看到的I/O过滤器情况略有不同，在ESXi上可以看到VMware自己使用的两种过滤器类型，其中spm是数据存储I/O控制用的过滤器，vmwarevmcrypt则是加密用的过滤器。
特别要注意的是，在图中显示的Type列中会列出各个过滤器的类型，每种类型有且只能有一个过滤器。
I/O过滤器存储策略 I/O过滤器的使用必须配合着vSphere中VM Storage Policy来进行，通常来说在I/O过滤器的使用过程中，第三方软件会全自动来配置相关的VM Storage Policy，而配置完成后，在vSphere Client的VM Storage Policy中能找到配置好的VM Storage Policy，比如Veeam CDP的过滤器，如下图：</description>
    </item>
    
    <item>
      <title>不知勒索病毒的攻击原理，怎知如何防御？</title>
      <link>https://newblog.backupnext.cloud/post/2019-06-10-ransomeware-attack/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2019-06-10-ransomeware-attack/</guid>
      <description>勒索病毒个话题，貌似近一两年是一如既往的火热，还记得一年多前刚刚爆发的时候的那些停止服务的图片吧，相信绝大多数没中招的同学都是以一份看热闹的心态去看这些图片。我也不能免俗，借了一些来晒在当时的推送中。热点蹭一下，算是也涨了点粉丝量。
原本以为，这一话题早应该结束了，随着安全补丁的修复和安全防护的加强，勒索病毒不会太长命。而事实上并非如此，勒索病毒也不断演进，看上去这一来一回的攻防战，打的越来越有意思。
勒索病毒基础小课堂
我相信，大家都已经非常清楚所谓的勒索病毒是一类什么样的病毒，它的攻击流程无非就是：
 加密一切被感染的文件； 通过各种方式联系文件的主人，要求支付赎金；  通常和碰到勒索病毒的同学的对话，就往往变成了如下：
倒霉的管理员：我丢，中招了，我的所有的资料全部被锁了，它们要我付10个比特币，怎么办？
石头哥：备份了没？
倒霉的管理员：没！
石头哥：嗯，去付钱吧，祝你好运！
没有备份的情况下，在这之后，会发生什么事情，我觉得真不好说，这两年的各种调查报告也很多，事实上真正能付了钱拿回数据的人，占总人数的1/4不到。
勒索病毒的进化
最近，看到一些评论，都在讨论现在的勒索病毒是越来越智能，以至于它们能够深入到用户的环境中自我复制、自我传播，同时它们还会去禁用一些主流的杀毒软件、备份软件、防火墙以及数据库，来确保达成勒索的目的。其中有些凶残的病毒甚至还带破坏和删除功能，对于主流已知的备份软件Catalog库进行深度分析，破坏发起后，为了达到勒索的目的，除了破坏生产数据，还同时去破坏备份数据。
这时候，碰到勒索病毒的同学的对话会这样：
倒霉的管理员：我丢，中招了，我的所有的资料全部被锁了，它们要我付20个比特币，怎么办？
石头哥：备份了没？
倒霉的管理员：备了，但是它们太聪明了，把我的备份服务器感染了，禁止了我感染那天以后的所有备份作业，同时删除了我的备份catalog文件。
石头哥：还有数据可以恢复吗？
倒霉的管理员：数据放在EMC DataDomain中，通过最新的文件锁协议（File Locking protocols），倒是挺安全，但是catalog没了，再安全的备份存档数据块都无法恢复了。
石头哥：好吧，去付钱解锁吧！
虽然用备份软件做了备份，但是水平还是没高过勒索软件，没有充分考虑到备份软件也会被勒索软件破坏，备份形同虚设。
下图是某勒索病毒的样本分析中找到的，它能禁用的一系列常见服务。它能做到破坏数据之前，先处理那些干扰他搞破坏的元素。可以看到市场上常见的杀毒软件和备份软件的服务都在这个清单上。
备份/灾备的应对策略建议
有了备份，也不安心，所以，在设计备份/灾备架构的时候，需要考虑很多因素：
 备份存档的独立性和可移动性。  越来越多的客户开始意识到这一点的重要性，如果现在的备份存档，还无法做到自我恢复，完全依赖于备份软件所建立的Catalog，那么破坏了Catalog就相当于破坏了一切。
相反，对于一个没有Catalog的使用Veeam备份的环境，这事情就简单太多了，每份存档就相当于一个个体，勒索病毒需要个个击破才能达到它勒索的目的，我相信，聪明的你肯定能把你最重要的数据存放中最安全的地方，而避免受到勒索病毒的感染。
那么这时候，假设很不幸，你的备份服务器被感染了，狠一点的勒索病毒直接破坏磁盘MBR记录，在启动的时候就拒绝你进入系统。这时候你需要做的事情很简单：
 清理恢复完你的环境，确保已经杀干净勒索病毒。 安装一套全新的VBR。 只需要从你最安全的磁带中，拿出之前备份下来的VBK文件。 导入到新的VBR中，veeam不需要任何集中管理的catalog数据库或者重删库，就能识别每个备份存档内容。 使用各种恢复方式，和正常的Veeam恢复方式完全一致，包括Instant VM Recovery和Instant File Recovery。  多份备份数据的安全隔离性。  存放数据的时候，千万记得别用同步功能，企业数据和个人数据一样。拿个人数据举例，如果你有个百度盘，或者Onedrive，这时候你要把你的数据备份到云上。偷懒的做法是后台开启自动同步，一旦数据写入你的磁盘，这些网盘工具会做一个自动同步，近乎实时的把数据同步到云端。而试想一下，这个数据写入磁盘的动作假如是由勒索病毒发起的，那么你的云端的所有数据也将会被你的这个自动同步操作的给感染。这样你设置的所有备份防御措施都将失效。
同理，在企业数据中心，偷懒的存储级同步方法，甚至是某些厂商宣称的字节级同步方法，在勒索病毒看来，这是多好的手段，让攻击范围自动蔓延，自动传播啊。
所以，我强烈建议，把自动挡改成半自动挡，拥有自动挡的技术没有问题，但是在必要的情况下，调整成定期数据的复制，会大大降低数据感染的风险。
数据多存放几份，多存几种介质都是很好的方法，来避免被全方位攻陷。对于勒索病毒来说，本身它是一种自动执行的计算机软件，全自动化的进行攻击，很少会有人工手工干预的攻击，因此改变正常的数据存放规则和套路是一个好方法。当然这个前提是，备份软件足够灵活，能够支持各种各样的存储设备。
备份存档的定期验证和自动化恢复演练。  这又是一个很有意思的话题，可恢复性验证，这备份和灾备环境中，要去做这个验证通常都只能手工去做，这会消耗大量时间和资源。在没有勒索病毒出现的时候，这个验证仅仅是为了对付下领导，对付下监管，这也许交一份书面报告也就过去了。然后勒索病毒横行的今天，我们真的得好好想一想，要是哪天勒索病毒把我的环境破坏了，那我的哪些备份存档是没有勒索病毒感染的，能够正常恢复的干净系统？
全自动的备份存档验证在这样的场景下，能够帮助备份管理员省下不少时间和资源。而加入了更多自动化校验逻辑的Veeam Availability Orchestrator 2.0则是这方面的小能手。
来吧，和勒索病毒斗智斗勇吧。
没有任何一个软件可以做到没有漏洞，没有任何一个软件可以做到完全免疫任何攻击。我认为只有更好更合理的去存放数据，并且持续的去检查数据，才能够在这场勒索病毒持久战中坚持到最后。</description>
    </item>
    
    <item>
      <title>使用vSphere PowerCLI快速完成Veeam备份管理员角色创建</title>
      <link>https://newblog.backupnext.cloud/post/2020-06-05-powercli-vsphere-permission/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-06-05-powercli-vsphere-permission/</guid>
      <description>为Veeam定制一个最小化的vSphere权限账号对于系统管理安全来说非常有必要，但是随着软件的升级功能的增强，对于vSphere上需要用到的权限也越来越多，Veeam在官方的UserGuide中提到了详细的细颗粒度权限要求，此时如果手工去逐个比对、选择，其实还是挺费时挺麻烦的一件事情。
最近我看到一个非常不错的PowerCLI脚本，使用这个脚本能够快速方便的创建这个Veeam专用角色，今天来和大家分享一下。
这个脚本的前提条件，是安装vSphere PowerCLI，脚本是通过VMware自动化的vSphere PowerCLI管理工具来实现的。安装方法在VMware官网的Blog中有详细说明，我这里给个简化版的步骤：
  首先下载安装PowerShell Core 7，这是PowerCLI运行的必要条件。PowerShell Core比Windows PowerShell更强大，不熟悉的朋友也可以通过下载链接进去了解详细。安装过程非常简单，如果是Windows下，.MSI安装包双击后跟着向导就能装完。
  打开PowerShell 7快捷方式后，运行以下命令来安装vSphere PowerCLI。
  Install-Module -Name VMware.PowerCLI -Scope CurrentUser 安装完成后输入以下命令，能够看到如下结果：
Get-Module -Name VMware.* -ListAvailable 3. 运行这个PS脚本，运行过程中会提示输入vCenter的IP地址、用户名密码以及希望创建的角色名称，根据实际情况输入即可。运行结果如下图：
回到vSphere Client，找到Administration下的Access Control，在Roles下面，能够找到刚刚用脚本创建出来的VBR Backup Admin的角色。接下去就可以去创建Veeam专用用户了。  在Administration的最底部，找到Single Sign On下面的Users and Groups，在Users下面，把Domain切换成vSphere登录的Domain，然后Add User添加新用户。 添加完用户后，回到vCenter节点，授权这个新用户访问指定的vCenter，并给予VBR Backup Admin的权限，如下图：  以上就是快速简单的添加备份角色的方法，安全又可靠，脚本链接如下： https://github.com/falkobanaszak/vCenter-role-for-Veeam/blob/master/New_vCenterRole_Veeam.ps1</description>
    </item>
    
    <item>
      <title>保存美好回忆，就在此时此刻！</title>
      <link>https://newblog.backupnext.cloud/post/2021-03-31-world-backup-day/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2021-03-31-world-backup-day/</guid>
      <description>今天的内容非常简单，没太多技术含量，纯粹水一把。提醒大家做个备份，不管是个人的还是公司的，对于今天来说，一年一度的这个日子，做一个备份显得尤为重要。今天是世界备份日（World Backup Day）。
先来说说这个日子 也许有人还不太清楚这个日子咋回事。这个日子的由来也是网络发起的，有个叫Ismail Jadun的人，在Reddit上看了个某人数据丢失很后悔的帖子有感而发，顺手在Reddit上发帖，他觉得3/31不错，愚人节（4/1）的前一天，提前一天做好备份，不做愚人节那天的傻子。他的这个倡议在2011年得到了互联网上用户的广泛响应，在2011年3月31日那天很多人在互联网上宣誓承诺会备份他们的重要文件和美好回忆，并且还会将这个消息告诉周围的朋友和家人，希望每个人都有一份数据的备份。
这一日子，3月31日，就这么被定下来，在每一年的这一天，互联网上大家都会来互相提醒，一年下来，如果还没备份的，那么趁着这个日子，赶紧把自己的数据做一份备份，哪怕是最简单的一个拷贝也好。
再来说说备份 有些什么内容我们需要备份？
其实这个没有固定的要求，只要您觉得您的数据重要，不管是什么内容，那都值得备份，无论是一段文字、一张照片、一段音频还是一段视频。这些数据可能存在于您的手机、Pad、笔记本电脑甚至是SD卡中，别忘了，在今天，就是今天，赶紧做一份备份。
做备份可以非常简单，记住一个原则，3-2-1数据保护黄金法则。最基本的方法就是，将您的数据往其他地方拷一份，拷U盘、拷移动硬盘和拷到家用NAS上都是很不错的方法，重视数据安全的同学可能会放好多份，这就是很好的践行了数据保护黄金法则。很朴实的方法，但是很有效！
然而，当我们的设备越来越多的时候，特别是像博主这样的IT直男，在家中信息技术领域绝对是CIO的地位，管理着家中各个成员的各种设备和数据，这时候全家老小的数据备份绝不是一件简单的拷贝活。因此，在这里我向您隆重推荐Veeam Backup社区版软件，可以完成30台笔记本设备或5TB数据的备份，有了这套软件，家里大大小小的笔记本电脑，不管是Windows还是MAC系统都能使用它将数据集中备份下来，这个就会远比拷贝到移动硬盘方便的多了。
它的使用方法也很简单，开一台Workstation的虚拟机或者找个方便好用、访问便捷的公有云，开一台Windows2019服务器，将Veeam Backup社区版软件装上，装完以后使用V11中的新特性“Catch All 模式的Veeam Agent”，可以获得一份客户端的安装包和配置文件，拿着这些安装包去各个笔记本上安装和配置吧，配置完成后就可以使用它进行备份了。
当然，如果觉得家中数据没有那么多，不需要安装庞大Veeam Backup社区版软件，也可以使用Veeam Agent免费版来保护Windows服务器，这依然能够从Veeam官网下载获取到。
好了，以上就是今天的内容，如果还没备份的，赶紧趁今天，把数据备一份，明天不会后悔！</description>
    </item>
    
    <item>
      <title>免费好工具，绝不套路</title>
      <link>https://newblog.backupnext.cloud/post/2021-03-09-gift-from-veeam-free-community-edition/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2021-03-09-gift-from-veeam-free-community-edition/</guid>
      <description>IT管理员的绝佳搭档，完全免费！
今天来给大家介绍Veeam Software的免费好工具，推荐给每一位IT管理员，Veeam作为备份解决方案领域的领军者，除了有强大的旗舰产品Veeam Availability Suite之外，还为每一位IT管理员配备了全套的免费工具。这些工具完全没有任何广告、没有任何限制、可以随意使用，但是这又和开源软件有所不同，Veeam称它们为社区版软件。
Veeam的这些社区版软件和Veeam商业版全功能软件略有不同，部分高级产品功能上做了限制，并且许可使用数量上做了一些限制，关于详细的限制请查看官网，链接如下：
https://www.veeam.com/cn/products-edition-comparison.html
然而，就算有这些限制，也无法阻挡无数管理员喜欢上这套强大的社区版软件。下面我就来和大家说说这套社区版软件Veeam Backup &amp;amp;Replication Community Edition在管理员日常运维中可以做的一些事情，使用这些功能，完全不需要消耗任何的Veeam许可，包括内置的10个免费礼品许可，但是却能为我们的运维管理带来极大的便利。
功能一：VeeamZIP，来自Veeam的免费压缩软件。 这是Veeam产品的经典功能之一，在Veeam第一代产品出来后就一直深藏在Veeam产品中，作为产品的一个标配功能。从这个名字上我们就能猜出一二，它其实简单来说就是能够把一个VMware或者Hyper-V的虚拟机打包成一个压缩文件，变成一个ZIP包，这和我们平时打包压缩某些文件的做法完全一样，而恢复的时候，一样可以从这个压缩存档中解压出我们需要的原始数据。  然后，实际上VeeamZIP并不止这么简单，强大的功能也并未止步于ZIP包。VeeamZIP使用了标准的Veeam备份引擎，只是它并不是普通的备份计划任务，它是一个完整的虚拟机全备份，你的每一次VeeamZIP操作都会触发备份引擎去对虚拟机执行一次全备份，并得到一份vbk全备份存档。
而在恢复时，这个VeeamZIP在Veeam中一样是一等公民，全套的恢复功能都可以使用，包括：
 即时恢复，包括v11的跨平台恢复至VMware或Hyper-V 即时磁盘恢复 整机还原 虚拟机磁盘还原 虚拟机文件还原 客户机细颗粒度文件对象还原 还原至Amazon EC2 还原至Microsoft Azure  更重要的是，VeeamZIP是真正免费的功能，不消耗社区版中任何的内置10个实例的许可，您的环境无论是有100台ESXi主机、1000台VM还是1PB的数据容量，您一样可以用社区版的VeeamZIP来为这些虚拟机创建压缩存档，没有任何限制。
功能二：存储快照的最佳搭档 存储快照集成是Veeam的高级功能，通常它会出现在Veeam的企业增强版中，而且因为配置略微复杂，不仅要了解虚拟化还要了解存储基础架构，因此很多刚入门的管理员通常不太会用到这个功能。
然而，假如您的存储是NetApp、Dell EMC SC或Unity、HPE 3PAR或Nimble、联想V系列或DM系列、以及华为的OceanStore系列存储，您完全可以免费无限制的使用社区版中的存储快照恢复功能。这一功能，将会极大的扩展这些存储在虚拟化环境中的能力，借助Veeam的存储快照解析和恢复能力，任何这些存储上执行的卷快照都可以用于Veeam的全功能恢复技术，包括：
 从卷快照中执行单台即时虚拟机恢复； 从卷快照中执行单个虚拟磁盘即时恢复； 从卷快照中恢复客户机操作系统的细颗粒度文件； 从卷快照中恢复应用程序对象，包括SQL、Oracle、Exchange、AD等。  
这一恢复能力，一样是因为没有备份任务，不需要Veeam执行备份作业，对于广大的快照用户来说是完全免费，无论您的环境有100台ESXi主机、10台企业级存储、1000个虚拟机，还是1PB数据使用这个功能恢复存储快照中的数据，完全免费。可以说是为这些存储额外提供了强大的增值功能。
所以，别在说存储快照不好用了，还没用存储快照的，可以赶快动手试试看吧！
功能三：免费磁带机/库管理工具 买个磁带机，通常来说必须配个昂贵的备份软件才能配套使用，很多备份软件对于磁带的使用还按驱动器进行收费，加一个驱动器动不动就是大几十万的授权许可费用。 
在Veeam社区版中，磁带机/库的管理和使用完全免费。管理员可以使用File to Tape功能，将数据写入磁带中。重点是，和上两个能力一样，无论您的环境有1台磁带机、10台磁带机、10000盘磁带、1千万个文件还是1PB的数据，使用Veeam的磁带机/库管理，授权完全免费，无限量使用。
所以，下次买了磁带机之后，别傻乎乎的再去为了一个文件写磁带功能买昂贵的配套软件啦，一个Veeam社区版软件就足够了。
功能四：Veeam初代旗舰FastSCP 这个功能可能对于绝大多数人都非常陌生，甚至是接触了多年Veeam的老鸟都可能完全不知道它的存在。然而如果您是Veeam的死忠粉，从2008年就开始关注Veeam，也许就不会陌生。是的它就是Veeam公司初创时候的第一款产品，Veeam FastSCP。
https://www.veeam.com/vmware-esxi-fastscp.html
这款产品曾经有单独的软件包，而现在，它藏身于VBR社区版的Files视图下。在Files视图中，上面的所有操作都是标准的Veeam FastSCP内容，在这里受管理的任意一台Server节点都可以利用FastSCP的能力轻松的完成数据的传递。Veeam能够在这些受Veeam管理的节点中的数据通过Veeam的数据传输服务轻松的传递到数据的目的地。

更强大的功能是，对于VMware的虚拟机文本配置文件，比如VMX、VMDK描述文件等，FastSCP还提供了在线编辑功能，管理员再也不需要打开ESXi Shell进入控制台去修改这些数据了。
这个功能，对于所管理的节点，也没有任何的数量限制，管理员可以自由的使用FastSCP来传输数据。
功能五：VMware vMotion的替代方案Quick Migration 作为VMware管理员，往往会有很尴尬的时候，VMware vMotion总有某一场景下，不合适使用的时候，这时候在没有合适的工具时，是迁好呢还是不迁好呢？
不用担心，免费的Veeam社区版来帮忙，vMotion搞不定的，Quick Migration来搞。付出一点点代价，获得最终迁移完成的结果，然而又是不需要任何产品许可，可以免费无限量使用的解决方案。</description>
    </item>
    
    <item>
      <title>关于“想哭”病毒，我也来两句。</title>
      <link>https://newblog.backupnext.cloud/post/2017-05-15-wannacry/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-05-15-wannacry/</guid>
      <description>从5.12晚爆发开始，一直到今天下午，一直有接到朋友各种求助、紧急取消活动、启动应急预案和恢复数据的电话。这波“想哭”确实如其名，让那些没有准备或者准备不足的朋友们好想好想哭，有没有？
好了，不管如何，付了钱也好，没付钱恢复了数据也好，在静下来把事情都结束了以后，我们可以好好想想应该如何在以后更好的防范此类事件，做到全方位无漏洞。
让我们先回到病毒爆发前
备份！备份！认真做好备份！重要的事情说三遍，备份在这个环节中是多么的重要，在大规模病毒爆发后，如果拥有了中毒之前的备份数据，我相信，这个勒索病毒可以被轻而易举的化解。那么这个备份该如何做好呢？
 备份数据别和生产数据放一块儿，这是做备份的大忌，放一块儿就相当于把所有钱都放1个钱包，掉了一起掉，这个是最容易忽略的常识，但是在备份的时候也是最容易犯的。这里的放一块儿指的不仅仅是一套系统上一套存储上，备份的数据尽量实现和生产环境没有直接关系才是最合理的。 多准备几份备份数据是不会错的，当你有3份以上不同的数据的时候，我相信应对这样的场面，你肯定很有信心。 平时如果做过演练，每个恢复点都是验证过一切正常能恢复的话，那么这时候碰到这种情况就是信心百倍了。  来看看病毒爆发时
快速恢复，越快越好！这时候最直接的方式，即时虚拟机恢复，这是有多快恢复多快。2分钟之内回滚到历史保存点，业务恢复上线。这时候也不用在外面贴告示了。
那么仔细再想一下，本次大规模中毒其实一部分系统层面的工作，可以通过杀毒打补丁进行修复，而解密工作，暂时没有太好的办法，只能通过备份软件进行恢复，而文件有重要和不重要之分，那么在选择恢复时，我们其实可以用到更多更灵活的方式恢复想要的内容。
 即时虚拟机恢复，这是简单粗暴的快速恢复方法。 即时文件级恢复，很巧妙的选择性恢复，这时候根据被感染的文件重要级别，选择想要恢复的文件先对应关键业务，是个很不错的选择。  爆发后，系统维护
紧急业务处理完了，回头要看看那些没中毒的系统，防患于未然，补丁也都出来了，这时候要给这些系统打补丁了，发现打个补丁系统蓝屏了，有没有？上千台Windows，上千次的打补丁重启，失败率5%以上有没有？是不是又没准备，然后这些没被“想哭”玩死的系统，反而被微软补丁玩死了？
打补丁前，不管啥时候，记得这么来：
 先做一次备份，确保能够回滚到正常状态。 可以在沙盒中测试下补丁是不是能够正常打上，并且不会影响系统正常工作。同时，还可以在沙盒中测试补丁应用情况，是否还会受病毒攻击。  好了，以上就是本次“想哭”的一些Tips。</description>
    </item>
    
    <item>
      <title>利用Veeam U-Air恢复MySQL数据库</title>
      <link>https://newblog.backupnext.cloud/post/2018-04-10-uair/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2018-04-10-uair/</guid>
      <description>常常被问及Veeam是否支持某某数据库/应用程序的对象恢复，其实这个问题的答案和问题中提到的 某某数据库/应用程序 完全没有关系，这类问题的答案永远是肯定的。因为Veeam有一个超强的恢复工具：U-AIR（Universal Application-Item Recovery）
今天我就以MySQL为例，给大家详解一下这个恢复工具。
先来看看今天的备份存档，这是一个安装在CentOS上的MySQL 5.1.7，我使用Veeam Backup &amp;amp; Replication对其进行备份，备份过程中执行了Pre-freezing和Post-freezing脚本确保其数据一致性，关于此脚本，大家可以参考Veeam官网的白皮书，因为Veeam白皮书实在太详尽，我就不在此处担当复读机啦。
具体链接如下：
https://www.veeam.com/wp-consistent-protection-mysql-mariadb.html
对于源虚拟机上，我的MySQL中有以下这些测试数据：
然后这个状态的这台MySQL虚拟机我做了一次备份，这时候因为一些意外原因，我的veeamlab这个database被破坏了，我需要通过备份，将这个veeamlab database还原出来。此时，坏了的veeamlab将会被我弃用，而我会新建一个空的veeamlab_recovered作为新的目标还原库，而这时MySQL则是一切正常状态。
接下去，我的还原过程开始了，启动Universal Lab Request Wizard来申请一个之前的备份存档，用于还原，申请过程非常简单。
给出需要申请的VM Name，这里完全支持模糊名称。
还原点我选择最新一份。
完成之后提交申请。
至此，U-AIR恢复申请提交完成，须等待备份管理员审核还原申请。
我接下去通过Veeam Enterprise Manager来到备份管理员视图，进行此次还原申请的审核。
Approve过程也非常简单，在这里完全用到Veeam SureBackup/Virtual Lab的功能，具体SureBackup/Virtual Lab的配置可参考之前的推文 。《备份存档能不能被恢复，这件事情上只有真正做过才知道。》
这个审批过程，Veeam会自动找到合适的虚拟机备份存档：
会选择合适Virtual Lab和SureBackup Job作为还原的临时环境：
如此，审批过程就结束了，接下去，在数据库管理员这端，等待一小段时间后，将会获得临时还原环境的访问信息。
通过172.20.1.139，我ssh到这台还原环境中，而此时我原来的10.10.1.139还是处于正常运行状态。检查临时的还原环境中的数据库情况如下：
数据一切正常，接下去，我需要做一件事情，就是将这里的数据提取出来，然后传输至原来的10.10.1.139中，进行还原。我使用mysqldump命令来提取数据。
提取完后，数据存放至/tmp/mysql/veeamlab.sql文件中。
然后我们回到原机器10.10.1.139中，使用Virtual Lab中Static IP Mapping技术，我设定了能够让所有机器通过10.10.1.138这个地址访问到虚拟实验室中的临时还原环境，这时候，我可以从10.10.1.138中抽取这个dump进行还原。
还原命令依旧非常简单：
至此，所有数据还原工作完成，我们看到我们希望还原的数据已经全部找回。数据库管理员可以提前终止UAIR环境，也可以让它在使用时间到期后自动回收。
好了，今天恢复MySQL的样例就是这些，这个恢复没有太多前提条件，唯一的条件就是使用Veeam Backup &amp;amp; Replication，有了Veeam您就能和我一样进行如此轻松的进行任何数据库/应用程序对象的恢复了。</description>
    </item>
    
    <item>
      <title>加速！加速！加速！（一）</title>
      <link>https://newblog.backupnext.cloud/post/2017-08-01-speed-up-01/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-08-01-speed-up-01/</guid>
      <description>一直很少去谈论速度和性能，就像一辆好车，我认为这个是基本配置，然而这个基本配置对于任何一辆车来说都是极其重要的。对于备份领域来说，驱动备份和还原速度的引擎就像汽车的发动机，是一个备份软件真正展现其价值的重要部分。我想就这个问题，来详细讨论Veeam的加速技术。今天的内容是加速系列的第一部分 – 备份加速引擎。这一引擎在备份软件中不仅仅是帮助了实现备份功能，更是Veeam去帮助客户实现IT可用性的重要保障
Veeam备份加速引擎
和其他使用VMware vStorage API for Data Protection（VADP）的备份软件不一样，除了软件传输服务中集成了VMware Virtual Disk DevelopmentKit（VDDK）之外，Veeam额外加入了一套优化数据提取的组件：Veeam Advanced Data Fetcher（ADF）。这个ADF简单来说就是为企业级存储阵列额外增加了超过2倍读取性能的列队深度，这个带来的直接的效果就是极大地加快了从vSphere平台数据源读取数据的速度。相比同类的备份产品，在从源端读取时，效率上有成倍的提升，并且ADF还降低了读取数据需要的I/O操作数量，从而有效的降低了读取相同容量的数据时对于生产存储的I/O压力.
当然，Veeam还为这个ADF配备了一个智能的调控开关Backup I/O Control。当从生产读取速度并不快时，其实备份软件完全不需要考虑会不会对生产造成影响，可以说是完全可以忽略生产环境。当我们的速度足够快时，必须考虑到生产存储的负载能力，在生产对外服务的同时还要同时高效的完成备份，这就不是拍脑袋想多少是多少了。
Veeam ADF和Backup I/OControl的协作可以完全智能地去完成对生产存储的控制，通过自动感知生产存储Latency技术，动态控制ADF的吞吐量来实现在有效的Latency范围内进行备份。
在以往，一个备份管理员，通常会设定每天执行一次备份的数据保护策略，并且将这个备份时间段设定在晚上业务相对不繁忙的时间。这样的设定RPO就是24小时，究其原因并不是说管理员保守，而是因为没有很好的智能控制手段，所以备份要为生产让路，保证可用性的前提下去进行备份。然而现在Veeam的引擎，Veeam ADF和BackupI/O Control的协作，可以让备份管理员在不影响生产的情况下，在任何时间段完成备份，从而有效的提升备份的RPO。
所以，Veeam不仅仅是完成了备份这么一件大家能用各种方式实现的事情，可能殊途同归，但是Veeam的技术是让在完成备份的同时达成可用性目标，关键业务的备份可以在任何时间进行，而不是备份必须在维护停机窗口进行。24×7×365的可用性保证从做备份做起！
下期预告：
vSphere通讯加速技术 - 虚拟化备份前，备份软件需要花大量时间与虚拟化平台通讯，这是整个备份作业中第二大耗时作业，全新的Veeam Broker Service能够帮助极大提升这个速度，节省时间。</description>
    </item>
    
    <item>
      <title>加速！加速！加速！（二）</title>
      <link>https://newblog.backupnext.cloud/post/2017-08-07-speed-up-02/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-08-07-speed-up-02/</guid>
      <description>上一期，我们讨论了备份引擎的加速，这对尽可能快的完成备份提升RPO有着极其重要的意义。然而除了这个数据传输引擎之外，在备份时还有一个加速器，那就是vSphere通讯加速技术。
Broker Service
这是Veeam9.5中新增加的一个特性，简单来说这项科技给备份带来的帮助是在Veeam和VMware vCenter之间加入了一个过渡服务，当Veeam每次发起任务时，需要查询vSphere信息时，可以替代性的去查询BrokerService而不用直接去找vSphere。
如下图，这是有无BrokerService的一个直观对比，没有Broker时，每次备份任务都会去直接和vCenter通讯，其获取返回结果的耗时完全取决于vCenter性能和网络状况。而在有了Broker之后，Veeam则会去查询Broker中缓存的信息，而由Broker保持和vCenter处于update状态。
那么这个Broker事实上在Veeam软件中是以一个服务的形式存在，因此我们在Services.msc中可以查看到这个Service:
这个Broker在工作的时候，VMwarevCenter中清单基础架构的任何变化都会实时的被推送至Broker的缓存中，而如果Veeam未收到任何推送变化的情况下，默认Veeam会每15分钟（900秒）进行一次强制更新缓存，确保缓存内容的准确性。
所以，这带来的好处显而易见，以下是一组软件中截图的对比，在无Broker的情况下，Veeam备份任务通过查询vCenter来创建备份虚拟机列表，消耗了40秒时间：
而在有了Broker之后，Veeam备份任务查询Broker来创建备份虚拟机列表，仅需要耗时1秒：
这可以说效率提升了40倍以上！！
好吧，为了让你的备份速度飞起来，升级到Veeam 9.5Update2吧。
下期预告：
备份速度快不算啥，这都不是啥大事，划重点的来了，真正要快的还原技术，而Veeam除了有Instant VM Recovery之外，其他的那些还原技术会不会也很快？下期为你揭晓答案。</description>
    </item>
    
    <item>
      <title>备份基础架构高清版GIF，同步公众号持续更新</title>
      <link>https://newblog.backupnext.cloud/post/2020-09-07-backup-infra-gifs/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-09-07-backup-infra-gifs/</guid>
      <description>Week 01
2020/09/07 - 添加vCenter
2020/09/08 - 添加VMware Windows Proxy
2020/09/09 - 添加VMware Linux Proxy
2020/09/10 - 添加文件备份代理File Proxy
2020/09/11 - 添加Windows服务器直连的磁盘为备份存储库
Week 02
2020/09/14 - 添加Linux服务器管理的XFS文件系统为备份存储库
2020/09/15 - 添加SMB共享为备份存储库
2020/09/16 - 添加NFS共享为备份存储库
2020/09/17 - 添加HPE StoreOnce
2020/09/18 - 添加AWS S3对象存储库
Week 03
2020/09/21 - 添加S3兼容模式的对象存储
2020/09/22 - 添加含Capacity Tier的横向扩展存储库SOBR。
2020/09/23 - 添加广域网加速器
2020/09/24 - 推送安装物理服务器的备份代理
2020/09/25 - 添加SMB文件共享备份文件数据
2020/09/27 - 添加NFS文件共享备份文件数据
2020/09/28 - 添加文件服务器备份文件数据
2020/10/09 - 添加磁带服务器</description>
    </item>
    
    <item>
      <title>备份存档能不能被恢复，这件事情上只有真正做过才知道。</title>
      <link>https://newblog.backupnext.cloud/post/2018-03-05-surebackup/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2018-03-05-surebackup/</guid>
      <description>Veeam有一个非常特别的功能，它能够全自动的在线验证备份存档的可用性，确保备份下来的内容是能够被正常恢复的。
该功能之所以能够确保恢复，是因为它会将备份存档在一个隔离的环境中以一个正常的虚拟机的形态启动起来，然后通过一系列的仿真测试去全自动的测试这个虚拟机的状态，包括了虚拟机的心跳、虚拟机网络的连通性甚至是虚拟机内应用程序和服务的运行状况，在测试完成之后，它还会生成一份验证报告，给出该备份存档可恢复性的相关结论。
Veeam SureBackup适用于VMware和Hyper-V的备份，本文仅以VMware环境为例说明SureBackup的技术原理以及使用方法。
如何工作？ Veeam SureBackup在工作时，会依次执行以下步骤完成整个验证过程：
  Veeam Backup &amp;amp; Replication会将Application Group和被验证的虚拟机发布到一个隔离的沙盒环境中，通常我们称作为“数据实验室（DataLab.）”。这些虚拟机是直接从备份存储库的被压缩重删后的备份文件中启动，而不需要被预先还原至VMware的Datastore中。实现这一功能需要依赖Veeam的Instant VM Recovery和vPower NFS Service。 Veeam Backup &amp;amp; Replication对Application Group和被验证的虚拟机执行一系列的自动化校验测试，通常包含虚拟机心跳、网络ping和应用程序脚本测试，其中应用程序脚本可以通过自定义的方式加入。 在基础验证完成后，还可以选择让Veeam SureBackup对备份存档从文件层面执行一次CRC校验，确保在执行任务的过程中未修改原始备份存档。 在SureBackup任务结束后，Veeam Backup &amp;amp; Replication对这些虚拟机执行“Unpublish“动作，并且生成一份测试报告，此报告会通过Email的方式发送给指定的管理员。   在整个验证过程中，Veeam会保证所有虚拟机的备份存档处于只读状态，所有因虚拟机运行产生的数据会存放在虚拟机Redo Log中，这些Redo Log通常会存放于VMware的生成存储上，而当验证过程结束时，Veeam会删除这些Redo Log，释放临时空间。
验证过程中的组件 和通常备份的基础架构不一样的是，执行Veeam SureBackup时，会需要用到几个SureBackup专用的对象。
 Application Group - 在验证某些虚拟机时，这些虚拟机需要依赖一些其他的虚拟机才能正常启动和工作，Application Group就是为这些虚拟机正常工作提供所需的其他依赖应用程序和服务。通常我们会将运行这些应用程序和服务的虚拟机放入应用组，为验证提供依赖条件。举例来说，当我们需要去验证一台Exchange服务器时，该Exchange服务的启动需要有AD和DNS服务，因此，我们可以在Application Group中加入提供AD和DNS服务的虚拟机，用来为Exchange提供启动依赖。 Virtual Lab - 这是一个隔离的虚拟化沙盒环境，Application Group中的虚拟机和被验证的虚拟机都会在这个沙盒中启动起来。 SureBackup Job - 这是来自动或者手动执行验证备份存档的任务。它能够定时定期执行，也能够手动执行。  SureBackup 实战 如上面提到的，SureBackup有3个专用对象，因此在使用和配置SureBackup过程中显然需要进行这3个对象的设置。
Application Group 这也是整个生产环境基础架构中最最重要的服务之一，其他应用程序的启动和运行都依赖这些机器。简单来说，Application Group就是定义一组虚拟机，这组虚拟机非常重要，其他被验证的虚拟机没有这组虚拟机无法工作。也就是当我们的环境中存在这样的虚拟机，那我们就需要将他定义为Application Group，以便其他机器在被校验时能够访问到这些虚拟机和服务。
当然，Application Group中的这些虚拟机也是从备份镜像中启动起来，需要预先被备份，而不是直接使用生产环境的虚拟机。SureBackup对于Application Group中的虚拟机，也会定义一系列的校验和检测，确保Application Group中的虚拟机首先正常工作，然后才开始后续的其他虚拟机验证。当Application Group中的虚拟机验证失败的情况下，SureBackup将会中止工作，不会继续后续的虚拟机验证，这是因为SureBackup默认Application Group无法正常工作的情况下其他被验证的虚拟机也无法正常启动。因此，请不要在Application Group中放置非必要的虚拟机；如果被验证的虚拟机无需其他应用程序和服务依赖，则请不要在Application Group中放置虚拟机。</description>
    </item>
    
    <item>
      <title>好消息好消息，Veeam又通过一项VMware Ready认证！</title>
      <link>https://newblog.backupnext.cloud/post/2017-06-30-another-vmware-ready/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-06-30-another-vmware-ready/</guid>
      <description>上周，前方又传来一个激动人心的消息，Veeam通过了vSphere 6.5刚刚开放的VMware Web Client Plug-in Ready认证。厉害了，这个太厉害了。具体VMware官网查询链接https://www.vmware.com/resources/compatibility/search.php?deviceCategory=wcp
什么？什么？你还不知道啥是VMware Ready？好吧，我先来普及下这个认证。简单来说使用通过认证的plug-in有这么几个好处：
 符合VMware Web Plug-in的最佳实践，会被收录至各种白皮书、教科书。 用户体验极佳，可以说是几乎和VMware原厂软件完全一致。 插件经过VMware原厂严格测试，使用该插件，完全不会影响vCenter的性能，不用担心非原厂插件破坏vCenter。 插件故障，VMware给保修，这个很重要。一站式解决问题。  那么，这么好的插件，它能做点啥呢，我们来看下这个功能强大的小插件。
这个插件部署完成之后，会在vSphere Web Client 上出现一个新的图标，和其他的Web Client插件一样，点击即可进入。
在这个插件中，我们能够查看到当前的备份基础架构情况：
能够看到最近24小时、7天、14天的虚拟机备份情况：
能够看到备份任务的执行和计划情况：
还能够看到最近7天、14天、1个月处理的虚拟机数量：
能够查看备份存储库的容量，再也不担心日常运维的时候忘记存储快满了：
并且以上这些内容，如果有部署Veeam ONE，能够直接点击跳转查看完整的相关报告。如此这样，基础架构运维，是不是突然发现，简单了好多？
除此之外，该插件还提供了快速备份的功能，在每个VM的右键菜单中，我们可以找到Backup选项：
VeeamZIP，立即执行Active Full类型的全备份，是一种快速备份的简单方法。
VeeamZIP to &amp;hellip;则会跳转至ZIP设置界面，该界面也集成在vSphere Web Client中，而不用进入Veeam Console。
Quick Backup则是进行快速的增量或反向增量备份，用于单次的即时备份。
最后来看下VeeamZIP设置界面，该界面位于每台VM的Manage选项卡下的最后一项VeeamZIP中，如图：
这里可以简单设置备份服务器、备份存储库、Key、VeeamZIP删除时间、压缩级别、是否进行客户端静默等选项，几乎与Veeam Console中的VeeamZIP设置选项一致。同时这里也提供VeeamZIP任务触发按钮。当执行VeeamZIP任务或者Quick Backup任务时，vSphere Web Client的任务栏还会出现Veeam的任务进度：
好了，以上就是全部Veeam vSphere Web Client Plugin的功能，简单小巧，又非常好用，还带保修。。</description>
    </item>
    
    <item>
      <title>微信搜一搜，10秒学Veeam</title>
      <link>https://newblog.backupnext.cloud/post/2020-09-07-new-subscription-daily-gif/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-09-07-new-subscription-daily-gif/</guid>
      <description>Veeam的软件是一个极致简单的产品，简单易用贯穿了整个产品的设计，但是随着功能越来越多，也许刚刚接触Veeam的朋友们会不知道从哪里入手。
因此，我新开了一个每日一图的专用公众号，在这个公众号中，每个工作日都会推送一个简单的GIF动画，计划通过一个10多秒的动画来教您使用Veeam产品。
新公众号如下，欢迎关注。
由于微信公众号的额外压缩，在每日推送的动画中，可能清晰度欠佳，如果希望观看并收藏清晰版的朋友，可以访问我的博客。</description>
    </item>
    
    <item>
      <title>恢复 | 让那些病毒木马无所遁形</title>
      <link>https://newblog.backupnext.cloud/post/2019-07-18-secure-restore/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2019-07-18-secure-restore/</guid>
      <description>安全和备份是IT架构中两大重要的基础组件，通常情况下无论是个人家用和企业商用，都是必不可少的。然而很尴尬的是，作为安全类的杀毒软件，需要面对各种病毒和木马以及他们的变种，甚至是不断出现的新型病毒。有些病毒软件还具备了反杀毒功能，可以反向击杀杀毒软件，令人防不胜防。
传统IT中，为每一台操作系统安装杀毒软件的方法显然不足以做到全面的防护，甚至是很容易被病毒软件破坏。而结合虚拟化技术之后，杀毒引擎被整合入虚拟化层，利用虚拟化的技术可以避免很多传统杀毒软件植入式安装带来的问题。
然而这依旧无法解决一个重要问题，就是每款杀毒软件都有自己的强项，再优秀的杀毒软件都有需要更新病毒库的时候，总有那么一些病毒，是无法被某个软件杀死的。根据AV-Test的报告，市面上的杀毒软件种类几十种，查杀能力在不同版本时各不相同。
前些天，在设计一个分布式的备份架构设计时，突然想到Veeam的Mount Server的特殊作用：可以在不同的Mount Server上安装不同的杀毒软件，形成多套不同杀毒引擎。使用Secure Restore时，只需要合理选择Mount Server即可实现使用不同的引擎进行病毒查杀。
操作方法 配置Mount Server 在VBR中，Mount Server是个很基本的组件，没有太多要求，只需要是一台Windows Server，并且是Veeam Managed Server，即可成为Mount Server。如果说一定得有个前提条件，我觉得应该是网络上，作为Mount Server，这个Windows就必须要能够和VBR通讯，也必须要和Repository通讯。具体通讯端口要求，可参看官网手册。
https://helpcenter.veeam.com/docs/backup/vsphere/used_ports.html?ver=95u4#mount
进入VBR console 后，只要找到Backup Infrastructure下面的Managed Servers节点，在其中将希望添加的Windows Server添加进去即可。
添加方式是经典的Veeam向导模式：
 首先填入Mount Server的FQDN或者IP地址，描述中可以填入杀毒软件名称用以识别。  下一步后填入管理员用户名密码，用于推送安装Mount Server的组件。  预览需要安装的组件，并完成添加。  ​ 为Repository选择Mount Server 由于每个Repository都有其一一对应的Mount Server，因此当我们要用到某个特殊的杀毒软件时，我们只需要编辑Repository的设定，选择对应的Mount Server即可。
剩下步骤，就是进入各种支持Secure Restore的恢复操作中，执行正常的恢复步骤。
以上就是今天的内容，不是很复杂，但是很有意思，希望能帮助到被病毒困扰的管理员们。</description>
    </item>
    
    <item>
      <title>改造HOME LAB之把ESXi装进M6400</title>
      <link>https://newblog.backupnext.cloud/post/2017-08-27-esxi-in-m6400/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-08-27-esxi-in-m6400/</guid>
      <description>上周VeeamON上海站，我最大的收获可能就是看到同事的LAB环境了，很诧异的发现，他的笔记本竟然装上ESXi了，按照我以往的认知，笔记本上安装ESXi会是一件挺麻烦的事情，特别是找驱动。不得不感叹，同学们勇于尝试的精神，这里的Key Point是使用Dell定制的ESXi ISO来安装，这样什么驱动都不需要考虑，硬盘、网卡全部含在内，一键安装一键启动，实在太方便了。遂回家决定在周末也来一次改造。
不过犹豫再三，觉得平时LAB里面还是需要保留一套Hyper-V，公司配备的Dell M4800工作站内置的硬盘做成VMFS有点可惜了，正巧手边有一块退休的USB3.0移动硬盘，萌生了1套LAB硬件同时做Hyper-V和VMware的念头。Google一小会儿，把自己的想法验证下，看看是否有一些素材能够支持这样的做法，一点不意外，完全可行。
M6400配置：
CPU：i7-4710MQ@ 2.5GHz
MEM：32GB
Disk（internal）：SAMSUNG SSD 500G
​ Seagate SATA 500G
Network：Intel i217-LM
外置设备：
USB Stick：U盘8GB，用于启动系统
USB HDD：WD 2TB SATA，通过USB3.0接入至M6400，用于local datastore
DELL customized ESXi：可以至Dell官网查找下载，阅读原文可以快速跳转
动手开干！
部署ESXi过程非常简单，顺利的引导，识别出8GB的U盘，5分钟后安装完成。进系统配IP、主机名等一系列初始化工作，完成之后加入到现有的VC中。
接下去要解决重头戏，添加External USB HDD，事实上在VMware官方来说，是并不支持使用USB HDD作为datastore用于生产环境，但是作为Home LAB来说，这可是一个好功能啊~
添加过程如下（注意以下过程仅适合ESXi 6.0）：
  打开ESXi的SSH，并连接上。
  [root@esxim4800:~] ls /dev/disks
  ​ 找到输出中有相应的usb hdd信息：
mpx.vmhba38:C0:T0:L0 mpx.vmhba38:C0:T0:L0:1 mpx.vmhba38:C0:T0:L0:2 [root@esxim4800:~] partedUtil mklabel/dev/disks/mpx.vmhba38\:C0\:T0\:L0 gpt 计算vmfs卷的end sector  [root@esxim4800:~] eval expr $(partedUtilgetptbl /dev/disks/mpx.vmhba38\:C0\:T0\:L0 | tail -1 | awk &#39;{print $1 &amp;quot;\\* &amp;quot; $2 &amp;quot; \\* &amp;quot; $3}&#39;) – 13907024064 [root@esxim4800:~] partedUtil setptbl/dev/disks/mpx.</description>
    </item>
    
    <item>
      <title>数据中心备份容量和带宽的计算方法</title>
      <link>https://newblog.backupnext.cloud/post/2017-05-05-how-to-calculate-backup-size/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-05-05-how-to-calculate-backup-size/</guid>
      <description>常常在工作中被问及，你们备份软件，重删效果如何？备份数据占多少空间？其实，就效果而言，这往往会和数据类型以及存放方式直接相关，不同的方式以及不同的设备类型，产生的实际效果差异非常大，因此这个问题说实话是非常难用一句话来回答。但是，无论如何，备份数据是需要磁盘空间进行存储的，在备份项目的设计过程中，必然会有备份存储库的容量设计。通常这个设计会直接关系到用户的存储成本、存储效率以及备份的可用性，因此这个设计在备份项目中非常关键，尽可能准确的设计存储容量和带宽，直接关系到项目的成败。
这里我会以一个典型的虚拟化环境为例来说明应该如何去进行这个计算。
环境信息：
ESXi Host ：25台
VM：500个
每个VM平均磁盘容量：200GB
总Datastore使用容量：100TB
带宽设计
通常来说，备份过程中会有全备份和增量备份两种模式，一般情况下，首次备份是全备份，它将传输虚拟化环境中的所有数据至备份存储设备，因此这个传输量几乎为所有的Datastore的使用量；而后续的所有传输则是增量备份，传输的是虚拟化环境中的变化量，常见比较多的是每日变化量，本文暂时按照每日作为变化量的单位来计算。
每个环境中，每日的变化量可以根据Veeam ONE的变化评估报告获取，是相对准确的数值，我这里假设这个变化量为7%。所以我们的到以下数值：
首次传输数据量 ： 100TB
每天增量传输数据量：7TB
开启Veeam的优化压缩重删后，假设这个重删能够达到常规的效果，实际传输数据为datastore容量的50%：
首次真实传输数据量：50TB
每天真实传输数据量：3.5TB
因此我们需要的带宽计算如下，假设首次传输，我们可以开启周六24小时连续传输而后续增量备份则在每天业务空闲时20:00PM~6:00AM进行，除去备份作业的基础配置耗时后，我们大约估算实际数据传输时间为总耗时的80%，也就是10小时的备份工作时间内2小时为备份基础配置和等待时间，8小时为实际数据传输时间。因此简单的计算公式示例如下：
全备份需要带宽：5010248/(24360080%)=5.93Gbps
增量备份需要带宽：3.510248/(10360080%)=1Gbps
以上，我们可以看到这样的一个大概状况，那么在网络上和磁盘上的读写吞吐量可以按照这个数据去进行规划，配置相应数量的网卡/HBA卡以实现以上这样的一个备份吞吐量。
容量设计
根据不同的备份模式，在数据存储无任何重删技术的情况下，这个容量设计是最容易进行计算的，以下将以最常见的常见常规增量备份为例来说明计算方法，这也是一个比较简单的计算题。
至少保留14份备份数据，每周执行1次全备份，每天进行1次增量备份。
   格式 天 大小     全备份 1 50 TB   增量 2 3.5TB   增量 3 3.5TB   增量 4 3.5TB   增量 5 3.5TB   增量 6 3.5TB   增量 7 3.</description>
    </item>
    
    <item>
      <title>数据集成API真的就只是API？</title>
      <link>https://newblog.backupnext.cloud/post/2020-07-13-data-integration-api/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-07-13-data-integration-api/</guid>
      <description>Veeam发布v10之后，推出了一个全新的功能，但是这个功能深深的埋藏在了Powershell API之下，并且被冠了一个令人高不可攀的名称：数据集成API。我相信很多朋友看完这个名字，就可能不太想了解这个功能。对于系统管理员来说，有点略复杂了，还要开发什么东西才能把这个用起来？算了还是不用了。
功能 其实这个功能并不是那么的复杂，我们先来了解下怎么回事。
这个功能其实是通过iSCSI的磁盘服务，将备份存档通过iSCSI发布给相关服务器使用。它是数据利用的新形态，也就是说任何的Veeam的镜像级备份存档，都可以通过这种形式挂载给服务器去访问里面的数据。它和即时虚拟机恢复有那么一点点像，但是完全不一样的是，它完全不依赖于虚拟化环境，不依赖VMware和Hyper-V，而是将数据直接通过iSCSI服务发布给Windows或者Linux系统访问。在VBR中，绝大多数镜像级的备份存档都支持这种形式的发布：
 VMware镜像级备份 VMware镜像级复制 Hyper-V镜像级备份 Hyper-V镜像级复制 Veeam Agent for Windows的镜像级备份 Veeam Agent for Linux的镜像级备份  原理 iSCSI挂载的工作原理非常简单，在API发起后，VBR的挂载服务器相当于变成一台iSCSI的存储机头，它能为所有可以访问iSCSI存储的系统提供iSCSI的服务，而这里面提供出去的数据则是VBR的存档，管理员可以按需从备份或复制存档中选择需要的数据。在这个数据集成服务建立起来后，数据使用者可以通过iSCSI的存储协议，直接挂载发布出来的卷，读取其中的数据，使用其中的数据。如图所示，在数据集成服务将备份存档发布后，备份系统变成了一套iSCSI的存储系统，里面存放的数据是之前的历史备份数据。
使用方法 因为它以API形式开放给用户使用，因此在VBR控制台上并没有直接的按钮来使用，但是这完全挡不住我们使用这么优秀的功能。可以直接使用本文最后面的这个Powershell的脚本来实现这个功能，需要做的很简单，只要copy脚本内容到记事本，存成.ps1文件，然后在VBR服务器的Powershell控制台中执行这个交互式脚本即可，按照脚本执行过程中的提示输入必要的信息就能成功将存档通过iSCSI发布出来了。
执行脚本后，会看到Powershell控制台上输入内容后会看到以下效果：
而此时，在VBR上会看到发布出来的磁盘信息，它以Instant Recovery显示在VBR控制台中。
接下来，我们可以来到iSCSI客户端上，比如刚刚在脚本执行时输入IP地址的机器10.10.1.175上，打开Windows的iSCSI Initiator，填入iSCSI的target为10.10.1.201，端口默认3260，来挂载这个iSCSI卷了。
在使用结束后，不要忘了在VBR上点击Stop Publishing来回收这个iSCSI卷。
以上就是简单实用的新功能，iSCSI发布。赶紧下载VBR装上试一下吧。
附上脚本：
# 本脚本是Veeam DataIntegration API的使用样例 # 用于通过iSCSI方式将备份数据挂载给指定的系统进行使用 # 使用脚本需要至少有7个还原点以上，否则请修改脚本使用 # 脚本暂时仅限VMware、Hyper-V的主备份存档，如需Agent、Backup Copy、Replication、Storage Snapshot，请根据需求修改脚本。 # # 脚本作者：Wei Lei # Email:lei.wei@veeam.com # 脚本版本：v1.1 ################# Update log ###################### # 更新了VBR用户名密码错误后立刻停止脚本； # 更新了还原点选择错误后，自动终止脚本； ################################################### # Script Start # VBR Server (Server Name, FQDN or IP) $vbrServer = Read-Host &amp;#34;请输入VBR地址，可以是域名或者IP&amp;#34; # VBR Credentials Write-Host &amp;#34;请在弹出对话框中输入VBR的用户名密码。&amp;#34; $Credential=Get-Credential -Message 请输入VBR的用户名密码 $vbrusername = $Credential.</description>
    </item>
    
    <item>
      <title>文件级恢复的秘密</title>
      <link>https://newblog.backupnext.cloud/post/2017-04-20-secret-in-file-level-recovery/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-04-20-secret-in-file-level-recovery/</guid>
      <description>虚拟机备份后，通常会有很多种恢复方法，分别适用于不同的恢复场景。其中有一种广为使用的方法叫文件级恢复，这种方法并不是什么新技术，早在虚拟化备份刚刚诞生的时候，就有了这样的需求，也很早被各大备份软件厂商所实现。粗看这个技术无任何门槛，然而实际上在真正需要恢复时，Veeam可以帮到很多忙。
我们来看一下这样子的情况，我打开了文件级还原的浏览器，这一般都是由备份软件厂商提供的界面：
我们会发现，这里有一堆的PDF格式的文件，不过好像这些文件是啥我都不知道唉(⊙o⊙)…光看文件名，看不懂是啥，我想在恢复之前，能不能先打开看看咧？万一不对，是不是这个恢复就白做了呢？
好像这事在备份软件厂商提供的界面上，我们无法完成哎。不过，Veeam FLR有个灰常灰常强大的按钮，请大家看看这里：
这是一个神奇的按钮，当我们点下去这个按钮后，我们竟然这样了：
然后，我发现，这些我无法打开的pdf，我可以在我的本地先打开看看内容，再决定恢复啦~。是不是很棒？
再来一个，好像zip包，我其实只想恢复zip包内的文件，这时候咋办？
一样神通广大的这个按钮来干这事
这是一个神奇的按钮，可以为恢复提供无限多想象，各种只有特殊应用程序才能识别的对象，只要预先安装了应用程序，能识别数据格式，这一神奇的按钮，就能帮我们提取对象，恢复内容。数据内容才是我们信息化的核心，任何不关心内容的恢复都是赤裸裸的欺骗，所以，请在恢复之前用一下这个按钮！</description>
    </item>
    
    <item>
      <title>新年第一篇 - Veeam 9.5U3集中管理Agent详解</title>
      <link>https://newblog.backupnext.cloud/post/2018-01-01-centrilized-agent-management/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2018-01-01-centrilized-agent-management/</guid>
      <description>VBR中的Agent集中管理 本次更新加入了Agent的集中管理，界面上发生了很大变化，原有的Backup &amp;amp; Replication更名成为Home，而原有的Virtual Machine更名为Inventory。Agent的管理功能都会搬到Inventory下面的Physical &amp;amp; Cloud Infrastructure下。
Veeam管理Agent的方式还是和其他Veeam的功能非常类似，非常简单的3部曲方式：
 创建Protection Group – 定义并自动发现需要保护的对象。 创建Job或者Policy – 定义备份任务或者备份策略实现备份。 执行Restore – 通过多种还原手段实现数据还原。  我们先来一起熟悉下Physical &amp;amp; Cloud Infrastructure界面。
在这个节点中会出现一些类似文件夹的图标，在软件升级完成后，会立刻出现Manually Added、Unmanaged这两个系统内置文件夹，而在我们开始创建新的Protection Group后，又会出现一些我们创建的文件夹，每一个文件夹就是一个Protection Group，里面会包含一组需要保护的服务器或者工作站。
创建Protection Group
又是老套路，Veeam经典的向导式操作方式，创建Protection Group
支持3种添加Protection Group的方式，其实也就是3种不同的服务器/工作站添加模式
 Individual computers  这种方式可以手工逐台Computers添加，支持Host Name或者IP address，然后Credentials中输入合适的账号密码即可。
 Microsoft Active Directory objects  这种方式需要先点击Change按钮设定AD相关信息，包括AD的域名和域管理员账号，然后就可以找到AD中的所有对象，按照对象的方式动态添加被保护的服务器/工作站。
自动排除不需要使用Agent进行保护的对象，特别是虚拟机。
 Computers from CSV files  这种模式只需手工编辑host name或者ip地址到一个CSV文件，然后指定从这个文件读取host列表即可。
为不同的Host分别指定合适的管理员账号。
设定自动发现和扫描的间隔，在扫描完成后是否进行Agent和Windows CBT驱动的自动推送安装，安装完成后如果有需要重新启动，是否自动启动。
检测推送分发Agent的服务器的状态，检测完成后，Protection Group就创建完成了。
Veeam Agent for Windows和Veeam Agent for Linux略有不同，我们先看看Windows的。</description>
    </item>
    
    <item>
      <title>无代理备份和应用程序感知</title>
      <link>https://newblog.backupnext.cloud/post/2017-07-23-agentless-backup/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2017-07-23-agentless-backup/</guid>
      <description>虚拟化技术是一个彻底改变IT世界的技术，同样在备份领域随着虚拟化技术的使用引入的无代理备份概念也不断对传统技术带来冲击。但是作为一对互相矛盾的技术 - 代理备份和无代理备份，其各自的优缺点也是相当明显。然而Veeam的无代理备份技术则是发挥了两者绝大多数的优势，实现了无代理备份的同时能感知应用程序。
什么是代理（Software Agent）？
这个IT专业词汇其实在中文上来说，并没办法给出很好很明确的定义，以致我们日常在技术交流的时候会含糊其辞，有时候会谈广义的代理，有时候会谈狭义的代理。我试着去从百度百科找找代理的定义，结果还是无功而返。而在wikipedia上，倒是有Software Agent的定义，不过也只是通过大众的认知给了一些Software Agent的应具备的特性：
 持续运行 - 通常会保持运行状态，即使空闲时候也会处于等待状态。 自动自主运行 - 无需人工干预和交互就能保持运行状态。 应用程序交互功能 - 能够和其他程序发生交互，激活其他模块、互相通讯、协同工作。  仔细琢磨了下，确实传统领域的代理备份，那些代理软件倒是符合这些Agent应具备的特性。
Veeam无代理备份和应用程序感知
Veeam的虚拟化备份技术，是不需要在任何的操作系统内安装任何这类的程序，因此备份不需要系统的运行状态。
而应用程序感知则是在备份过程中，Veeam全自动的到操作系统内运行一个进程，完成相应的应用程序感知、一致性保障和文件系统一致性处理，之后关闭应用程序，退出执行。这一过程只是在备份执行过程中的一个可选进程，因此是完全不同于上述的代理程序。
所以，通常代理程序会面临的问题，对于备份代理一样会碰到：
 需要不停的为新部署的虚拟机，手工安装代理程序（我们认为推送虽然方便，但也是“手工”的一种，避免不了远程/本地的配置工作）； 软件更新的时候，需要为每一台机器升级代理； 在长期大规模环境的运行过程中，还需要考虑拿个什么软件去监控这些代理，我们所谓代理保姆，就是干这事的，防止哪天这些代理突然不工作了也没人知道； 以上这些都是长期消耗计算资源的，包括CPU、内存、网络、存储，并且很多时候是重复的消耗。  而Veeam的技术，在深入到应用程序层面的感知进程，仅仅是在备份启动那一刻运行几分钟后立刻被关闭退出，因此完全不存在以上提及的这些问题。无需每次部署/无需更新/不用长期运行监控。
更有意思的是，现在的IT世界是一个运行越多风险越大的世界。我们没有任何应用程序的时候，就是一个最最安全的状态，而每增加一个应用程序，就多一份被黑客、病毒、勒索软件攻击的风险。为每一个系统减少一份持续运行应用程序，就是为我们的系统安全增加一份保障。
另外，如果系统关机了，那么需要保持运行才能进行备份的代理程序就彻底歇菜了。备份目标Offline，这是传统备份软件界面中常常见到的事情，这时候备份管理员能做的唯一事情就是去找到应用或者基础架构的管理员去启动这个操作系统。而对于无代理的技术，即使是系统关机的情况下，备份依然不受影响。而还原过程中，Veeam的多样化的颗粒度恢复却依然可以手工执行，堪称是完美的备份和还原。
传统代理的更多缺陷
利用代理技术的数据备份，绝大多数依赖网络。当我们为了隔离安全，去架构DMZ区域，去进行严格的出入规则的时候，突然发现因为买备份这个保险，我们不得不需要有个数据流去DMZ区域完成数据的抽取，以致原先的完全隔离的架构被打破，苦心设计的完美架构失去了其原本的设计目标。
Veeam的这种应用程序插入运行技术则完全不同于传统代理，在感知应用程序时，这个运行执行可以通过VIX在无网络连通的状态下进行Hypervisor层面的感知。因此，在Veeam的设计理念中，可以为那些DMZ区域的备份带来更多一份的安全。</description>
    </item>
    
    <item>
      <title>用了这个方法，您的备份数据再也不怕被勒索了</title>
      <link>https://newblog.backupnext.cloud/post/2021-03-22-hardened-linux-repository/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2021-03-22-hardened-linux-repository/</guid>
      <description>勒索病毒自从2017年5月12日大规模爆发以来，在过去的4年里，也不断的自我进化，产生各种变种病毒，并且学会了各种弱点攻击，甚至是买通了门卫大叔&amp;hellip;

但是不管怎么样，门卫大叔是我们最值得信赖的，是我们的最后一道防线，我今天就想来和大家聊聊如何基于这最后一道防线，来构建我们安全的备份数据环境。
实现效果 先来说说实现效果：
 存放数据的设备我们选用大容量磁盘的机架式服务器，满配SATA硬盘，实现机架上容量密度最大化且每TB容量成本最低，这部分非常容易实现，咨询各大服务器厂商购买这样的服务器就行了。 这台机架服务器上线提供服务后，禁用所有账号的远程登录行为。唯一可访问的方式被限制在使用服务器上外接显示器、键盘和鼠标才能访问控制台。上架后对机柜进行上锁，控制机柜钥匙。 网络交换机和防火墙上，无需修改和设置这台服务器的任何访问，因为本身端口和服务的限制，这台服务器只被开放了Veeam服务用到的2500-3300的数据传输端口，这个数据传输链路仅限Veeam Datamover组件访问。 对于Veeam服务，只允许将数据写入到这个存储设备和从这个设备读取数据，而无法进行这些写入数据的修改和删除。  简单来说，就是这台设备只留了单通道使数据从Veeam进入这台服务器，进入后就被封起来了，只让外界通过Veeam的透明数据封存边界能读取数据并使用数据。
实现工具 非常简单，只需要Linux和Veeam v11，任何Veeam版本都具备这个功能，包括社区版。在v11新产品特性中，它叫Hardened Linux Repository。它有两部分功能组成：
  Single-use credentials for hardened repository
这个功能，用来完成对数据存储设备的初始配置，在初始配置时，会使用到一个单次使用的配置用途的账号，这个账号不会记忆留存于Veeam的任何服务上，并且在初始配置结束后，就可以禁用这个账号的远程访问以及sudo权限了。
  immutable flag
这个功能，用来建立透明的数据封存边界，允许Veeam写入并读取数据，但是不允许Veeam来删除和修改已写入的数据。当然为了平衡容量，immutable被设计成一个时间周期，指定周期内的短期数据才会进入封存边界内，而超过了这个周期的数据自动从边界内退出来，从而实现过期后可以被删除后释放空间。
  配置方法 以下配置方法包括Linux服务器上的配置和Veeam存储库的配置，其中Linux以Ubuntu 20.04LTS为例子来说明，其他发行版请各位大拿自行修改。
Ubuntu Repository预配置  创建用于一次性登录配置的用户。  admin@hardenedrepo:~$ sudo useradd -m veeamrepo admin@hardenedrepo:~$ sudo passwd veeamrepo 准备好相应备份空间格式化完成，并挂载到Ubuntu中的目录，比如/backupdata，请通过以下命令确认挂载结果。  admin@hardenedrepo:~$ df -h | grep /backupdata 赋予veeamrepo管理备份空间的权限。  admin@hardenedrepo:~$ sudo chown -R veeamrepo:veeamrepo /backupdata 修改sudoers配置文件，临时赋予veeamrepo用户sudo权限。  admin@hardenedrepo:~$ sudo vi /etc/sudoers  添加以下信息到sudoers文件后，保存。  veeamrepo	ALL=(ALL:ALL) ALL 这样，Ubuntu这边就算配置完成了，可以到Veeam中配置Hardened Repository了。</description>
    </item>
    
    <item>
      <title>自制Chrome浏览器插件 - 中文版Enterprise Manager Beta发布</title>
      <link>https://newblog.backupnext.cloud/post/2020-03-13-localized-web-ui/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2020-03-13-localized-web-ui/</guid>
      <description>自加入Veeam起，一直不断有“什么时候才能有中文界面？”的呼声。只是这是一件非常困难的事情，我一向对这个事情的态度都很悲观。
不过，方法总比困难多，不是吗？今天就给大家带来个小福利，Web界面的Veeam Enterprise Manager的汉化插件。
先放上界面样图：
插件下载地址：
https://gitee.com/veeamchinadocs/veeam-webui-cn-plugin
使用方法很简单，只需要下载后把Veeam-CN-WebUI-Beta-1.x.x 文件夹放到Chrome的机器上，注意不一定是Enterprise Manager的服务器，然后按照说明进行操作即可。
注意点：
 这个插件是Chrome页面本地化插件，建议不在访问Veeam Enterprise Manager时务必记得关闭这个插件。 汉化完成度95%，部分内容暂时还没找到汉化方法，但是不影响使用。 如果发现有些页面没有及时刷新成中文，或者变成了英文，只要刷新下页面或者点击下页面上的其他超链接，即可切换成中文。 这是个页面客户端插件，因此完全不影响Veeam软件使用，只需要关闭插件刷新页面或者换浏览器换电脑重新打开EM使用即可。  最后还需要感谢下Veeam日本的SE们，我只是在他们基础上将这个插件制作成了中文版。</description>
    </item>
    
    <item>
      <title>送 | 为裸奔中的电脑送一个备份保护</title>
      <link>https://newblog.backupnext.cloud/post/2019-07-02-agent-backup/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2019-07-02-agent-backup/</guid>
      <description>上一个时代的Norton Ghost 不知道有多少人还记得Norton Ghost，我对于Ghost的记忆要追溯到刚接触到PC那段时间，差不多20年前吧，那是在电脑城装完组装机，第一件事情就是使用Ghost做一个系统备份。
而也是从那时起，Ghost成为每一个电脑的标配。一直到10年前的Win7时代甚至是今天的Win10，很多个人电脑的启动项中还保留着两项，其中第二项就是，“使用一键Ghost恢复系统”。可以说，Ghost在那时，几乎是人手一个。
确实，Ghost非常好用，但是这已经是上一个时代的工具了，Symantec 旗下Norton Ghost团队也早在2013年3月底就停止更新和支持这款工具了。流传在民间的这一工具仅剩可用的版本也一直停留在v11版本，实在是有点可惜。
不过没关系，虽然Ghost没了，但是我们现在有了一个完美的替代品，这就是Veeam Agent for Microsoft Windows免费版！
今天的主题，我思考了许久，开始一直担心大家对免费软件的看法。通常我们大多数会想到的是，残缺的功能，黑心厂商为了赚钱挖了好多坑，使用中还会不断来一些广告和提醒，告诉你得赶紧付费了。这样的使用体验太崩溃，一般碰到这样的软件，我的大多数选择是卸载！
而Ghost的好用之处其实很大原因是当时的互联网并不发达，而这个软件本身也没有太多商业因素的考虑，很纯粹的软件，零广告零捆绑。我今天要安利的Veeam免费工具，在这点上和Ghost及其相似！
Veeam Agent for Microsoft Windows 免费版 同样是零广告零捆绑，下载安装即可使用，且功能全面。唯一缺点，我觉得就是暂时只有英文版了。不过问题不大，我今天就带大家Step by Step来一遍，保证你能用上它。
下载安装 下载安装非常简单，到Veeam官网https://www.veeam.com注册账号，进入下载页面，就能找到这个免费的软件下载。拿到最新版本VeeamAgentWindows_3.0.1.1039.exe后，双击就可以进入安装向导，整个安装过程只需要4步即可完成。
Step 1：有个简单的介绍，以及同意使用协议，有兴趣的朋友可以详细阅读，当然不想读也没问题，打钩2个&amp;quot;I accept&amp;quot; 就能激活Install按钮。
**Step 2：**自动安装，注意这里不能更改安装路径，软件会自动装入Windows的默认软件安装目录中。
**Step 3：**大约几分钟后，安装完成，如果有在电脑上插入了usb外置驱动器设备，会自动发现外置usb驱动器设备，并提示配置备份作业。我们可以跳过这个步骤不配置。
**Step 4：**在最后一步，会提示软件已经安装成功，并且会提示创建还原用的Recovery Media。这个还原介质非常重要，它将能够在你的系统全部崩溃后帮你恢复你的系统和数据。
安装完成后的第一件事：恢复盘创建 这个步骤也非常简单，标准的Veeam式向导会带大家完成创建过程。
Step 1: 点击Finish按钮之后，就会进入Recovery Media创建向导，过程也非常简单，首先选择可启动的介质类型，这里可以是ISO镜像也可以是U盘，如果有插入恢复用U盘的话，可以直接选择该U盘，在我的这个介绍中，我们选择ISO镜像，其过程和U盘大同小异，并且未来ISO镜像也可以通过其他途径做成U盘。
Step 2: 这里默认Veeam会提供两个非常有用的选项，就是网卡驱动和网络配置，这对于从网络上恢复数据非常有帮助，减少了恢复时的一些配置步骤。选择ISO image file之后点击next进入下一步，会提示ISO文件的存放路径，这里可以是本地路径，也可以是网络UNC路径，如果是CIFS共享的UNC路径，可能需要提供用户名密码。
Step 3: 点击下一步，是一个Summary界面，告诉您刚刚配了些什么。
Step 4: 点击Create就能创建这个ISO镜像了。几分钟之后，这个恢复盘就创建好了，做恢复的时候用它引导启动就对了，当然这个ISO中并不完全包含数据。
备份作业配置 打开Veeam Control Panel，软件会提示一下，是否在免费版模式运行，还是输入一个商业版授权，这也是这个软件仅有的唯一一次提示，只需要点击否，继续运行免费版即可。
点击右上角的三条线图标后打开主菜单，点击加号Add New Job开始创建备份作业。
备份作业创建过程也非常简单，依旧是经典的Veeam式向导。
Step 1： 定义一个备份作业名称，写上一些描述说明。
Step 2： 选择备份模式，对于免费版来说，可以选择备份完整计算机以及外置USB驱动器，也可以选择备份某个磁盘卷，还能够备份部分文件。我们选择备份完整计算机。
Step 3： 选择备份目的地，这时候可以是USB、火线、eSATA等等各种连接方式的硬盘，也可以是网络上共享的NAS卷还可以是Veeam集中管理的备份存储等等。因为是个人用途，我们一般会选择备份至移动硬盘，或者是家用NAS中，本例子中，我选择将数据备份至家里的群晖NAS上。</description>
    </item>
    
    <item>
      <title>送 | 从送你的备份中恢复数据方法详解</title>
      <link>https://newblog.backupnext.cloud/post/2019-07-03-agent-backup-and-restore/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2019-07-03-agent-backup-and-restore/</guid>
      <description>昨天的推送中，介绍了《备份软件的安装和备份方法》。不讲一下恢复，我觉得大家一定会认为我在耍流氓。那么今天的这篇，我就来详解下Veeam Agent for Microsoft Windows免费版的数据恢复方法。
三大恢复场景 备份方法只有一种，但是做完备份后，Veeam最擅长是给你无数种恢复方法，让你用最短的时间恢复你想要的数据。
1. 文件还原 最方便的是打开Veeam Control panel，点击任何一个柱状条，每一个柱状条就是一个还原点。
点击进去后，能够看到增量备份的详细日志，而在窗口最下方，可以看到两个按钮，其中一个是还原单个文件，另外一个则是整卷还原。
点击Restore Files，可以打开文件级还原的浏览器。这个窗口和我们常用的Windows资源管理器非常相似，在这里我们可以浏览到备份存档中的所有文件，提取里面的单个文件进行恢复。Veeam 提供了还原、覆盖、复制和查看属性等一系列丰富的操作，完成数据恢复。
如果觉得这个还不够，点击Open in Explorer按钮还能直接在Windows资源管理器中打开，那么这时候，你可以查看备份存档中的任意格式的文件，找到需要的内容进行恢复。
2. 整卷还原 文件还原隔壁的按钮就是整卷还原了。
点开来以后依旧是Veeam向导，用来做整卷恢复，由于是直接从备份作业中点开的向导，所以可以省去备份存档的选择步骤，直接进入还原点选择。
点击Next以后进入磁盘分区的映射
映射完成后就进入恢复了。
因为操作系统运行的关系，整卷还原需要非常小心，有一些需要注意的地方：
  不能将操作系统所在的卷还原到正在运行中的原系统。     不能将操作系统卷还原至有windows swap文件所在的卷     不能将卷还原至存放着vbk文件的磁盘分区中。   3. 整机还原 当你的整个系统崩溃以后，可以进行整机恢复。使用之前配置的ISO，最方便的方法是刻录成一个可引导的U盘，用该U盘来启动系统。这时候系统会进入一个Windows PE恢复界面。
这是Veeam免费提供的非常强大的恢复套件，除了整合了Veeam BMR之外，还会有一些系统急救修复工具，就算不是用Veeam BMR功能，这个急救包也能在关键时刻起作用。
如果U盘引导的系统就是原来的电脑，这时候网卡驱动会自动被识别出来。
对于BMR，恢复方式也是经典的Veeam向导方式。点击Bare Metal Recovery就可以进入向导。
进入向导后，如果找不到本地磁盘驱动器，还可以加载磁盘驱动，来识别磁盘内的备份数据，当然比较简单的方式就是直接使用Network Storage，找NAS中的数据。
选择Share Folder后，点击Next，可以进行NAS的一些简单配置，依旧是CIFS的的UNC路径，必要的情况下需要输入用户名和密码。
如果配置文件夹路径正确，点击Next之后，就可以读取到文件夹中的所有备份存档。
选择合适的备份存档之后，点击Next进入还原点的选择。
点击Next选择还原模式。可以进行整机还原，也可以只还原系统卷，最强大的是可以支持定制手工还原的高级模式，进行分区的重新构建和映射。
设置完磁盘映射后，就能开始还原过程，经过一段时间的等待，系统将会被恢复出来。
这么好的免费产品还有技术支持？
这是真的，如果你碰到问题，你的英语足够好，你可以在Veeam Control Panel中找到Support界面
这里你可以通过在线文档和在线论坛来查找资料和提交反馈意见，更重要的是，还有原厂的技术支持，通过Technical Support来提交一个case。
如果是免费用户，那么当我们的技术支持工程师空闲的时候，我们会尽量通过邮件的方式来回复你碰到的问题。
今天的内容看上去比昨天的备份还要短，还要简单，如果昨天还没用上Veeam的，今天赶紧装一套吧，数据备份永远不会晚，快点备份起来吧。
更多内容，可以关注我的公众号，下一期我会来介绍一些备份的场景，可以更近距离来接触这套优秀的个人备份软件。</description>
    </item>
    
    <item>
      <title>野路子 - 用Veeam抵御勒索攻击的另类方法</title>
      <link>https://newblog.backupnext.cloud/post/2021-04-02-rotated-driver/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2021-04-02-rotated-driver/</guid>
      <description>我觉得这几天朋友们看了不少关于Veeam在v11中如何抵御勒索软件的方法，但是应该还是没有看够。方法是不是有点太单一？黑客们都在不断研究，我们IT管理员们怎么可以停下来。
今天我想给各位分享一个另类的数据存放方法，使用轮换移动硬盘的方法来存放VBR的备份数据。这个存放方法脑洞比较大，很少被管理员使用，通常这类轮换的方法会在光盘和磁带上用的比较多，而移动硬盘上几乎很少用。需要注意的是，这个方法并不是一种可以让您高枕无忧的方法，它更多的是给了你一种使用离线硬盘的野路子。
场景和条件  一个方便硬盘插拔的移动硬盘盒，速度越快越好，一般来说现在USB 3、USB-C或者eSATA这类的接口都是不错的选择，USB 3和USB-C会更通用一些。 多块大容量机械硬盘，可以使用7200转的SATA盘，一般和这些移动硬盘盒接口兼容。 备份数据按一定周期分别逐个写入硬盘中，备份管理员按一定周期取出硬盘，离线存放。  实现效果  只要保证数据在离线前，没有被篡改被加密，那么离线后硬盘中的数据是妥妥的。 在各个硬盘上的备份数据自成一体，对于其他硬盘没有依赖性。 每个硬盘中的备份数据都有独立的元数据配置文件，用于数据使用时的信息读取。 相比磁带更有优势，数据使用和还原时更加直接。  使用方法 来，直接上视频，戳下方视频，仔细观看。
看完后感觉如何？其实这个方法对于Veeam Backup &amp;amp; Replication、Veeam Agent for Windows、Veeam Agent for Linux都可以使用，赶紧可以来下载用用看哟。</description>
    </item>
    
    <item>
      <title>黑科技 | 激活隐藏在VBR中的快照猎手</title>
      <link>https://newblog.backupnext.cloud/post/2019-07-24-snapshot-hunter/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://newblog.backupnext.cloud/post/2019-07-24-snapshot-hunter/</guid>
      <description>好久好久没更新这个黑科技系列了，今天带来一篇想写了很久的功能。
这项创造性科技我认为是可以在Veeam功能实用性排行榜上排上前三的。而绝大多数Veeam使用者我相信也几乎不知道有这个科技的存在。它就像个默默无闻的老黄牛，出现在每一个Backup/Replication的作业中，为每一台VM保驾护航。
Snapshot 基础知识 VMware的Snapshot，自从有了虚拟化技术之后，可以说是虚拟化领域最具争议的技术。很多人因为喜欢快照技术开始入门虚拟化，很多人因为痛恨快照技术弃用一些解决方案和功能。而对于备份软件来说，想做好虚拟化的备份，不得不面对快照技术，修炼快照基本功是一门必修课！
Veeam产品中大量使用VMware快照技术，在任务发起时，会通过API接口发送快照指令给vSphere，这时候有个名叫***“VEEAM BACKUP TEMPORARY SNAPSHOT”***会出现在虚拟机的快照管理器中。而任务结束时，Veeam会再一次发送指令要求VMware删除该快照。
这时候，因为涉及到基础架构中多个产品之间的互相通讯，往往会出现一个结果，就是这个临时快照并没有被删除，甚至是出现一些“假删除”的情况。也就是说，表面上从快照管理器中看到已经不存在快照了，而实际上在vSphere Datastore中，依旧存在00001.vmdk这样的快照差异磁盘文件。VMware中，这种快照文件一般被称为孤立的快照（Orphaned snapshot），通常这种快照如果存在，后续的正常的快照都会受影响，而VMware的快照管理器中也会提供相应的“整合快照选项”。
然而情况往往并没有那么乐观，这个问题不那么容易被发现，而这个整合也不那么顺利能进行。在有些时候往往就会碰到报错而进行不下去的状况，这种情况我们统称为Snapshot issue。而出现这种情况多数是因为没有及时去处理这个潜在的Orphaned Snapshot。
我这里提供几个VMware官网的KB，算是小福利哦，能够帮大家更快处理这类issue。
 https://kb.vmware.com/s/article/1005049
https://kb.vmware.com/s/article/1006847
https://kb.vmware.com/s/article/1038963
https://kb.vmware.com/s/article/2003638
 快照猎手 如果不想那么麻烦，手工去做这么复杂的快照整合操作，那么可以试试Veeam Backup &amp;amp; Replication。在VBR中，有个特殊功能，能够全自动处理这些Snapshot issue，我们称他为“快照猎手”。
通常这个功能会在每个备份和复制的Job中自动执行，因此对于一般用户而言，这个功能在后台全自动的进行。Veeam会全自动处理可能碰到的一切快照Issue。它的处理过程分为两大类：
 检测是否有上次备份后残留的Veeam辅助快照“VEEAM BACKUP TEMPORARY SNAPSHOT”，如果有，将会在备份之前提前删除该快照。这个过程确保历史任务中遗留的Veeam快照会被处理干净。 检测是否存在孤立的快照，如果有，尝试将它整合。这个过程确保除了上一种情况之外的所有情况都会被政策修复。  而对于第二步过程，Veeam又会采用一组复杂的整合算法，这个算法是综合了上文提到的4个VMware官方KB的精华。
 普通的VMware快照整合方法 这个和VMware菜单上的Consolidation按钮功能完全相同，如果正常能用VMware菜单上Consolidation按钮整合完成的，那么事情非常简单，Veeam会用这个功能立刻完成整合。 强制整合，不带静默 如果上一种方式失败，Veeam就会执行第二种方法，这种方法Veeam会借助快照技术，创建一个新的快照，然后调用VMware的***Delete all snapshot***命令，通过这种方式一把移除所有孤立快照，恢复磁盘状态。 强制整合，带静默 如果上一种方式还是失败，Veeam会执行第三种方法，这种方法会创建VMware静默快照，然后再次使用Delete all snapshot命令。 如果以上3种方法都失败 Veeam会发失败警告给用户，建议手工处理孤立快照，避免生产存储被撑爆。  最后，我还会有个视频，来给大家Demo一下快照猎手，近距离感受下快照猎手的强大。
好了，感谢收看今天的内容，下期再会！</description>
    </item>
    
  </channel>
</rss>
