<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>VAO基础入门（九） - 文档模板解析 | Backup next cloud</title><meta name=keywords content="VAO"><meta name=description content="系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  本系列的最后一篇，我来介绍一下VAO的文档系统。
VAO能够全自动的为管理员生成灾备需要的系统文档，文档的内容为VAO系统自动根据Orchestration Plan的设置和执行自动生成。VAO文档系统的强大在于所有的内容系统根据配置和运行会全自动生成，因此管理员只需要专心关注自己的灾备即可，这些后续的基础保障，繁琐的文档制定，全部交给VAO来完成。
VAO生成的每个文档会包含两部分，第一部分是灾备管理员定义的Report Template；第二部分是系统根据Report Type生成的动态内容。无论什么类型的文档，在文档的开头部分都会使用Report Template中所定义的内容，而第二部分则根据Report Type不同自动填充相关内容。
我们先来看个实际的例子，了解一下什么是Report Template中的内容，什么是根据Report Type自动生成的，如下图：
左边是一个VAO最终生成的Readiness Check的Report，右边是我们在编辑器中打开的Report Template。可以看到红色框所示的内容就是来自于Report Template的，而图中左边文档的后半部分内容则是根据这个Report Type，自动产生的内容。
Report Type 先来说说这个Report Type，也许聪明的你，在前几篇介绍Orchestration Plan的时候已经有看到，在每个Plan的右键菜单或者工具栏上有一些Report可以生成，它们分别是：
   Report类型 作用     Plan Definition Report 记录灾备计划设置详情   Readiness Check Report 灾备计划可用性检测报告，包含恢复目标位置和灾备中心的可用性检测   Datalab test Reort 数据实验室测试报告   Excution Report 灾备执行情况报告    这些Report就是VAO能够生成的所有Report文档，这些文档都会有一个VAO已经内置设计好的内容，能够和灾备管理员定义的Report Template组合起来，最终形成一份完整可以阅读的Report。"><meta name=author content="Lei Wei"><link rel=canonical href=https://newblog.backupnext.cloud/post/2020-03-02-vao-guide-09/><link crossorigin=anonymous href=/assets/css/stylesheet.min.2d6dbfc6e0f8a1db1c9d082a76dc11d094328cf63f247bbc2421dfaa7f2bb170.css integrity="sha256-LW2/xuD4odscnQgqdtwR0JQyjPY/JHu8JCHfqn8rsXA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://newblog.backupnext.cloud/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://newblog.backupnext.cloud/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://newblog.backupnext.cloud/favicon-32x32.png><link rel=apple-touch-icon href=https://newblog.backupnext.cloud/apple-touch-icon.png><link rel=mask-icon href=https://newblog.backupnext.cloud/favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><meta property="og:title" content="VAO基础入门（九） -  文档模板解析"><meta property="og:description" content="系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  本系列的最后一篇，我来介绍一下VAO的文档系统。
VAO能够全自动的为管理员生成灾备需要的系统文档，文档的内容为VAO系统自动根据Orchestration Plan的设置和执行自动生成。VAO文档系统的强大在于所有的内容系统根据配置和运行会全自动生成，因此管理员只需要专心关注自己的灾备即可，这些后续的基础保障，繁琐的文档制定，全部交给VAO来完成。
VAO生成的每个文档会包含两部分，第一部分是灾备管理员定义的Report Template；第二部分是系统根据Report Type生成的动态内容。无论什么类型的文档，在文档的开头部分都会使用Report Template中所定义的内容，而第二部分则根据Report Type不同自动填充相关内容。
我们先来看个实际的例子，了解一下什么是Report Template中的内容，什么是根据Report Type自动生成的，如下图：
左边是一个VAO最终生成的Readiness Check的Report，右边是我们在编辑器中打开的Report Template。可以看到红色框所示的内容就是来自于Report Template的，而图中左边文档的后半部分内容则是根据这个Report Type，自动产生的内容。
Report Type 先来说说这个Report Type，也许聪明的你，在前几篇介绍Orchestration Plan的时候已经有看到，在每个Plan的右键菜单或者工具栏上有一些Report可以生成，它们分别是：
   Report类型 作用     Plan Definition Report 记录灾备计划设置详情   Readiness Check Report 灾备计划可用性检测报告，包含恢复目标位置和灾备中心的可用性检测   Datalab test Reort 数据实验室测试报告   Excution Report 灾备执行情况报告    这些Report就是VAO能够生成的所有Report文档，这些文档都会有一个VAO已经内置设计好的内容，能够和灾备管理员定义的Report Template组合起来，最终形成一份完整可以阅读的Report。"><meta property="og:type" content="article"><meta property="og:url" content="https://newblog.backupnext.cloud/post/2020-03-02-vao-guide-09/"><meta property="article:section" content="post"><meta property="og:site_name" content="Backup next Cloud"><meta name=twitter:card content="summary"><meta name=twitter:title content="VAO基础入门（九） -  文档模板解析"><meta name=twitter:description content="系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  本系列的最后一篇，我来介绍一下VAO的文档系统。
VAO能够全自动的为管理员生成灾备需要的系统文档，文档的内容为VAO系统自动根据Orchestration Plan的设置和执行自动生成。VAO文档系统的强大在于所有的内容系统根据配置和运行会全自动生成，因此管理员只需要专心关注自己的灾备即可，这些后续的基础保障，繁琐的文档制定，全部交给VAO来完成。
VAO生成的每个文档会包含两部分，第一部分是灾备管理员定义的Report Template；第二部分是系统根据Report Type生成的动态内容。无论什么类型的文档，在文档的开头部分都会使用Report Template中所定义的内容，而第二部分则根据Report Type不同自动填充相关内容。
我们先来看个实际的例子，了解一下什么是Report Template中的内容，什么是根据Report Type自动生成的，如下图：
左边是一个VAO最终生成的Readiness Check的Report，右边是我们在编辑器中打开的Report Template。可以看到红色框所示的内容就是来自于Report Template的，而图中左边文档的后半部分内容则是根据这个Report Type，自动产生的内容。
Report Type 先来说说这个Report Type，也许聪明的你，在前几篇介绍Orchestration Plan的时候已经有看到，在每个Plan的右键菜单或者工具栏上有一些Report可以生成，它们分别是：
   Report类型 作用     Plan Definition Report 记录灾备计划设置详情   Readiness Check Report 灾备计划可用性检测报告，包含恢复目标位置和灾备中心的可用性检测   Datalab test Reort 数据实验室测试报告   Excution Report 灾备执行情况报告    这些Report就是VAO能够生成的所有Report文档，这些文档都会有一个VAO已经内置设计好的内容，能够和灾备管理员定义的Report Template组合起来，最终形成一份完整可以阅读的Report。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://newblog.backupnext.cloud/post/"},{"@type":"ListItem","position":2,"name":"VAO基础入门（九） -  文档模板解析","item":"https://newblog.backupnext.cloud/post/2020-03-02-vao-guide-09/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"VAO基础入门（九） -  文档模板解析","name":"VAO基础入门（九） -  文档模板解析","description":"系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  本系列的最后一篇，我来介绍一下VAO的文档系统。\nVAO能够全自动的为管理员生成灾备需要的系统文档，文档的内容为VAO系统自动根据Orchestration Plan的设置和执行自动生成。VAO文档系统的强大在于所有的内容系统根据配置和运行会全自动生成，因此管理员只需要专心关注自己的灾备即可，这些后续的基础保障，繁琐的文档制定，全部交给VAO来完成。\nVAO生成的每个文档会包含两部分，第一部分是灾备管理员定义的Report Template；第二部分是系统根据Report Type生成的动态内容。无论什么类型的文档，在文档的开头部分都会使用Report Template中所定义的内容，而第二部分则根据Report Type不同自动填充相关内容。\n我们先来看个实际的例子，了解一下什么是Report Template中的内容，什么是根据Report Type自动生成的，如下图：\n左边是一个VAO最终生成的Readiness Check的Report，右边是我们在编辑器中打开的Report Template。可以看到红色框所示的内容就是来自于Report Template的，而图中左边文档的后半部分内容则是根据这个Report Type，自动产生的内容。\nReport Type 先来说说这个Report Type，也许聪明的你，在前几篇介绍Orchestration Plan的时候已经有看到，在每个Plan的右键菜单或者工具栏上有一些Report可以生成，它们分别是：\n   Report类型 作用     Plan Definition Report 记录灾备计划设置详情   Readiness Check Report 灾备计划可用性检测报告，包含恢复目标位置和灾备中心的可用性检测   Datalab test Reort 数据实验室测试报告   Excution Report 灾备执行情况报告    这些Report就是VAO能够生成的所有Report文档，这些文档都会有一个VAO已经内置设计好的内容，能够和灾备管理员定义的Report Template组合起来，最终形成一份完整可以阅读的Report。","keywords":["VAO"],"articleBody":"系列目录：  VAO基础入门（一）- 简介 VAO基础入门（二）- 安装与部署 VAO基础入门（三）- 基本组件 · 上篇 VAO基础入门（四）- 基本组件 · 下篇 VAO基础入门（五）- 基础配置要点 VAO基础入门（六）- 成功灾备计划的第一步 VAO基础入门（七）- Plan Step · 上篇 VAO基础入门（八）- Plan Step · 下篇 VAO基础入门（九）- 文档模板解析  本系列的最后一篇，我来介绍一下VAO的文档系统。\nVAO能够全自动的为管理员生成灾备需要的系统文档，文档的内容为VAO系统自动根据Orchestration Plan的设置和执行自动生成。VAO文档系统的强大在于所有的内容系统根据配置和运行会全自动生成，因此管理员只需要专心关注自己的灾备即可，这些后续的基础保障，繁琐的文档制定，全部交给VAO来完成。\nVAO生成的每个文档会包含两部分，第一部分是灾备管理员定义的Report Template；第二部分是系统根据Report Type生成的动态内容。无论什么类型的文档，在文档的开头部分都会使用Report Template中所定义的内容，而第二部分则根据Report Type不同自动填充相关内容。\n我们先来看个实际的例子，了解一下什么是Report Template中的内容，什么是根据Report Type自动生成的，如下图：\n左边是一个VAO最终生成的Readiness Check的Report，右边是我们在编辑器中打开的Report Template。可以看到红色框所示的内容就是来自于Report Template的，而图中左边文档的后半部分内容则是根据这个Report Type，自动产生的内容。\nReport Type 先来说说这个Report Type，也许聪明的你，在前几篇介绍Orchestration Plan的时候已经有看到，在每个Plan的右键菜单或者工具栏上有一些Report可以生成，它们分别是：\n   Report类型 作用     Plan Definition Report 记录灾备计划设置详情   Readiness Check Report 灾备计划可用性检测报告，包含恢复目标位置和灾备中心的可用性检测   Datalab test Reort 数据实验室测试报告   Excution Report 灾备执行情况报告    这些Report就是VAO能够生成的所有Report文档，这些文档都会有一个VAO已经内置设计好的内容，能够和灾备管理员定义的Report Template组合起来，最终形成一份完整可以阅读的Report。\n这部分VAO已经内置的内容，我们无法做任何的更改，系统都会根据实际的报告类型、当前灾备计划的设定、灾备计划的运行和执行来自动生成这个内容，因此我们也不需要对这里的内容做更改设定。\n所以，此部分的内容目前只包含英语版本，我们没有任何方法去修改其中相关信息，当然如果我们的Plan中如果包含中文的信息，VAO还是能够正确的传递给Report，生成相关内容。\nReport Template Report Template的内容是管理员可以根据自己需求进行定制每个文档的前半部分，在VAO出厂软件中，已经内置了8国语言的默认模版，需要注意的是，这些默认模版都是无法编辑的，但是是可以直接被Report系统调用在Orchestration Plan中使用的。如果需要编辑这些模版，或者创建自己的模版，需要首先从这些模版Clone一份自己的拷贝，然后在这个基础上进行修改。\n修改这些文档需要用Word，要求是Word 2010 SP2以上版本，也就是说，需要在当前打开VAO网页的电脑上，同时安装了 Word 2010 SP2以上版本，才能正常的进行编辑。点击VAO界面中的Edit按钮后，系统会自动从网页浏览器切换至Microsoft Word中进行编辑。\n和普通的Word编辑完全不一样的是，这个模板的编辑是个动态文档的编辑，可以加入很多VAO中的变量，让VAO系统在生成Report的时候自动填充。\n如何使用Word编辑动态文档   首先需要选择一个内置的Template作为我们要编辑的对象，点击Clone按钮启动创建自己的Template。比如我这里选择Veeam Default Template（ZH）。   在Clone Template对话框中，选择分配给自己名下的哪个Scope，然后为这个Template起个响亮的名字，填写一段描述，就能完成模板创建。   创建完成后，在Template清单中就能看的这个模板，并且上面的工具栏按钮也可以对这个模板进行操作了，可以点击Edit进行内容编辑。在这里VAO并不提供内置的文档编辑器，这个Edit按钮会直接调用当前浏览器所在的计算机打开Word进行编辑，要求管理员必须已经正确安装了Microsoft Word。   点击Edit之后，会切换到Word程序，需要注意的是，Word不会立即打开文档，而是需要一个访问的权限，这里需要的权限必须是当前在浏览器中登入VAO的用户，否则这个Word将打不开该文档模板。   打开文档后，即可正常进行Word的编辑了。这个文档并不是全文档都可以编辑，您会发现很多区域被黄色的荧光标注了，这部分内容才是允许编辑的区域，在这里可以任意的加上需要的文字和图片内容。所以，可以看到，这个文档的标题、页眉和页脚是不可被修改的，而其他部分，都是可修改的。   因为这是个动态文档，所以在这里我们可以调用很多很多VAO的变量内容来取得数据，VAO系统已经给我们做了一些示例，在Clone出来的这个文档中，仔细观察这些文字，会发现有一些文字内容被[]包围，这部分内容就是这个文档中动态的变量内容。这个编辑和我们正常的Word编辑稍微有些不同，我们来看看如何进行操作。 要编辑这个变量数据，首先我们可以按正常方式输入一段文字内容，为了区分和普通文字的不同，建议也和VAO默认文档一样，加上[]，比如：[Hi，我是变量]，在上方工具栏，找到开发工具，打开设计模式。   在打开设计模式后，会发现这个文档变得好奇怪，之前藏起来的很多内容显现出来了，这时候别被这些多出来的内容吓到，他们实际上并不存在，关掉设计模式后他们会自动藏回去，这只是我们的变量设置结果而已。 接下去，我们对[Hi,我是变量]进行设置，选中这段文字，然后需要点击设计模式左边的第一个Aa按钮，就能将这段文字变成和模板中一样的变量了，然后再点击设计模式下方的属性，可以打开变量设定的对话框，它是使用Word的内容控件来实现的，设定这个内容控件的属性即可完成。   这个变量设置非常简单，只需要输入一个标题和一个标记，一般来说，这两个设置成一样的就行了，标题跟着标记的内容来填写。VAO内置了以下可用的所有标记，所有标记都是以“~”开头，选择需要的标记填入到上面的这个属性框中点确定即可。\n   变量名 作用说明     ~Created Report生成时间   ~TimeZone Report生成时区   ~PlanType VAO计划类型   ~PlanName VAO计划名称   ~PlanDescription VAO计划描述   ~PlanContactName 灾备计划联系人姓名   ~PlanContactEmail 灾备计划联系人邮箱   ~PlanContactTel 灾备计划联系人电话   ~Site 站点名称   ~SiteScopeName 站点范围名称   ~SiteDescription 站点描述   ~SiteContactName 站点联系人姓名   ~SiteContactEmail 站点联系人邮箱   ~SiteContactTel 站点联系人电话   ~ServerName 服务器名称   ~VmsInPlan 在该计划中的虚拟机   ~GroupsInPlan 在该计划中的虚拟机组   ~ReportType Report类型   ~TargetRTO 该计划的目标期望RTO   ~TargetRPO 该计划的目标期望RPO      在根据需要写完这个文档之后，只需要按照正常保存或者关闭这个文件就可以将文档提交至VAO服务器了，千万记得不要使用另存为，另存为之后，就不会更新至VAO服务器，这个编辑也就白搭了。\n  Report Template编辑完成后，就可以回到VAO网页UI中查看修改结果了，管理员也可以根据不同的Scope的设置，为不同的Orchestration Plan选择并使用这个新创建的Report Template。\n以上就是VAO的所有内容，希望对大家了解VAO有帮助，感谢关注和阅读！\n","wordCount":"147","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Lei Wei"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://newblog.backupnext.cloud/post/2020-03-02-vao-guide-09/"},"publisher":{"@type":"Organization","name":"Backup next cloud","logo":{"@type":"ImageObject","url":"https://newblog.backupnext.cloud/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://newblog.backupnext.cloud/ accesskey=h title="Lei Wei's blog (Alt + H)">Lei Wei's blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://newblog.backupnext.cloud/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://newblog.backupnext.cloud/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://newblog.backupnext.cloud/search/ title=Search><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>VAO基础入门（九） - 文档模板解析</h1><div class=post-meta>Lei Wei&nbsp;|&nbsp;<a href=https://github.com/Coku2015/Coku2015.github.io/blob/master/content/post/2020-03-02-VAO%20Guide%2009.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#%e7%b3%bb%e5%88%97%e7%9b%ae%e5%bd%95 aria-label=系列目录：>系列目录：</a></li><li><a href=#report-type aria-label="Report Type">Report Type</a></li><li><a href=#report-template aria-label="Report Template">Report Template</a></li><li><a href=#%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8word%e7%bc%96%e8%be%91%e5%8a%a8%e6%80%81%e6%96%87%e6%a1%a3 aria-label=如何使用Word编辑动态文档>如何使用Word编辑动态文档</a></li></ul></div></details></div><div class=post-content><h2 id=系列目录>系列目录：<a hidden class=anchor aria-hidden=true href=#系列目录>#</a></h2><ul><li><a href=https://blog.backupnext.cloud/_posts/2020-02-17-VAO-Guide-01/>VAO基础入门（一）- 简介</a></li><li><a href=https://blog.backupnext.cloud/_posts/2020-02-18-VAO-Guide-02/>VAO基础入门（二）- 安装与部署</a></li><li><a href=https://blog.backupnext.cloud/_posts/2020-02-19-VAO-Guide-03/>VAO基础入门（三）- 基本组件 · 上篇</a></li><li><a href=https://blog.backupnext.cloud/_posts/2020-02-20-VAO-Guide-04/>VAO基础入门（四）- 基本组件 · 下篇</a></li><li><a href=https://blog.backupnext.cloud/_posts/2020-02-21-VAO-Guide-05/>VAO基础入门（五）- 基础配置要点</a></li><li><a href=https://blog.backupnext.cloud/_posts/2020-02-25-VAO-Guide-06/>VAO基础入门（六）- 成功灾备计划的第一步</a></li><li><a href=https://blog.backupnext.cloud/_posts/2020-02-27-VAO-Guide-07/>VAO基础入门（七）- Plan Step · 上篇</a></li><li><a href=https://blog.backupnext.cloud/_posts/2020-02-28-VAO-Guide-08/>VAO基础入门（八）- Plan Step · 下篇</a></li><li><a href=https://blog.backupnext.cloud/_posts/2020-03-02-VAO-Guide-09/>VAO基础入门（九）- 文档模板解析</a></li></ul><p>本系列的最后一篇，我来介绍一下VAO的文档系统。</p><p>VAO能够全自动的为管理员生成灾备需要的系统文档，文档的内容为VAO系统自动根据Orchestration Plan的设置和执行自动生成。VAO文档系统的强大在于所有的内容系统根据配置和运行会全自动生成，因此管理员只需要专心关注自己的灾备即可，这些后续的基础保障，繁琐的文档制定，全部交给VAO来完成。</p><p>VAO生成的每个文档会包含两部分，第一部分是灾备管理员定义的Report Template；第二部分是系统根据Report Type生成的动态内容。无论什么类型的文档，在文档的开头部分都会使用Report Template中所定义的内容，而第二部分则根据Report Type不同自动填充相关内容。</p><p>我们先来看个实际的例子，了解一下什么是Report Template中的内容，什么是根据Report Type自动生成的，如下图：</p><p><img loading=lazy src=https://s2.ax1x.com/2020/03/03/3fvwlT.jpg alt=3fvwlT.jpg></p><p>左边是一个VAO最终生成的Readiness Check的Report，右边是我们在编辑器中打开的Report Template。可以看到红色框所示的内容就是来自于Report Template的，而图中左边文档的后半部分内容则是根据这个Report Type，自动产生的内容。</p><h2 id=report-type>Report Type<a hidden class=anchor aria-hidden=true href=#report-type>#</a></h2><p>先来说说这个Report Type，也许聪明的你，在前几篇介绍Orchestration Plan的时候已经有看到，在每个Plan的右键菜单或者工具栏上有一些Report可以生成，它们分别是：</p><table><thead><tr><th>Report类型</th><th>作用</th></tr></thead><tbody><tr><td>Plan Definition Report</td><td>记录灾备计划设置详情</td></tr><tr><td>Readiness Check Report</td><td>灾备计划可用性检测报告，包含恢复目标位置和灾备中心的可用性检测</td></tr><tr><td>Datalab test Reort</td><td>数据实验室测试报告</td></tr><tr><td>Excution Report</td><td>灾备执行情况报告</td></tr></tbody></table><p>这些Report就是VAO能够生成的所有Report文档，这些文档都会有一个VAO已经内置设计好的内容，能够和灾备管理员定义的Report Template组合起来，最终形成一份完整可以阅读的Report。</p><p>这部分VAO已经内置的内容，我们无法做任何的更改，系统都会根据实际的报告类型、当前灾备计划的设定、灾备计划的运行和执行来自动生成这个内容，因此我们也不需要对这里的内容做更改设定。</p><p>所以，此部分的内容目前只包含英语版本，我们没有任何方法去修改其中相关信息，当然如果我们的Plan中如果包含中文的信息，VAO还是能够正确的传递给Report，生成相关内容。</p><h2 id=report-template>Report Template<a hidden class=anchor aria-hidden=true href=#report-template>#</a></h2><p>Report Template的内容是管理员可以根据自己需求进行定制每个文档的前半部分，在VAO出厂软件中，已经内置了8国语言的默认模版，需要注意的是，这些默认模版都是无法编辑的，但是是可以直接被Report系统调用在Orchestration Plan中使用的。如果需要编辑这些模版，或者创建自己的模版，需要首先从这些模版Clone一份自己的拷贝，然后在这个基础上进行修改。</p><p>修改这些文档需要用Word，要求是Word 2010 SP2以上版本，也就是说，需要在当前打开VAO网页的电脑上，同时安装了 Word 2010 SP2以上版本，才能正常的进行编辑。点击VAO界面中的Edit按钮后，系统会自动从网页浏览器切换至Microsoft Word中进行编辑。</p><p>和普通的Word编辑完全不一样的是，这个模板的编辑是个动态文档的编辑，可以加入很多VAO中的变量，让VAO系统在生成Report的时候自动填充。</p><h2 id=如何使用word编辑动态文档>如何使用Word编辑动态文档<a hidden class=anchor aria-hidden=true href=#如何使用word编辑动态文档>#</a></h2><ol><li><p>首先需要选择一个内置的Template作为我们要编辑的对象，点击Clone按钮启动创建自己的Template。比如我这里选择<code>Veeam Default Template（ZH）</code>。
<img loading=lazy src=https://s2.ax1x.com/2020/03/03/3hiViQ.png alt=3hiViQ.png></p></li><li><p>在Clone Template对话框中，选择分配给自己名下的哪个Scope，然后为这个Template起个响亮的名字，填写一段描述，就能完成模板创建。
<img loading=lazy src=https://s2.ax1x.com/2020/03/03/3hi5TS.png alt=3hi5TS.png></p></li><li><p>创建完成后，在Template清单中就能看的这个模板，并且上面的工具栏按钮也可以对这个模板进行操作了，可以点击Edit进行内容编辑。在这里VAO并不提供内置的文档编辑器，这个Edit按钮会直接调用当前浏览器所在的计算机打开Word进行编辑，要求管理员必须已经正确安装了Microsoft Word。
<img loading=lazy src=https://s2.ax1x.com/2020/03/03/3hFmkD.png alt=3hFmkD.png></p></li><li><p>点击Edit之后，会切换到Word程序，需要注意的是，Word不会立即打开文档，而是需要一个访问的权限，这里需要的权限必须是当前在浏览器中登入VAO的用户，否则这个Word将打不开该文档模板。
<img loading=lazy src=https://s2.ax1x.com/2020/03/03/3hkOaT.png alt=3hkOaT.png></p></li><li><p>打开文档后，即可正常进行Word的编辑了。这个文档并不是全文档都可以编辑，您会发现很多区域被黄色的荧光标注了，这部分内容才是允许编辑的区域，在这里可以任意的加上需要的文字和图片内容。所以，可以看到，这个文档的标题、页眉和页脚是不可被修改的，而其他部分，都是可修改的。
<img loading=lazy src=https://s2.ax1x.com/2020/03/03/3hEw1H.png alt=3hEw1H.png></p></li><li><p>因为这是个动态文档，所以在这里我们可以调用很多很多VAO的变量内容来取得数据，VAO系统已经给我们做了一些示例，在Clone出来的这个文档中，仔细观察这些文字，会发现有一些文字内容被[]包围，这部分内容就是这个文档中动态的变量内容。这个编辑和我们正常的Word编辑稍微有些不同，我们来看看如何进行操作。
要编辑这个变量数据，首先我们可以按正常方式输入一段文字内容，为了区分和普通文字的不同，建议也和VAO默认文档一样，加上[]，比如：<code>[Hi，我是变量]</code>，在上方工具栏，找到<code>开发工具</code>，打开<code>设计模式</code>。
<img loading=lazy src=https://s2.ax1x.com/2020/03/03/3heF6H.png alt=3heF6H.png></p></li><li><p>在打开设计模式后，会发现这个文档变得好奇怪，之前藏起来的很多内容显现出来了，这时候别被这些多出来的内容吓到，他们实际上并不存在，关掉设计模式后他们会自动藏回去，这只是我们的变量设置结果而已。
接下去，我们对<code>[Hi,我是变量]</code>进行设置，选中这段文字，然后需要点击设计模式左边的第一个<code>Aa</code>按钮，就能将这段文字变成和模板中一样的变量了，然后再点击设计模式下方的属性，可以打开变量设定的对话框，它是使用Word的内容控件来实现的，设定这个内容控件的属性即可完成。
<img loading=lazy src=https://s2.ax1x.com/2020/03/03/3hmKV1.png alt=3hmKV1.png></p></li><li><p>这个变量设置非常简单，只需要输入一个标题和一个标记，一般来说，这两个设置成一样的就行了，标题跟着标记的内容来填写。VAO内置了以下可用的所有标记，所有标记都是以<code>“~”</code>开头，选择需要的标记填入到上面的这个属性框中点确定即可。</p><table><thead><tr><th>变量名</th><th style=text-align:left>作用说明</th></tr></thead><tbody><tr><td>~Created</td><td style=text-align:left>Report生成时间</td></tr><tr><td>~TimeZone</td><td style=text-align:left>Report生成时区</td></tr><tr><td>~PlanType</td><td style=text-align:left>VAO计划类型</td></tr><tr><td>~PlanName</td><td style=text-align:left>VAO计划名称</td></tr><tr><td>~PlanDescription</td><td style=text-align:left>VAO计划描述</td></tr><tr><td>~PlanContactName</td><td style=text-align:left>灾备计划联系人姓名</td></tr><tr><td>~PlanContactEmail</td><td style=text-align:left>灾备计划联系人邮箱</td></tr><tr><td>~PlanContactTel</td><td style=text-align:left>灾备计划联系人电话</td></tr><tr><td>~Site</td><td style=text-align:left>站点名称</td></tr><tr><td>~SiteScopeName</td><td style=text-align:left>站点范围名称</td></tr><tr><td>~SiteDescription</td><td style=text-align:left>站点描述</td></tr><tr><td>~SiteContactName</td><td style=text-align:left>站点联系人姓名</td></tr><tr><td>~SiteContactEmail</td><td style=text-align:left>站点联系人邮箱</td></tr><tr><td>~SiteContactTel</td><td style=text-align:left>站点联系人电话</td></tr><tr><td>~ServerName</td><td style=text-align:left>服务器名称</td></tr><tr><td>~VmsInPlan</td><td style=text-align:left>在该计划中的虚拟机</td></tr><tr><td>~GroupsInPlan</td><td style=text-align:left>在该计划中的虚拟机组</td></tr><tr><td>~ReportType</td><td style=text-align:left>Report类型</td></tr><tr><td>~TargetRTO</td><td style=text-align:left>该计划的目标期望RTO</td></tr><tr><td>~TargetRPO</td><td style=text-align:left>该计划的目标期望RPO</td></tr></tbody></table></li><li><p>在根据需要写完这个文档之后，只需要按照正常保存或者关闭这个文件就可以将文档提交至VAO服务器了，千万记得不要使用另存为，另存为之后，就不会更新至VAO服务器，这个编辑也就白搭了。</p></li></ol><p>Report Template编辑完成后，就可以回到VAO网页UI中查看修改结果了，管理员也可以根据不同的Scope的设置，为不同的Orchestration Plan选择并使用这个新创建的Report Template。</p><p>以上就是VAO的所有内容，希望对大家了解VAO有帮助，感谢关注和阅读！</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://newblog.backupnext.cloud/tags/vao/>VAO</a></li></ul><nav class=paginav><a class=prev href=https://newblog.backupnext.cloud/post/2020-02-19-vao-guide-03/><span class=title>« Prev Page</span><br><span>VAO基础入门（三） - 基本组件 · 上篇</span></a>
<a class=next href=https://newblog.backupnext.cloud/post/2020-02-18-vao-guide-02/><span class=title>Next Page »</span><br><span>VAO基础入门（二） - 安装与部署</span></a></nav></footer></article></main><footer class=footer><span>Copyright Lei Wei</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>